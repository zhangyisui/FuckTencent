(window.webpackJsonp=window.webpackJsonp||[]).push([[76],{1102:function(e,t){e.exports={attributes:{width:"72px",height:"58px",viewBox:"0 0 72 58"},content:'<defs>         <path d="M0.00434937116,11.7604183 C0.0014585125,11.8367351 0,11.9134174 0,11.9904392 L0,52.0095608 C0,55.3137533 2.68603825,58 5.99943435,58 L66.0005656,58 C69.3089213,58 72,55.317989 72,52.0095608 L72,11.9904392 C72,8.68624675 69.3139617,6 66.0005656,6 L31.1520961,6 L30.2346555,3.7077864 C29.4154984,1.66113281 26.9585394,0 24.7478675,0 L6.18638069,0 C2.86742525,0 0.139552484,2.68348852 0.0902454792,5.99373937 L0.00434937116,11.7604183 Z" id="path-1"></path>         <mask id="mask-2" maskContentUnits="userSpaceOnUse" maskUnits="objectBoundingBox" x="0" y="0" width="72" height="58" fill="white">             <use xlink:href="#path-1"></use>         </mask>     </defs>     <g id="空状态" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">         <g id="collection" transform="translate(-39.000000, -30.000000)" stroke="#E7EAF1">             <g transform="translate(39.000000, 30.000000)" id="Group-7">                 <g>                     <use id="Combined-Shape" mask="url(#mask-2)" stroke-width="6" xlink:href="#path-1"></use>                     <path d="M36.4126782,38.4800003 L30.2669271,41.2927815 C29.7656337,41.522213 29.4096881,41.2718295 29.4738593,40.716584 L30.2498317,34.0024302 L25.6755762,29.0266708 C25.3024658,28.6208107 25.4306014,28.2049135 25.9785012,28.0943637 L32.6038296,26.7575697 L35.9225353,20.8696 C36.1932338,20.3893332 36.6283715,20.3826781 36.9028211,20.8696 L40.2215268,26.7575697 L46.8468552,28.0943637 C47.3872665,28.2034026 47.5280608,28.6151866 47.1497802,29.0266708 L42.5755247,34.0024302 L43.3514971,40.716584 C43.4147912,41.2642406 43.0666691,41.5253922 42.5584293,41.2927815 L36.4126782,38.4800003 Z" id="Star" stroke-width="3"></path>                 </g>             </g>         </g>     </g>'}},1149:function(e,t,a){"use strict";a.r(t),a.d(t,"FavlistsModal",(function(){return z}));var n=a(47),c=a(1),i=a(3),r=a.n(i),o=a(40),s=a(0),l=a(88),u=a(2);var d=function(e,t,a){return a&&void 0!==t&&(e||!t)},h=(a(995),a(33)),p=a(96),m=a(13),b=a.n(m),f=a(139),v=a(448),y=function(e){var t,a=e.onBack,i=e.onSubmit,r=e.authRequired,o=e.isActive,l=e.editItem,u=void 0===l?{}:l,m=e.isDefaultPage,y="edit"===e.currentPage,j=Object(s.useState)(null===(t=u.isPublic)||void 0===t||t),O=Object(n.a)(j,2),g=O[0],P=O[1],C=Object(s.useState)(u.title||""),N=Object(n.a)(C,2),w=N[0],S=N[1],k=Object(s.useState)(u.description||""),F=Object(n.a)(k,2),R=F[0],T=F[1],I=!w||w.length>20||R.length>60,L=y&&!0===u.isPublic&&u.followerCount>0;return Object(c.c)("form",{className:"Favlists-content",onSubmit:function(e){if(e.preventDefault(),w){var t={title:w,description:R,isPublic:g};d(g,o,r)?r(i)(t):(i(t),a())}},children:[Object(c.c)("div",{className:"Favlists-addItems",children:[Object(c.c)("div",{className:"Favlists-addItem",children:[Object(c.b)(f.a,{className:"Favlists-titleInput",placeholder:"收藏标题",onChange:function(e){S(e.target.value)},value:w}),Object(c.b)("div",{className:"Favlists-inputTips",children:Object(c.b)(v.a,{name:"收藏标题",current:w?w.length:0,max:20})})]}),Object(c.c)("div",{className:"Favlists-addItem",children:[Object(c.b)(f.a,{multiline:!0,className:"Favlists-descritionInput",placeholder:"收藏描述（可选）",onChange:function(e){T(e.target.value)},rows:5,value:R}),Object(c.b)("div",{className:"Favlists-inputTips",children:Object(c.b)(v.a,{name:"收藏描述",current:R?R.length:0,max:60})})]}),Object(c.c)("div",{className:"Favlists-addItem",children:[Object(c.c)("label",{className:"Favlists-privacyOption",children:[Object(c.b)("input",{className:"Favlists-privacyOptionRadio",name:"isPublic",type:"radio",value:"true",checked:g,onChange:function(){return P(!0)}}),Object(c.b)("span",{children:"公开"}),Object(c.b)("span",{className:"Favlists-privacyOptionTips",children:"有其他人关注此收藏夹时不可设置为私密"})]}),Object(c.c)("label",{className:b()("Favlists-privacyOption",{"Favlists-privacyOption--privacyDisable":L}),children:[Object(c.b)("input",{className:"Favlists-privacyOptionRadio",name:"isPublic",type:"radio",value:"false",checked:!g,onChange:function(){return P(!1)},disabled:L}),Object(c.b)("span",{children:"私密"}),Object(c.b)("span",{className:"Favlists-privacyOptionTips",children:L?"当前有人在关注此收藏夹，无法设为隐私":"只有你自己可以查看这个收藏夹"})]})]})]}),Object(c.c)(p.a,{direction:"horizontal",className:"",children:[a&&Object(c.b)(h.c,{onClick:a,children:m?"取消":"返回"}),Object(c.b)(h.c,{color:"blue",preset:"primary",type:"submit",disabled:I,children:m?"确认":"确认创建"})]})]})};y.propTypes={onSubmit:r.a.func.isRequired,onBack:r.a.func,authRequired:r.a.func,isActive:r.a.bool,editItem:r.a.shape({type:r.a.oneOf(["collection"])}),currentPage:r.a.oneOf(["edit","add"]),isDefaultPage:r.a.bool};var j=y,O=(a(1102),a(14)),g=a(15),P=a(17),C=a(18),N=a(7),w=a(432),S=a(986),k=a(26),F=a(1396),R=a(72);function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=Object(N.a)(e);if(t){var c=Object(N.a)(this).constructor;a=Reflect.construct(n,arguments,c)}else a=n.apply(this,arguments);return Object(C.a)(this,a)}}var I=function(e){Object(P.a)(a,e);var t=T(a);function a(){var e;Object(O.a)(this,a);for(var n=arguments.length,c=new Array(n),i=0;i<n;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).handleChange=function(){var t=e.props;(0,t.onChange)(t.id,e.props.checked)},e}return Object(g.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.zaEnabled,a=e.id;t&&k.a.setModule(this,{module:"CollectionItem"},{card:{card_type:"Content",content:{type:"Collection",token:String(a)}}})}},{key:"render",value:function(){var e=this.props,t=e.answerCount,a=e.title,n=e.isPublic,i=e.checked,r=void 0!==i&&i,o=r?{preset:"primary",color:"grey",children:"已收藏"}:{color:"blue",children:"收藏"};return Object(c.c)("div",{className:"Favlists-item",children:[Object(c.c)("div",{className:"Favlists-itemInner",children:[Object(c.c)("div",{className:"Favlists-itemName",children:[Object(c.b)("span",{className:"Favlists-itemNameText",children:a}),!1===n&&Object(c.b)("span",{className:"Favlists-itemIcon",children:Object(c.b)(F.a,{size:16})})]}),Object(c.c)("div",{className:"Favlists-itemContent",children:[t," 条内容"]})]}),Object(c.b)(R.a,Object.assign(Object.assign({as:h.c,zaType:"Button",zaAction:r?"UnCollect":"Collect",zaText:r?"取消收藏":"收藏"},o),{},{className:"Favlists-updateButton",onClick:this.handleChange}))]})}}]),a}(s.Component);function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=Object(N.a)(e);if(t){var c=Object(N.a)(this).constructor;a=Reflect.construct(n,arguments,c)}else a=n.apply(this,arguments);return Object(C.a)(this,a)}}var B=function(e){Object(P.a)(a,e);var t=L(a);function a(){var e;Object(O.a)(this,a);for(var n=arguments.length,c=new Array(n),i=0;i<n;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).items={},e.handleFavlistItemChange=function(t,a){k.a.trackEvent(e.items[t],{action:a?"UnCollect":"Collect",element:"Button",is_intent:!1}),e.props.onUpdate(t,a)},e}return Object(g.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.relations,n=t.items,i=t.isFetching,r=t.isDrained,o=t.onAdd,s=t.onLoad;return Object(c.c)("div",{className:"Favlists-content",children:[Object(c.b)(w.b,{isLocal:!0,isLoading:i,isDrained:r,onLoad:s,placeholder:Object(c.b)(S.a,{title:!0}),getContainer:function(e){return e},className:"Favlists-items",children:n.map((function(t){return Object(c.b)(I,Object.assign(Object.assign({onChange:e.handleFavlistItemChange,checked:a[t.id]},t),{},{ref:function(a){e.items[t.id]=a}}),t.id)}))}),!n.length&&i||Object(c.b)("div",{className:"Favlists-actions",children:Object(c.b)(h.c,{className:"Favlists-addButton",onClick:o,preset:"primary",color:"blue",children:"创建收藏夹"})})]})}}]),a}(s.Component);B.propTypes={isFetching:r.a.bool,relations:r.a.object,onUpdate:r.a.func.isRequired,onAdd:r.a.func.isRequired,onLoad:r.a.func.isRequired,items:r.a.array.isRequired,isDrained:r.a.bool,authRequired:r.a.func};var A=B,D=Object(s.forwardRef)((function(e,t){var a=e.currentPage,n=e.items,i=e.isFetching,r=e.isDrained,o=e.relations,s=e.handleUpdateFavList,l=e.onLoad,u=e.zaEnabled,d=e.handleAdd,m=e.handleCloseModal,b=e.onFavlistAdd,f=e.authRequired,v=e.isUserActive,y=e.defaultStatus,O=e.handleBack,g=e.hasFavlists,P=e.editItem,C=void 0===P?{}:P,N=e.onUpdateFavContent;if("list"===a)return g?Object(c.b)(A,{ref:t,items:n,isFetching:i,isDrained:r,relations:o,onAdd:d,onUpdate:s,onLoad:l,zaEnabled:u}):Object(c.c)(p.a,{children:[Object(c.b)(h.c,{preset:"primary",color:"blue",onClick:d,children:"创建收藏夹"}),Object(c.b)(h.c,{onClick:m,children:"取消"})]});if(["add","edit"].includes(a)){var w=y===a;return Object(c.b)(j,{onSubmit:"add"===a?b:N,isActive:v,onBack:w?m:O,authRequired:f,editItem:C,currentPage:a,isDefaultPage:w})}return null}));D.propTypes={currentPage:r.a.oneOf(["list","add","edit"]).isRequired,items:r.a.arrayOf(r.a.shape({type:r.a.oneOf(["collection"])})),isFetching:r.a.bool,isDrained:r.a.bool,relations:r.a.object,handleUpdateFavList:r.a.func,onLoad:r.a.func,zaEnabled:r.a.bool,handleAdd:r.a.func,handleCloseModal:r.a.func.isRequired,onFavlistAdd:r.a.func,authRequired:r.a.func,isUserActive:r.a.bool,defaultStatus:r.a.oneOf(["list","add","edit"]),handleBack:r.a.func,hasFavlists:r.a.bool,editItem:r.a.shape({type:r.a.oneOf(["collection"])}),onUpdateFavContent:r.a.func};var x=D,M={list:{title:"添加收藏",tips:function(e){return e?"请选择你想添加的收藏夹":"你可以创建多个收藏夹，将答案分类收藏"}},add:{title:"创建新收藏夹"},edit:{title:"编辑收藏夹"}},U=function(e){var t=e.shown,a=e.items,i=e.id,r=e.type,h=e.relations,p=e.onClose,m=e.isUserActive,b=e.authRequired,f=e.defaultStatus,v=e.onUpdateFav,y=e.isDrained,j=e.isFetching,O=e.onLoad,g=e.zaEnabled,P=e.onFavlistAdd,C=e.editItem,N=e.onUpdateFavContent,w=Object(s.useState)(f),S=Object(n.a)(w,2),k=S[0],F=S[1],R=Object(o.j)(a)||[];Object(s.useEffect)((function(){"add"===k&&"list"===f&&R.length<a.length&&F("list")}),[k,f,C,a,R.length]);var T=function(){p(),"list"===f&&F("list")},I=!(y&&!a.length),L=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=a.selectedKey,c=void 0===n?"selectedProps":n,i=a.dropedKey,r=void 0===i?"dropedProps":i;return Object.keys(e).reduce((function(a,n){var i=t.includes(n)?c:r;return Object.assign(Object.assign({},a),{},Object(u.a)({},i,Object.assign(Object.assign({},a[i]),{},Object(u.a)({},n,e[n]))))}),{})}(e,Object.keys(l.b.propTypes)).selectedProps,B=M[k],A=B.tips,D=B.title;return Object(c.b)(l.b,Object.assign(Object.assign({},L),{},{onClose:T,title:D,subtitle:A&&A(I),buttonGroupOnly:!I,className:"FavlistsModal",size:"large",children:t&&Object(c.b)(x,{currentPage:k,items:a,isFetching:j,isDrained:y,relations:h,handleUpdateFavList:function(e,t){var n=a.find((function(t){return t.id===e}))||{},c=[e,i,r,n.isPublic];return!t&&d(n.isPublic,m,b)?b(v).apply(void 0,c):v.apply(void 0,c)},onLoad:O,zaEnabled:g,handleAdd:function(){return F("add")},handleCloseModal:T,onFavlistAdd:P,authRequired:b,isUserActive:m,defaultStatus:f,handleBack:function(){return F("list")},hasFavlists:I,editItem:C,onUpdateFavContent:N})}))};U.propTypes={id:r.a.oneOfType([r.a.string,r.a.number]),type:r.a.oneOf(["answer","article","pin","zvideo"]),relations:r.a.object,onUpdateFav:r.a.func,onFavlistAdd:r.a.func,onClose:r.a.func.isRequired,shown:r.a.bool,zaEnabled:r.a.bool,authRequired:r.a.func,isUserActive:r.a.bool,defaultStatus:r.a.oneOf(["list","add","edit"]),onLoad:r.a.func,editItem:r.a.shape({type:r.a.oneOf(["collection"])}),onUpdateFavContent:r.a.func},U.defaultProps={defaultStatus:"list",relations:{},authRequired:function(e){return e}};var z=U},1246:function(e,t,a){},1396:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(0),c=a.n(n),i=a(12),r=Object.assign;function o(e){return c.a.createElement(i.a,r(r({width:"24",height:"24",viewBox:"0 0 24 24","data-new-api":"LockFill24","data-old-api":"Lock"},e),{className:"Zi Zi--Lock"+(e.className?" ".concat(e.className):"")}),c.a.createElement("path",{d:"M3.5 11.6A1.6 1.6 0 015.1 10h2.166c0-.177-.003-.377-.007-.594-.02-1.105-.048-2.662.35-3.996.246-.823.67-1.63 1.405-2.227.743-.603 1.73-.933 2.986-.933 1.256 0 2.243.33 2.986.933.735.598 1.159 1.404 1.405 2.227.398 1.334.37 2.891.35 3.996-.004.217-.008.417-.008.594H18.9a1.6 1.6 0 011.6 1.6v7.8a1.6 1.6 0 01-1.6 1.6H5.1a1.6 1.6 0 01-1.6-1.6v-7.8zM9 14.75a.75.75 0 000 1.5h6a.75.75 0 000-1.5H9zM8.759 9.3c.004.242.007.476.007.7h6.467c0-.182.003-.37.006-.565l.002-.135c.017-1.112.037-2.375-.287-3.46-.19-.636-.482-1.142-.914-1.492-.424-.345-1.055-.598-2.04-.598-.985 0-1.616.253-2.04.598-.432.35-.724.856-.914 1.492-.324 1.085-.304 2.348-.287 3.46z",fillRule:"evenodd",clipRule:"evenodd"}))}},2790:function(e,t,a){"use strict";a.r(t);var n=a(14),c=a(15),i=a(17),r=a(18),o=a(7),s=a(1),l=a(0),u=a(13),d=a.n(u),h=a(59),p=a.n(h),m=a(26);a(1246);function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=Object(o.a)(e);if(t){var c=Object(o.a)(this).constructor;a=Reflect.construct(n,arguments,c)}else a=n.apply(this,arguments);return Object(r.a)(this,a)}}var f=function(e){Object(i.a)(a,e);var t=b(a);function a(){var e;Object(n.a)(this,a);for(var c=arguments.length,i=new Array(c),r=0;r<c;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).rootRef=Object(l.createRef)(),e.unobserve=p.a,e.renderTarget=function(){var t=e.props.item,a=t.content.target,n=a.text,c=a.link,i=t.id,r=t.target,o=t.target,l=(o=void 0===o?{}:o).id,u=o.target,d=void 0===u?{}:u,h=d.type;return r&&"comment"===r.type?e.renderCommentButton(n,{type:h,href:c,byComment:l,target:d,notificationId:i}):Object(s.b)("span",{children:c?Object(s.b)("a",{href:c,"data-za-detail-view-id":5109,children:n}):Object(s.b)("span",{children:n})})},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.addObserve,a=e.item.attachInfo,n=this.rootRef.current;m.a.setModule(n,{module:"Content"},{attached_info_bytes:a}),this.unobserve=t(n)}},{key:"componentWillUnmount",value:function(){this.unobserve()}},{key:"renderCommentButton",value:function(e,t){var a=this,n=t.href,c=t.byComment,i=t.notificationId;return Object(s.b)("a",{href:"".concat(n).concat(c?"#comment-".concat(c,"?notificationId=").concat(i):""),"data-za-detail-view-id":5109,onClick:function(e){e.preventDefault(),a.props.onCommentsModalOpen(t)},children:e})}},{key:"render",value:function(){var e,t=this.props.item,a=t.content,n=a.verb,c=a.actors,i=t.isRead;return Object(s.c)("div",{ref:this.rootRef,className:d()("PushNotifications-item",{"PushNotifications-newItem":!i}),children:[Object(s.b)("span",{children:(e=c,Array.isArray(e)||(e=[e]),e.map((function(e,t){return Object(s.b)("span",{className:"PushNotifications-actor",children:e.link?Object(s.b)("a",{href:e.link,"data-za-detail-view-id":5109,children:e.name}):Object(s.b)("span",{children:e.name})},t)})))})," ",n," ",this.renderTarget()]})}}]),a}(l.Component);t.default=f},2828:function(e,t,a){"use strict";a.r(t),a.d(t,"TipjarDialog",(function(){return Q}));var n=a(14),c=a(15),i=a(17),r=a(18),o=a(7),s=a(1),l=a(0),u=a.n(l),d=a(3),h=a.n(d),p=a(13),m=a.n(p),b=a(33),f=a(96),v=a(632),y=a(154),j=a(895),O=a(51),g=Object.assign;var P=function(e){return u.a.createElement(O.a,g({width:"14",height:"16",viewBox:"0 0 18 18"},e),u.a.createElement("path",{fill:"#9FADC7",d:"M18 9h-5.5c-1.37 0-2.5 1.12-2.5 2.5 0 1.39 1.12 2.5 2.5 2.5H18v1.997A1.999 1.999 0 0116.005 18H1.995A1.997 1.997 0 010 15.997V7.003C0 5.897.893 5 1.995 5h14.01C17.107 5 18 5.894 18 7.003V9zM4 4c.872-.374 1.696-.735 2.472-1.083.678-.294 1.35-.588 2.01-.882.663-.294 1.18-.52 1.55-.682.567-.254 1.072-.37 1.516-.35.444.02.765.03 1.126.19.36.16.703.633.857.793L15 4H4zm8.5 9a1.5 1.5 0 11.001-3.001A1.5 1.5 0 0112.5 13z",fillRule:"evenodd"}))},C=Object.assign;var N=function(e){return u.a.createElement(O.a,C({width:"14",height:"16",viewBox:"0 0 18 18"},e),u.a.createElement("path",{fill:"#0C2",d:"M6.276 12.186a.6.6 0 01-.523-.31l-.04-.086-1.638-3.622a.301.301 0 01.452-.369L6.46 9.185a.887.887 0 00.8.092L16.35 5.2C14.722 3.265 12.038 2 9 2 4.03 2 0 5.383 0 9.556c0 2.277 1.212 4.326 3.11 5.712a.608.608 0 01.22.685l-.406 1.524c-.02.07-.048.146-.048.22a.3.3 0 00.3.303.335.335 0 00.173-.056l1.97-1.146a.888.888 0 01.742-.1c.92.266 1.91.414 2.938.414 4.97 0 9-3.383 9-7.556a6.573 6.573 0 00-1.025-3.5L6.612 12.08l-.066.04a.604.604 0 01-.27.064z",fillRule:"evenodd"}))},w=a(81);function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=Object(o.a)(e);if(t){var c=Object(o.a)(this).constructor;a=Reflect.construct(n,arguments,c)}else a=n.apply(this,arguments);return Object(r.a)(this,a)}}var k=8,F=9,R=13,T=48,I=57;function L(e,t){return e?t?!0===t?"":t:e:""}var B=function(e){Object(i.a)(a,e);var t=S(a);function a(e){var c;return Object(n.a)(this,a),(c=t.call(this,e)).onInputFocus=c.onInputFocus.bind(Object(w.a)(c)),c.onInputChange=c.onInputChange.bind(Object(w.a)(c)),c.onKeyDown=c.onKeyDown.bind(Object(w.a)(c)),c}return Object(c.a)(a,[{key:"onInputFocus",value:function(){this.props.onFocus()}},{key:"onInputChange",value:function(e){var t=String(e.target.value);if(t){t=t[t.length-1];var a=this.props.chars,n=this.props.length;a.length===n?a=a.replace(/.$/,t):a+=t,this.props.onChange(a),a.length===n&&this.props.onFinish(a)}}},{key:"onKeyDown",value:function(e){var t=e.keyCode;if(!e.metaKey&&!e.ctrlKey&&t!==F&&t!==R){var a=this.props.chars;t===k?(a=a.slice(0,-1),this.props.onChange(a)):(t<T||t>I)&&(e.preventDefault(),this.props.onError(e))}}},{key:"focus",value:function(){this.input.focus()}},{key:"blur",value:function(){this.input.blur()}},{key:"render",value:function(){var e=this,t=this.props,a=t.length,n=t.chars,c=t.maskChar,i=t.autoFocus,r=t.className,o=t.children,l=n.length===a?a-1:n.length,u=n[l]||"";return Object(s.c)("label",{className:m()("TPass",r),children:[Object(s.c)("span",{className:"TPass-wrapper",children:[Object(s.b)(A,{length:a,chars:n,maskChar:c}),Object(s.b)("input",{className:"TPass-input",value:u,style:{left:60*l},onFocus:this.onInputFocus,onChange:this.onInputChange,onKeyDown:this.onKeyDown,onPaste:function(e){return e.preventDefault()},type:"number",min:"0",max:"9",pattern:"[0-9]*",autoFocus:i,ref:function(t){e.input=t}})]}),o]})}}]),a}(l.Component);function A(e){for(var t,a=e.length,n=e.chars,c=e.maskChar,i=[],r=0;r<a;r+=1)t=n[r],i.push(Object(s.b)("span",{className:m()("TPassBox",{"TPassBox-mask":t&&Boolean(c)}),children:L(t,c)},r));return Object(s.b)("span",{className:"TPassBoxes",children:i})}B.defaultProps={length:6,chars:"",maskChar:!1,autoFocus:!1,onFocus:function(){},onChange:function(){},onError:function(){},onFinish:function(){}},B.propTypes={length:h.a.number,chars:h.a.string,maskChar:h.a.oneOfType([h.a.bool,h.a.string]),autoFocus:h.a.bool,onFocus:h.a.func,onChange:h.a.func,onError:h.a.func,onFinish:h.a.func,className:h.a.string,children:h.a.node};var D=B;function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=Object(o.a)(e);if(t){var c=Object(o.a)(this).constructor;a=Reflect.construct(n,arguments,c)}else a=n.apply(this,arguments);return Object(r.a)(this,a)}}var M=function(e){Object(i.a)(a,e);var t=x(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){var e=this.props;return Object(s.b)("div",{className:m()("Spinner",e),children:Object(s.b)("i",{className:"Spinner-loading"})})}}]),a}(l.Component);M.propTypes={className:h.a.string};var U=a(192);function z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=Object(o.a)(e);if(t){var c=Object(o.a)(this).constructor;a=Reflect.construct(n,arguments,c)}else a=n.apply(this,arguments);return Object(r.a)(this,a)}}function E(){this.payments={},this.chosePaymentName=null,this.codeUrl="",this.qrLoaded=!1,this.need=null,this.passcode="",this.needSMS=!1,this.smsTimer=0,this.isInProgress=!1,this.error=null}var q=function(e){Object(i.a)(a,e);var t=z(a);function a(e){var c;return Object(n.a)(this,a),(c=t.call(this,e)).onPasscodeFocus=function(){c.state.error&&(c.setState({error:null}),6===c.state.passcode.length&&c.setState({passcode:""}))},c.onPasscodeInput=function(e){"object"==typeof e&&(e=e.target.value),c.setState({passcode:e})},c.onPasscodeFinish=function(e){c.tpass.blur(),c.payWithBalance(e)},c.onSendSMSCode=function(){c.props.trade.resendSMSCode((function(){c.startSMSTimer(),c.smsInput.focus()}),(function(e){c.setState({error:e})}))},c.onQrLoad=function(){c.setState({qrLoaded:!0})},c.onBalanceFormSubmit=function(e){e.preventDefault(),c.payWithBalance(c.state.passcode)},c.setPayments=function(e){c.setState({payments:e})},c.confirmPayment=function(){var e=c.state,t=e.choseName,a=e.payments,n=c.props.onConfirmPayment,i=t;if(t||(i=a.balance&&a.balance.enable?"balance":"wechat"),n(!i),c.setState({chosePaymentName:i}),"wechat"===i&&c.isInWechat){var r=c.props.tradeNumber,o="".concat(location.protocol,"//").concat(location.host).concat(location.pathname),s="".concat("https://www.zhihu.com/pay/weixin/pay?service_id=".concat(11)+"&trade_number=".concat(r,"&redirect_uri=").concat(encodeURIComponent(o)));window.location.replace(s)}else c.props.trade["wechat"===i?"initWechatPay":"initBalancePay"]()},c.pid=0,c.smsTimer=null,c.state=new E,c.isInWechat=e.ua.Wechat,c}return Object(c.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){var e=this.props.trade;this.getPaymentsList(e),this.initListeners(e)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this;e.trade!==this.props.trade&&(this.setState(new E),setTimeout((function(){t.getPaymentsList(e.trade)}),300),this.initListeners(e.trade))}},{key:"componentWillUnmount",value:function(){window.clearInterval(this.smsTimer),this.props.trade.dispose()}},{key:"getPaymentsList",value:function(e){var t=this;if(e){var a=this.pid+=1;e.getPaymentsList((function(e){t.pid===a&&t.setPayments(e)}))}}},{key:"initListeners",value:function(e){var t=this;e&&e.on("payInited",(function(e,a){t.setState(Object.assign({},a))})).on("paySuccess",(function(){t.setState({isInProgress:!1,error:null}),t.props.onSuccess()})).on("payCancel",(function(){t.setState({isInProgress:!1,chosePaymentName:null})})).on("payFail",(function(e){var a=e;"object"!=typeof e||e instanceof Error||(a=e.message),t.setState({isInProgress:!1,error:a}),t.props.onFail(e)})).on("needSMS",(function(e){t.setState({isInProgress:!1,error:null,needSMS:e.message,passcode:""})})).on("needWechatCode",(function(){t.props.onError("needWechatCode")})).on("error",(function(e,a){t.props.onError(e,a)}))}},{key:"startSMSTimer",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:60;window.clearInterval(this.smsTimer),this.setState({smsTimer:t}),this.smsTimer=window.setInterval((function(){(t-=1)<=0?(window.clearInterval(e.smsTimer),e.smsTimer=null,e.setState({smsTimer:0})):e.setState({smsTimer:t})}),1e3)}},{key:"payWithBalance",value:function(e){return 6!==e.length?(this.setState({error:"请输入 6 位支付密码"}),!1):(this.setState({isInProgress:!0,error:null}),this.props.trade.payWithBalance(e))}},{key:"renderPaymentsList",value:function(){var e,t=this,a=this.state,n=a.payments,c=a.chosePaymentName,i=a.choseName,r=this.props.trade;if(c)return null;var o=n.balance&&n.balance.amount,l=(null===(e=r.info)||void 0===e?void 0:e.total)||0,u=n.wechat&&n.wechat.enable,d=this.props.balanceEnable,h=n.balance&&n.balance.enable,p=n.balance&&!n.balance.enable,m=d&&o>=l,f="使用余额（剩余 ".concat((o/100).toFixed(2),"）"),v=m?f:"微信支付",O=m?"wallet":"wechatPayment";i&&(v="wechat"===i?"微信支付":f,O="wechat"===i?"wechatPayment":"wallet");var g=Object(s.c)(b.c,{css:{padding:0,border:"none"},children:["wechatPayment"===O?Object(s.b)(N,{center:!0}):Object(s.b)(P,{center:!0})," ",v,Object(s.b)(j.a,{center:!0})]});return Object(s.c)("div",{className:"PaymentsList",children:[Object(s.b)("span",{className:"Payment-Topline"}),Object(s.b)("span",{className:"PaymentWay",children:"支付方式"}),Object(s.b)(U.a,{placeholder:g,children:Object(s.c)(y.b,{plain:!0,className:"Payment-select",listClassName:"Payment-select-list",targetClassName:"Popover-targetContainer-verification",menuToggler:g,onChange:function(e){"disabled"!==e&&t.setState({choseName:e})},children:[d&&h&&Object(s.c)(y.a,{value:"balance",className:"PaymentItem",children:[Object(s.b)(P,{center:!0}),f]}),d&&p&&Object(s.c)(y.a,{value:"disabled",className:"PaymentItem PaymentItem--disabled",children:[Object(s.b)(P,{center:!0}),f]}),u&&Object(s.c)(y.a,{value:"wechat",className:"PaymentItem",children:[Object(s.b)(N,{center:!0}),"微信支付"]})]})}),Object(s.b)("span",{className:"Payment-Bottomline"}),Object(s.b)(b.c,{className:"Payment-CheckedButton",onClick:this.confirmPayment,children:"确认支付"})]})}},{key:"render",value:function(){var e=this,t=this.props,a=t.className,n=t.trade,c=this.state,i=c.payments,r=c.chosePaymentName,o=c.codeUrl,l=c.needSMS,u=c.isInProgress;return n?Object(s.c)("div",{className:m()("Payment",a),children:[Object.keys(i).length?this.renderPaymentsList():Object(s.b)("div",{className:"Payment-placeholder",children:Object(s.b)(M,{})}),"wechat"===r&&Object(s.c)("div",{className:"Payment-wechatPay",children:[Object(s.c)("div",{className:"Payment-wechatPayTitle",children:[Object(s.b)("i",{className:"icon icon-ic_wechatpay PaymentIconWechat"}),"微信支付"]}),!this.isInWechat&&Object(s.b)("div",{children:"使用微信扫描二维码完成支付"}),this.state.qrLoaded?Object(s.b)("span",{className:"Payment-qrWrapper",children:Object(s.b)("img",{alt:"二维码",src:"//www.zhihu.com/qrcode?url=".concat(o),width:"150",height:"150"})}):Object(s.c)("div",{className:"Payment-qrPlaceholder",children:[Object(s.b)(M,{}),!this.isInWechat&&Object(s.b)("div",{children:"正在生成二维码"}),o&&Object(s.b)("img",{alt:"点击展示二维码",src:"//www.zhihu.com/qrcode?url=".concat(o),width:"1",height:"1",onLoad:this.onQrLoad})]})]}),"balance"===r&&Object(s.c)("form",{onSubmit:this.onBalanceFormSubmit,className:"Payment-balancePay",children:[Object(s.c)("div",{className:"Payment-balancePayTitle",children:[Object(s.b)("i",{className:"icon icon-wallet PaymentIconWallet"}),"余额支付"]}),!l&&Object(s.c)("div",{children:[Object(s.b)("div",{className:"Payment-description",children:"请输入 6 位数知乎支付密码，用于支付验证。"}),Object(s.b)(D,{chars:this.state.passcode,onFocus:this.onPasscodeFocus,onChange:this.onPasscodeInput,maskChar:!0,onFinish:this.onPasscodeFinish,className:m()("Payment-tpass",{"Payment-errorInput":this.state.error,"Payment-progressing":u}),autoFocus:!0,ref:function(t){e.tpass=t},children:u&&Object(s.b)(M,{className:"Payment-balancePaySpinner"})})]}),Boolean(l)&&Object(s.c)("div",{className:"Payment-balancePaySms",children:[Object(s.b)("div",{className:"Payment-balancePaySmsText",children:String(l)}),Object(s.b)("input",{onChange:this.onPasscodeInput,value:this.state.passcode,className:m()("Payment-sms","SimpleInput",{"Payment-errorInput":this.state.error}),type:"text",pattern:"\\d{6}",minLength:"6",maxLength:"6",title:"验证码应为 6 位数字",placeholder:"输入 6 位数验证码",required:!0,autoFocus:!0,ref:function(t){e.smsInput=t}}),this.state.smsTimer?Object(s.c)("button",{className:"Payment-sendSms",type:"button",disabled:!0,children:[this.state.smsTimer," 秒后可重发"]}):Object(s.b)("button",{onClick:this.onSendSMSCode,className:"Payment-sendSms",type:"button",children:"发送验证码"})]}),Object(s.c)("div",{className:"Payment-balancePayFooter",children:[Object(s.b)("p",{className:"Payment-errorTip",style:{visibility:this.state.error?"visible":"hidden"},children:this.state.error}),Boolean(l)&&Object(s.b)(b.c,{color:"blue",disabled:u,className:"Payment-balancePayConfirmBtn",type:"submit",children:"确认"})]}),!l&&Object(s.c)("div",{className:"Payment-balancePayForget",children:["如果忘记密码请邮件联系"," ",Object(s.b)("email",{className:"Payment-email",children:"i@zhihu.com"})]})]})]}):Object(s.b)("div",{className:m()("Payment",a),children:Object(s.b)("div",{className:"Payment-placeholder Payment-placehoder--empty",children:Object(s.b)(M,{})})})}}]),a}(l.Component);q.propTypes={trade:h.a.object,autoChooseSinglePayment:h.a.bool,onSuccess:h.a.func.isRequired,onFail:h.a.func,onError:h.a.func,onConfirmPayment:h.a.func,balanceEnable:h.a.bool},q.defaultProps={trade:null,onSuccess:function(){},onFail:function(){},onError:function(){},autoChooseSinglePayment:!0,className:"",balanceEnable:!0};var W=q,_=a(122),H="",K=null;var Z=a(30);function G(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=Object(o.a)(e);if(t){var c=Object(o.a)(this).constructor;a=Reflect.construct(n,arguments,c)}else a=n.apply(this,arguments);return Object(r.a)(this,a)}}var J=[200,500,1e3,5e3,1e4,2e4],Q=function(e){Object(i.a)(a,e);var t=G(a);function a(e){var c;return Object(n.a)(this,a),(c=t.call(this,e)).onConfirmPayment=function(e){c.setState({chosePaymentName:e})},c.onPaySuccess=function(){c.props.onPaySuccess(),c.setState({chosePaymentName:!0,colseTijarDialogStatus:!0,trade:void 0,currentAmount:"",customButton:!1})},c.handleCustomAmount=function(){c.state.trade&&c.state.trade.dispose(),c.setState({showCustom:!0})},c.handleCustomChange=function(e){var t=e.target.value;isNaN(t)?c.setState({customAmount:""}):c.setState({customAmount:parseInt(t)||""})},c.handleCustomKeyUp=function(e){13===e.keyCode&&c.handleSubmitCustom()},c.handleSubmitCustom=function(){var e=100*c.state.customAmount;e>0&&e<=5e4&&(c.setState({customButton:!0,showCustom:!1,colseTijarDialogStatus:!1}),c.createTrade(e))},c.closeModal=function(){c.state.trade&&c.state.trade.dispose(),c.setState(c.getDefaultState())},c.handleAmountButton=function(e){c.createTrade(e.currentTarget.dataset.amount),c.setState({colseTijarDialogStatus:!1,customButton:!1,showCustom:!1})},c.createTrade=function(e){c.setState({tradeLoading:!0,currentAmount:e});var t=c.props.ua;c.props.addReward(e,t.Wechat?"wechat":"normal"),c.setState({tradeLoading:!1})},c.colseTijarDialog=function(){c.setState({chosePaymentName:!0,colseTijarDialogStatus:!0,trade:void 0,currentAmount:""}),c.props.colseTijarDialog()},c.state=c.getDefaultState(),c}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.showTip()}},{key:"componentDidUpdate",value:function(){var e=this.props,t=e.tradeNumber,a=e.type,n=this.state,c=n.trade,i=n.colseTijarDialogStatus,r="article"===a?11:17;if(t&&(!c||t!==c.tradeNo)&&!i){var o=new window.zhihu.pay.Trade(t,r);this.setState({trade:o})}}},{key:"componentWillUnmount",value:function(){this.props.TipjarRender&&this.props.removeTradeNumber()}},{key:"getDefaultState",value:function(){return{showCustom:!1,customAmount:"",currentAmount:"",showTipModal:!1,customButton:!1,chosePaymentName:!0,colseTijarDialogStatus:!1}}},{key:"showTip",value:function(){var e,t,a=this;e="https://pay.zhihu.com/api/js",t=function(){a.setState({showTipModal:!0})},H&&e&&e!==H&&t(new Error("A pay-sdk from different source has been load")),H=e,window.zhihu&&window.zhihu.pay?window.zhihu.pay.ready(t):(K||(K=Object(_.loadScript)(e)),K.then((function(){return window.zhihu.pay.ready(t)}),(function(e){t(e),K=null})))}},{key:"renderAmountCustom",value:function(){var e=this.state,t=e.showCustom,a=e.customAmount,n=e.currentAmount,c=e.customButton;return Object(s.b)("div",{className:"Reward-TipjarDialog-amountCustom",children:t?Object(s.c)("div",{className:"Reward-TipjarDialog-amountInput",children:[Object(s.b)("input",{name:"",type:"text",className:"SimpleInput",placeholder:"你想赞赏的金额（不超过 500）",value:a,onChange:this.handleCustomChange,onKeyUp:this.handleCustomKeyUp,ref:function(e){e&&e.focus()}}),Object(s.b)(b.c,{disabled:a<=0||a>500,color:"blue",preset:"primary",onClick:this.handleSubmitCustom,children:"确定"}),Object(s.b)("div",{className:"Reward-TipjarDialog-error",style:{display:a>500?"block":"none"},children:"不能超过 500 元"})]}):Object(s.b)(b.c,{preset:"plain",className:c?"TipjarDialog-customButton-cheked":"TipjarDialog-customButton",onClick:this.handleCustomAmount,children:c?"自定义金额： ¥ ".concat(n/100):"自定义金额"})})}},{key:"renderTipjarDialog",value:function(){var e=this,t=this.props,a=t.author,n=a.name,c=a.avatarUrl,i=a.isOrg,r=a.urlToken,o=a.id,l=t.tagline,u=this.state.currentAmount;return Object(s.c)("div",{className:"Reward-TipjarDialog",children:[Object(s.c)("div",{className:"Reward-TipjarDialog-user",children:[Object(s.b)("a",{href:"/".concat(i?"org":"people","/").concat(r||o),className:"Reward-UserAvatar",children:Object(s.b)("img",{src:c.replace("_is","_l"),className:"Reward-Avatar",alt:"当前用户"})}),n]}),Object(s.b)("div",{className:"Reward-TipjarDialog-tagLine",children:l}),Object(s.c)("div",{className:"Reward-TipjarDialog-selectAmount",children:[Object(s.b)("div",{className:"Reward-TipjarDialog-amountList",children:J.map((function(t){return Object(s.b)(b.c,{"data-amount":t,onClick:e.handleAmountButton,color:"red",className:m()({"Reward-Button-checked":Number(u)===t}),children:Object(s.b)("b",{children:Number(u)===t?"".concat(t/100," 元"):"¥ ".concat(t/100)})},t)}))}),this.renderAmountCustom()]})]})}},{key:"render",value:function(){var e=this.props,t=e.ua,a=e.TipjarRender,n=e.isMobile,c=e.tradeNumber,i=e.balanceEnable,r=this.state,o=r.showCustom,l=r.tradeLoading,u=r.showTipModal,d=r.trade,h=r.chosePaymentName,p=n?v.a:f.b,m=n?"small":"default";return Object(s.b)(p,{overlay:!0,size:m,onClose:this.colseTijarDialog,className:"Reward-TipjarDialogModal",children:a&&Object(s.c)("div",{children:[u&&h&&this.renderTipjarDialog(),(d||l)&&!o&&Object(s.b)(W,{trade:d,tradeNumber:c,ua:t,onSuccess:this.onPaySuccess,onConfirmPayment:this.onConfirmPayment,balanceEnable:i})]})})}}]),a}(l.Component);Q.propTypes={author:h.a.object,tagline:h.a.string,colseTijarDialog:h.a.func,addReward:h.a.func,tradeNumber:h.a.string,removeTradeNumber:h.a.func,onPaySuccess:h.a.func,isMobile:h.a.bool,type:h.a.string,balanceEnable:h.a.bool},Q.defaultProps={tagline:Z.p,balanceEnable:!0}},986:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));a(0);var n=a(13),c=a.n(n),i=a(8),r=function(e){var t=e.avatar,a=e.bottom,n=e.button,r=e.className,o=e.height,s=e.icon,l=e.inline,u=e.right,d=e.style,h=void 0===d?{}:d,p=e.title,m=e.width,b=Object.assign({},h);return m&&(b.width="".concat(m,"px")),o&&(b.height="".concat(o,"px")),a&&(b.marginBottom="".concat(a,"px")),u&&(b.marginRight="".concat(u,"px")),Object(i.g)("div",{className:c()("Holder",r,{"Holder--inline":l,"Holder--title":p,"Holder--icon":s,"Holder--button":n,"Holder--avatar":t}),style:b})}},995:function(e,t,a){"use strict";var n=a(34),c=a.n(n),i=a(23),r=a.n(i),o=a(28),s=a.n(o),l=a(27),u=a.n(l),d=a(29),h=a.n(d),p=a(19),m=a.n(p),b=a(41),f=a.n(b),v=a(3),y=a.n(v),j=a(0),O=a(8),g=["src","title"];function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=m()(e);if(t){var c=m()(this).constructor;a=Reflect.construct(n,arguments,c)}else a=n.apply(this,arguments);return h()(this,a)}}var C=function(e){u()(a,e);var t=P(a);function a(){return r()(this,a),t.apply(this,arguments)}return s()(a,[{key:"render",value:function(){var e=this.props,t=e.src,a=t.content,n=t.attributes,i=e.title,r=c()(e,g);return Object(O.g)("svg",f()({},n,r),Object(O.g)("title",null,i),Object(O.g)("g",{dangerouslySetInnerHTML:{__html:a}}))}}]),a}(j.Component);C.propTypes={src:y.a.object.isRequired},t.a=C}}]);
//# sourceMappingURL=main.modals.1d992ff1f32cfe66b06b.js.map