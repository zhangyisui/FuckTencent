(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{1114:function(e,t,n){"use strict";var i=n(0),c=n(48),r=Object(i.createContext)({}),o=n(125);t.a=Object(c.withRouter)((function(e){var t=e.to,n=e.router,c=Object(i.useContext)(r);return c.url||(c.url=t),Object(i.useEffect)((function(){Object(o.isAbsoluteUrl)(t)?window.location.replace(t):n.replace(t)}),[n,t]),null}))},1156:function(e,t,n){"use strict";var i=n(32),c=n(14),r=n(15),o=n(17),a=n(18),s=n(7),l=n(1),u=n(0),d=n(13),b=n.n(d),h=n(48),p=n(33),f=n(72),m=n(433),v=["to","className","children"];function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(s.a)(e);if(t){var c=Object(s.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(a.a)(this,n)}}var j=function(e){Object(o.a)(n,e);var t=O(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"render",value:function(){var e=this.props,t=e.to,n=e.className,c=e.children,r=Object(i.default)(e,v),o=b()("QuestionMainAction",n);return t?Object(l.b)(m.a,{zaBlock:"QuestionMainAction",zaText:!0,zaType:"Text",children:Object(l.b)(h.Link,Object.assign(Object.assign({to:t,href:t,className:o},r),{},{children:c}))}):Object(l.b)(f.a,{zaBlock:"QuestionMainAction",zaText:!0,zaType:"Button",children:Object(l.b)(p.c,Object.assign(Object.assign({className:o},r),{},{children:c}))})}}]),n}(u.Component);t.a=j},1189:function(e,t,n){"use strict";n.d(t,"b",(function(){return l}));var i=n(47),c=n(1),r=n(0),o=n(59),a=n.n(o),s=Object(r.createContext)([!0,a.a,a.a]);s.displayName="DisplayPriorityContext";var l=function(){return Object(r.useContext)(s)},u=function(e){var t=e.children,n=e.readyStatus,i=e.shownStatus,o=e.index,a=e.setReadyStatusList,l=Object(r.useRef)(n);Object(r.useEffect)((function(){l.current=n}),[n]);var u=Object(r.useCallback)((function(){"pending"===l.current&&a((function(e){return e.map((function(e,t){return t===o?"resolved":e}))}))}),[a,o]),d=Object(r.useCallback)((function(){"pending"===l.current&&a((function(e){return e.map((function(e,t){return t===o?"rejected":e}))}))}),[a,o]),b=Object(r.useMemo)((function(){return[i,u,d]}),[i,u,d]);return Object(c.b)(s.Provider,{value:b,children:t})};t.a=function(e){var t=e.children,n=Object(r.useState)((function(){return r.Children.map(t,(function(){return"pending"}))})),o=Object(i.a)(n,2),a=o[0],s=o[1],l=Object(r.useMemo)((function(){var e=!1;return a.map((function(t){return!e&&("rejected"!==t&&(e=!0,"pending"!==t))}))}),[a]);return Object(c.b)(c.a,{children:r.Children.map(t,(function(e,t){return Object(c.b)(u,{readyStatus:a[t],shownStatus:l[t],index:t,setReadyStatusList:s,children:e},t)}))})}},1197:function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return O})),n.d(t,"c",(function(){return j}));var i=n(32),c=n(1),r=n(58),o=n(72),a=n(2152),s=n(1124),l=n(148),u=n(1463),d=n(93),b=n(150),h=n(914),p=["item","className","renderTimeTopic"],f=["item"],m={"火爆":"GRD01A","飙升":"GRD03A","热议":"GRD10A","上升":"GYL01A","新题":"GBL08A"},v=function(e){var t=e.item,n=e.className,o=e.renderTimeTopic,a=void 0!==o&&o,s=Object(i.default)(e,p),b=t.question,f=b.url,v=b.title,O=b.topics,j=b.label,g=b.created,y=b.highlightTitle,w=t.reaction;return Object(c.c)(r.Box,Object.assign(Object.assign({flexBasis:"353px",className:n,pr:"43px"},s),{},{children:[Object(c.b)(h.a,{href:f,zaType:"Card",target:"_blank",children:Object(c.c)(r.Box,{css:function(e){return Object.assign(Object.assign({},Object(d.d)(2)),{},{fontSize:"15px",color:e.colors.GBK03A,fontWeight:500,lineHeight:"21px"})},children:[Boolean(j)&&Object(c.b)(r.Box,{p:"2px 4px",css:function(e){return{background:e.colorMod(e.colors[m[j]]).alpha(.14),border:"1px solid ".concat(e.colorMod(e.colors[m[j]]).alpha(.1)),borderRadius:"2px",fontSize:"12px",color:e.colors[m[j]],display:"inline-block",lineHeight:"12px",marginRight:"2px",fontWeight:"500",position:"relative",top:"-2px"}},children:j}),a?Object(c.b)("span",{css:function(e){return{"& em":{color:e.colors.GRD03A,fontStyle:"normal"}}},dangerouslySetInnerHTML:{__html:y}}):v]})}),Object(c.c)(r.Box,{mt:"10px",css:{height:null!=O&&O.length||a?"23px":"0px",overflow:"hidden"},children:[null==O?void 0:O.map((function(e){var t=e.name,n=e.urlToken;return Object(c.c)(h.a,{href:"https://www.zhihu.com/topic/".concat(n),zaType:"Tag",target:"_blank",css:function(e){return{display:"inline-block",padding:"3px 6px",background:e.colors.GBK10A,fontSize:"12px",lineHeight:"17px",fontWeight:"400",color:e.colors.GBK04A,whiteSpace:"nowrap","&:nth-of-type(n + 2)":{marginLeft:8}}},children:["#",t]},n)})),a&&Object(c.b)(r.Text,{color:"GBK06A",fontSize:"13px",mt:O?"10px":"0px",children:O?"提问时间：".concat(u.a(1e3*g,"yyyy-MM-dd")):"".concat(Object(l.cnNiceNumber)((null==w?void 0:w.answerNum)||0)," 回答 · ").concat(Object(l.cnNiceNumber)((null==w?void 0:w.followNum)||0)," 关注")})]})]}))},O=function(e){var t=e.item,n=Object(i.default)(e,f),l=t.question,u=l.token,d=l.haveAnswer,h=l.questionAnswerUrl,p="https://www.zhihu.com/question/".concat(u,"?write");return Object(c.b)(r.Flex,Object.assign(Object.assign({justifyContent:"center",flexBasis:"131px"},n),{},{children:Object(c.b)(o.a,{zaType:"Button",zaText:!0,zaAction:"OpenUrl",extra:{link:{get url(){return d?h:p}}},children:d?Object(c.b)(b.a,{icon:a.a,label:"查看回答",href:h,target:"_blank",css:{padding:"0 9px"}}):Object(c.b)(b.a,{className:"QuestionItem-footer--writeAnswerButton",label:"写回答",icon:s.a,href:p,target:"_blank"})})}))},j=function(e){var t=e.score,n=e.level,i=e.Icon,o=e.color;return Object(c.c)(r.Box,{children:[Object(c.c)(r.Text,{color:"GBK03A",fontSize:"14px",lineHeight:"18px",fontWeight:"400",children:[t.toFixed(1)," 分"]}),Object(c.b)(r.Flex,{mt:"8px",alignItems:"center",children:new Array(5).fill().map((function(e,t){return Object(c.c)(r.Box,{css:{position:"relative"},children:[Object(c.b)(i,{size:12,css:function(e){return Object.assign({color:e.colors[o]},t+1>n&&{opacity:"0.2"})}}),t+1===Math.ceil(n)&&Object(c.b)(i,{size:12,css:function(e){return{color:e.colors[o],position:"absolute",left:"0",top:"3px",clip:"rect(0, ".concat(n%1*12,"px, 12px, 0px)")}}})]},t)}))})]})}},1211:function(e,t,n){"use strict";var i=n(14),c=n(15),r=n(17),o=n(18),a=n(7),s=n(1),l=n(0),u=n(21),d=n(47),b=n(81),h=n(3),p=n.n(h),f=n(13),m=n.n(f),v=n(113),O=n.n(v),j=n(26),g=n(219),y=n(33),w=n(139),C=n(896),k=n(912),x=n(944),A=n(174),R=n(440),S=n(431),N=n(924),T=n(1156),q=n(48),B=n(72),Q=n(148),I=n(437),P=n(999),E=n(991);function z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(a.a)(e);if(t){var c=Object(a.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(o.a)(this,n)}}var L=function(e,t){return e&&e.replace(new RegExp(null==t?void 0:t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),(function(e){return"<em>".concat(e,"</em>")}))},M=function(e){Object(r.a)(n,e);var t=z(n);function n(){var e;Object(i.a)(this,n);for(var c=arguments.length,r=new Array(c),o=0;o<c;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={mounted:!1},e.handleInvite=function(){var t=e.props,n=t.user.urlToken,i=t.onInvite;j.a.trackEvent(Object(b.a)(e),{id:3314}),i(n)},e.getContainer=function(){return document.querySelector(".Modal-content .QuestionInvitation-content")},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.setState({mounted:!0})}},{key:"render",value:function(){var e=this.props,t=e.user,n=e.contributionsCount,i=e.topic,c=e.isInvited,r=e.keyword,o=e.reason,a=t.name,l=Object.assign(Object.assign({},t),{},{name:Object(s.b)(I.a,{inline:!0,html:L(a,r)})}),u=Object(s.b)(E.a,{user:l,status:o||(n?Object(s.c)("div",{children:["在话题 ",Object(s.b)(P.a,{topic:i})," 下有 ",Object(s.c)(q.Link,{to:"/people/".concat(t.urlToken,"/answers/topic/").concat(i.id),children:[Object(Q.formatNumber)(n)," 个回答"]})]}):Object(s.b)(I.a,{html:t.headline})),action:Object(s.b)(B.a,{as:y.c,zaText:!0,zaType:"Button",zaAction:"Invite",color:c?void 0:"blue",disabled:c,onClick:this.handleInvite,children:c?"已邀请":"邀请回答"}),meta:null}),d={module:"UserItem",index:this.props.index,content:{member_hash_id:t.id},view:{id:r?4436:4437},extra:{search:{raw_query:r||""}},trackCardShow:!0};return this.state.mounted?Object(s.b)(S.a,Object.assign(Object.assign({getContainer:this.getContainer},d),{},{children:u})):u}}]),n}(l.Component),D=n(920),F=n(39);function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(a.a)(e);if(t){var c=Object(a.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(o.a)(this,n)}}var _=function(e){Object(r.a)(n,e);var t=H(n);function n(){var e;Object(i.a)(this,n);for(var c=arguments.length,r=new Array(c),o=0;o<c;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).handleClick=function(){var t=e.props,n=t.questionId,i=t.closeAutoInvite,c=t.openAutoInvite;return"close"===t.item.status?(j.a.trackEvent(null,{id:3313}),c(n)):i(n)},e}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props.item,t=void 0===e?{}:e,n=t.avatar,i=t.description,c=t.status,r=t.title,o="close"===c;return Object(s.b)(D.e,{data:t,image:Object(s.b)(g.a,{size:38,url:n}),title:r,meta:Object(s.b)(D.d,{children:i}),className:"AutoInviteItem-wrapper--desktop",extra:Object(s.b)(y.c,{preset:"link",className:o?"AutoInviteItem-button--closed":"AutoInviteItem-button--open",onClick:this.handleClick,children:o?"开启邀请":"已开启"})})}}]),n}(l.Component);_.propTypes={questionId:p.a.number.isRequired,item:p.a.object};var U=Object(u.connect)(null,{openAutoInvite:F.V,closeAutoInvite:F.d})(_),V=n(1115);function G(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(a.a)(e);if(t){var c=Object(a.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(o.a)(this,n)}}var W=function(e){var t=e.user;return Object(s.b)("div",{className:"InviteeItem",children:Object(s.c)("div",{className:"InviteeItem-content",children:[Object(s.b)(g.a,{url:t.avatarUrl,size:32,className:"InviteeItem-image"}),Object(s.b)("h4",{className:"InviteeItem-title",children:t.name})]})})},K=function(e){Object(r.a)(n,e);var t=G(n);function n(){var e;Object(i.a)(this,n);for(var c=arguments.length,r=new Array(c),o=0;o<c;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={expanded:!1,keyword:null},e.onChange=O()((function(t){e.props.onChange(t)}),300),e.handleChange=function(t){var n=t.target.value;e.setState({keyword:n}),n&&e.onChange(n)},e.handleExpand=function(){j.a.trackEvent(Object(b.a)(e),{action:"LoadMore",element:"Button"}),e.setState({expanded:!0})},e.handleInvite=function(t){var n=e.state.keyword;return(0,e.props.onInvite)(t,n)},e}return Object(c.a)(n,[{key:"renderHeader",value:function(){var e=this.props,t=e.invitees,n=(e.expandCount,Object(s.b)(w.a,{className:"QuestionInvitation-input",placeholder:"搜索你想邀请的人",onChange:this.handleChange,after:Object(s.b)(C.a,{size:18,fill:"grey"}),"data-tooltip":"也可以搜索职业、公司等资料","aria-label":"也可以搜索职业、公司等资料","data-tooltip-position":"bottom"})),i=[t.length?Object(s.c)("span",{children:["你已邀请 ",Object(s.b)(A.a,{toggler:Object(s.c)(y.c,{className:"Invitees-toggler",preset:"plain",children:[Object(s.b)("span",{className:"Invitees-togglerUsers",children:t.slice(0,2).map((function(e,t){return Object(s.c)("span",{children:[0===t?"":"、",Object(s.b)("span",{children:e.name})]},t)}))}),t.length>2&&" 等 ".concat(t.length," 人")]}),toggleEvent:"hover",targetClassName:"Invitees-popover",arrowed:!0,children:Object(s.b)("div",{className:"Invitees",children:t.map((function(e){return Object(s.b)(W,{user:e},e.urlToken)}))})})]}):Object(s.b)("h2",{className:"QuestionInvitation-title",children:"你可以邀请下面用户，快速获得回答"}),n],c=Object(d.a)(i,2),r=c[0],o=c[1];return Object(s.b)(V.a,{header:r,options:o})}},{key:"render",value:function(){var e=this,t=this.props,n=t.isFetching,i=t.isDrained,c=t.items,r=t.searchItems,o=t.expandCount,a=t.autoInvitationItem,l=t.question,u=(l=void 0===l?{}:l).id,d=this.state,b=d.expanded,h=d.keyword,p=h?r:c,f=Boolean((void 0===o||o>0)&&!h&&p.length&&a&&a.status),v=f?o-1:o,O=!v||b,j=o?k.d:"div";return Object(s.c)(j,{className:"QuestionInvitation",children:[this.renderHeader(),n?Object(s.b)("div",{className:m()("QuestionInvitation-content","QuestionInvitation-content--centered"),children:Object(s.b)(R.a,{})}):Object(s.c)("div",{className:m()("QuestionInvitation-content",{"QuestionInvitation-content--centered":!p.length}),children:[p.length?Object(s.b)(S.a,{module:"UserList",children:Object(s.c)(x.b,{children:[f&&Object(s.b)(U,{questionId:u,item:a}),(O?p:p.slice(0,v)).map((function(t){return Object(s.b)(x.a,{className:m()({"List-item--mobile":!1}),children:Object(s.b)(M,Object.assign(Object.assign({},t),{},{keyword:h,onInvite:e.handleInvite}))},t.user.urlToken)}))]})}):Object(s.c)(N.k,{children:[Object(s.b)(N.f,{}),Object(s.b)("div",{children:i?"没有可以邀请的人":"没有找到你想邀请的人"})]}),p.length>v&&!O&&Object(s.b)(T.a,{onClick:this.handleExpand,children:"更多推荐结果"})]})]})}}]),n}(l.Component);K.propTypes={expandCount:p.a.number,items:p.a.array,searchItems:p.a.array,onInvite:p.a.func.isRequired};var J=Object(S.b)({module:"InvitationFrame"})(K),Z=n(130);function Y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(a.a)(e);if(t){var c=Object(a.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(o.a)(this,n)}}var $=function(e){Object(r.a)(n,e);var t=Y(n);function n(){var e;Object(i.a)(this,n);for(var c=arguments.length,r=new Array(c),o=0;o<c;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).handleChange=function(t){var n=e.props,i=n.question.id;(0,n.loadItems)(i,"invitationCandidates",{keyword:t})},e.handleInvite=function(t,n){e.props.updateInvitation(e.props.question.id,t,n?"search":"normal")},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.question,n=t.id,i=t.status,c=(i=void 0===i?{}:i).isLocked,r=i.isClose,o=i.isEvaluate,a=i.isSuggest,s=e.loadItems,l=e.loadAutoInvitation;e.isDrained||c||r||o||a||(s(n,"invitationCandidates"),s(n,"invitees"),l(n))}},{key:"render",value:function(){var e=this.props.question.status,t=e.isLocked,n=e.isClose,i=e.isEvaluate,c=e.isSuggest;return t||n||i||c?null:Object(s.b)(J,Object.assign({onChange:this.handleChange,onInvite:this.handleInvite},this.props))}}]),n}(l.Component);t.a=Object(u.connect)((function(e,t){var n=t.question.id,i=e.entities,c=i.users,r=i.topics,o=e.question,a=o.invitationCandidates,s=o.invitees,l=o.autoInvitation,u=function(e){var t=e.member,n=e.isInvited,i=e.topicContributions,o=e.reason,a=i&&i.sort((function(e,t){return t.contributionsCount-e.contributionsCount}))[0]||{},s=a.topic,l=a.contributionsCount;return{user:c[t],topic:r[s],isInvited:n,contributionsCount:l,reason:o}},d=a[n]||{isFetching:!1,isDrained:!1,items:[],searchItems:[]},b=d.isFetching,h=d.isDrained,p=d.items,f=d.searchItems,m=(s[n]||{items:[]}).items;return{isFetching:b,isDrained:h,items:p.map(u),searchItems:f.map(u),invitees:m.map((function(e){return c[e]})),autoInvitationItem:l[n]}}),{loadItems:Z.R,updateInvitation:Z.mb,loadAutoInvitation:Z.G})($)},1247:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),c=n.n(i),r=n(12),o=Object.assign;function a(e){return c.a.createElement(r.a,o(o({width:"24",height:"24",viewBox:"0 0 24 24","data-new-api":"UsersFill24","data-old-api":"Users"},e),{className:"Zi Zi--Users"+(e.className?" ".concat(e.className):"")}),c.a.createElement("path",{d:"M4.5 8A5.5 5.5 0 0110 2.5 5.5 5.5 0 0115.5 8a5.5 5.5 0 01-5.5 5.5A5.5 5.5 0 014.5 8zm-.602 7.738c.965-1.075 2.418-1.574 4.19-1.325 1.263.178 2.56.178 3.825 0 1.77-.249 3.224.25 4.189 1.325.628.7 1.212 1.69 1.657 2.656.442.961.78 1.973.868 2.733.07.6-.424 1.023-.927 1.023H2.3c-.503 0-.997-.423-.927-1.023.088-.76.426-1.772.868-2.733.444-.967 1.029-1.956 1.657-2.656zm12.312-2.046a.743.743 0 01-.309-.24.747.747 0 01.081-.995c.338-.335.655-.827.92-1.37.441-.906.652-1.98.59-3.065-.036-.607-.135-1.289-.302-1.782a.75.75 0 011.42-.48c.228.672.34 1.503.379 2.176.076 1.327-.178 2.658-.739 3.809a7.991 7.991 0 01-.594 1.028c.89.564 1.632 1.316 2.22 2.083.768 1.002 1.308 2.075 1.585 2.907a.75.75 0 11-1.423.474c-.223-.668-.682-1.595-1.352-2.468-.667-.87-1.507-1.643-2.476-2.077z",fillRule:"evenodd",clipRule:"evenodd"}))}},1465:function(e,t,n){"use strict";n.d(t,"a",(function(){return xe}));var i=n(1),c=n(192),r=n(469),o=n(2),a=n(47),s=n(0),l=n(3),u=n.n(l),d=n(21),b=n(33),h=n(96),p=n(45),f=n(130),m=n(31),v=n(455),O=[{value:"标点或格式错误",text:"标点或格式错误"},{value:"不构成提问",text:"不构成提问"},{value:"包含主观判断",text:"包含主观判断"},{value:"缺乏可信来源",text:"缺乏可信来源"},{value:"other",text:"其他"}],j=[{title:"为什么修改问题？",subtitle:"请选择修改理由"},{title:"修改问题",subtitle:"描述精确的问题更易得到解答"},{title:"其他",subtitle:"请对你的举报补充说明"}],g=u.a.shape({level:u.a.oneOf(["error","warning"]),text:u.a.string}),y=n(449),w=n.n(y),C="form.setInput",k="form.setState",x="form.setErrors",A="ui.setState",R="reset",S={step:0,title:"",detail:{toHTML:function(){return""}},topics:[],reason:O[0].value,otherReason:"",onceChanged:!1,videoQuestionConfirmShown:!1,videoQuestionConfirmAllowContinue:!1,videoQuestionConfirmTitle:"",videoQuestionConfirmText:"",uploadModalShown:!1,errors:{title:null,detail:null,reason:null,topics:null}};function N(e,t){var n=t.type,i=t.payload;switch(n){case C:var c,r=Object(a.a)(i,2),s=r[0],l=r[1];return Object.assign(Object.assign({},e),{},(c={},Object(o.a)(c,s,l),Object(o.a)(c,"onceChanged",function(e,t){var n=Object(a.a)(t,2),i=n[0],c=n[1];if(e.onceChanged)return!0;var r=e[i];return"reason"===i?1===e.step&&e.reason===c:"topics"===i?!w()(c,r):r!==c}(e,i)),c));case k:return Object.assign(Object.assign({},e),i);case x:return Object.assign(Object.assign({},e),{},{errors:Object.assign(Object.assign({},e.errors),i)});case A:var u=Object(a.a)(i,2),d=u[0],b=u[1];return Object.assign(Object.assign({},e),{},Object(o.a)({},d,b));case R:return Object.assign({},S);default:return e}}var T=function(e,t){var n=Object(s.useRef)();Object(s.useEffect)((function(){n.current=t}));var i=Object(s.useState)(e),c=Object(a.a)(i,2),r=c[0],o=c[1];return Object(s.useEffect)((function(){e!==r&&(n.current([e,r]),o(e))}),[e,r]),null},q=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.errors;if(!t||"title"===t){var c=e.title,r=null;0!==c.length||n?c.length>51?r={level:"error",text:"问题标题超出 ".concat(c.length-51," 个字")}:c.length>0&&c.length<3?r={level:"error",text:"问题字数太少了吧"}:c.length>0&&-1===c.indexOf("?")&&-1===c.indexOf("？")?r={level:"error",text:"你还没有给问题添加问号"}:(c.match(/(\?|？)/g)||[]).length>1&&(r={level:"warning",text:"多个问题建议拆分"}):r={level:"error",text:"问题标题不能为空"},i=Object.assign(Object.assign({},i),{},{title:r})}if(!t||"reason"===t){var o=e.reason,a=e.otherReason,s=null;o&&("other"!==o||a)||(s={level:"error",text:o?"必填":"必选"}),i=Object.assign(Object.assign({},i),{},{reason:s})}if((!t||"topics"===t)&&e.topics){var l=e.topics,u=null;0!==l.length||n||(u={level:"error",text:"至少添加一个话题"}),i=Object.assign(Object.assign({},i),{},{topics:u})}return i},B=n(910),Q=n(93),I=function(e){var t=e.onSelect,n=Object(Q.f)();return Object(i.b)("div",{children:O.map((function(e){return Object(i.c)("div",{css:{display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",lineHeight:"48px",boxShadow:"inset 0 -1px 0 0 ".concat(n.colors.GBK10A),"&:last-child":{marginBottom:"16px"}},role:"button",tabIndex:0,onClick:function(){return t(e.value)},children:[e.text,Object(i.b)(B.a,{css:{fill:n.colors.GBL05A}})]},e.value)}))})};I.propTypes={onSelect:u.a.func.isRequired};var P=I,E=function(e){var t=e.title,n=e.text,c=e.shown,r=e.allowConfirm,o=void 0===r||r,a=e.onSubmit,s=e.onClose,l=e.buttonText,u=void 0===l?{}:l;return Object(i.b)(h.b,{title:t,onClose:s,children:c&&Object(i.c)("div",{color:"GBK03A",css:{margin:"50px 16px 0",fontSize:"20px",textAlign:"center"},children:[n,Object(i.c)(h.a,{children:[o&&Object(i.b)(b.c,{preset:"primary",color:"blue",onClick:a,children:u.ok||"确认"}),Object(i.b)(b.c,{onClick:s,children:u.cancel||"取消"})]})]})})};E.propTypes={title:u.a.string,text:u.a.string,shown:u.a.bool,allowConfirm:u.a.bool,onSubmit:u.a.func.isRequired,onClose:u.a.func.isRequired,buttonText:u.a.shape({ok:u.a.string,cancel:u.a.string})};var z=E,L=n(58),M=n(139),D=n(32),F=["children","css"],H=["children","css"],_=["children","css"],U=["before","after","headerLabel","headerRight","children"],V=function(e){var t=e.children,n=e.css,c=Object(D.default)(e,F);return Object(i.b)(L.Flex,Object.assign(Object.assign({alignItems:"center",mb:"8px",color:"GBL05A",css:n},c),{},{children:t}))},G=function(e){var t=e.children,n=e.css,c=Object(D.default)(e,H);return Object(i.b)(L.Box,Object.assign(Object.assign({ml:"auto",css:n},c),{},{children:t}))},W=function(e){var t=e.children,n=e.css,c=Object(D.default)(e,_);return Object(i.b)(L.Text,Object.assign(Object.assign({as:"span",color:"GBK03A",css:n},c),{},{children:t}))},K=function(e){var t=e.before,n=e.after,c=e.headerLabel,r=e.headerRight,o=e.children,a=Object(D.default)(e,U),s=c||r;return Object(i.c)(L.Box,Object.assign(Object.assign({mb:"12px",css:{"& .Popover":{display:"block"},"& .TagInput":{lineHeight:0}}},a),{},{children:[t,s&&Object(i.c)(V,{children:[c&&Object(i.b)(W,{children:c}),r&&Object(i.b)(G,{children:r})]}),o,n]}))};K.Header=V,K.HeaderLabel=W,K.HeaderRight=G;var J=K,Z=["children","level"],Y={warning:"GYL01A",error:"GRD03A"},$=function(e){var t=e.children,n=e.level,c=Object(D.default)(e,Z);return Object(i.b)(L.Text,Object.assign(Object.assign({as:"span",color:Y[n]},c),{},{children:t}))},X=function(e){return Object(i.b)(r.a,{message:"一个未知的错误信息 ".concat(typeof e.children),children:Object(i.b)($,Object.assign({},e))})},ee=$,te=function(e){var t=e.onInputRef,n=e.title,c=e.onChange,r=e.onBlur,o=e.titleError,l=e.before,u=e.after,d=Object(s.useState)(!1),b=Object(a.a)(d,2),h=b[0],p=b[1],f=null;if(h){var m=51-n.length;m>=0?m<10&&(f="还可以输入 ".concat(m," 个字")):f=Object(i.c)(ee,{level:"error",children:["问题标题超出 ",-m," 个字"]})}else o&&(f=Object(i.b)(ee,{level:o.level,children:o.text}));var v=Object(s.useCallback)((function(e){p(!0),c&&c(e)}),[c]),O=Object(s.useCallback)((function(e){p(!1),r&&r(e)}),[r]),j=Object(s.useRef)();return Object(s.useEffect)((function(){setTimeout((function(){var e;return null===(e=j.current)||void 0===e?void 0:e.focus()}),60)}),[]),Object(i.c)(i.a,{children:[Object(i.b)(J,{children:Object(i.c)(L.Flex,{children:[l,Object(i.b)(M.a,{css:{border:"0 none",fontSize:"15px"},onRef:function(e){j.current=e,t(e)},required:!0,multiline:!0,spread:!0,large:!0,rows:2,placeholder:"问题标题",value:n,onChange:v,onBlur:O}),u]})}),f&&Object(i.b)(J,{headerRight:f})]})};te.propTypes={onInputRef:u.a.func,title:u.a.string,titleError:g,onChange:u.a.func,onBlur:u.a.func};var ne=te,ie=n(906),ce=n(907),re=n(908),oe=n(302),ae=n(465),se=n(476),le=function(e){var t=e.onEditableRef,n=e.defaultValue,c=e.onChange,r=e.detailError,o=e.isAnonymous,l=Object(d.useDispatch)(),u=Object(s.useCallback)((function(){return l(m.h.apply(void 0,arguments))}),[l]),b=Object(s.useRef)(),h=Object(s.useState)(!1),p=Object(a.a)(h,2),f=p[0],v=p[1],O=Object(s.useCallback)((function(){b.current&&b.current.handleKeyCommand("insert-image")}),[]),j=Object(s.useCallback)((function(){b.current&&b.current.handleKeyCommand("insert-video")}),[]),g=Object(s.useCallback)((function(e,t){Object(ae.b)(e,t,u,m.c)}),[u]),y=Object(s.useCallback)((function(e,t){switch(t){case"video":g("video-upload-error");break;case"image":g("image-upload-error",e)}}),[g]);return Object(i.c)(i.a,{children:[Object(i.b)(J,{mb:"16px",headerLabel:"问题描述（可选）：",headerRight:Object(i.c)(i.a,{children:[Object(i.b)(oe.a,{label:"".concat(f?"收起":"展开","工具栏"),isActive:f,icon:ie.a,onClick:function(){return v(!f)}}),Object(i.b)(oe.a,{label:"插入图片",icon:ce.a,onClick:O}),Object(i.b)(oe.a,{label:"上传视频",icon:re.a,onClick:j})]}),marginTop:"24px",children:Object(i.b)(se.a,{ref:function(e){b.current=e,t&&t(e)},allowDragAndDrop:!0,allowLinkCard:!0,minRows:2,allowToolbar:f,allowVideoTitleChange:!0,allowHeaderThree:!1,placeholder:"问题背景、条件等详细信息",defaultValue:n,onError:g,onUploadError:y,onChange:c,onBeforeVideoUpload:function(){return!o},editingContentType:"question"})}),r&&Object(i.b)(J,{headerRight:Object(i.b)(ee,{level:r.level,children:r.text})})]})};le.propTypes={onEditableRef:u.a.func,defaultValue:u.a.string,detailError:g,onChange:u.a.func.isRequired,isAnonymous:u.a.bool};var ue=le,de=n(479),be=n(486),he=function(e){var t=e.topic;return Object(i.b)(de.a,{css:{marginRight:"8px"},children:Object(i.b)("a",{target:"_blank",rel:"noopener noreferrer",href:"//www.zhihu.com/topic/".concat(t.id||t.urlToken),children:t.name})})};function pe(e){var t=e.topics,n=void 0===t?[]:t,c=e.onChange,r=e.permitEditTopics,o=Object(s.useState)(null),l=Object(a.a)(o,2),u=l[0],d=l[1],b=Object(s.useState)(n),h=Object(a.a)(b,2),p=h[0],f=h[1],m=Object(s.useState)(!1),v=Object(a.a)(m,2),O=v[0],j=v[1],g=Object(s.useCallback)((function(e){var t;f(e);var n=null===(t=q({topics:e},"topics"))||void 0===t?void 0:t.topics;d(n),c&&c(e,n)}),[c]);return Object(i.c)(J,{mb:"24px",children:[u&&Object(i.b)(ee,{as:"div",level:u.level,children:u.text}),r?Object(i.b)(be.a,{actived:O,value:p,onChange:g,onToggleActived:function(){return j(!O)}}):p.map((function(e){return Object(i.b)(he,{topic:e},e.name)}))]})}pe.propTypes={topics:u.a.arrayOf(u.a.object),onChange:u.a.func,permitEditTopics:u.a.bool};var fe=pe,me=n(48),ve=n(154),Oe=function(e){var t=e.onInputRef,n=e.questionType,c=e.reason,r=e.otherReason,o=e.onReasonChange,a=e.onInputChange,s=e.reasonError,l=Object(Q.f)(),u=Boolean(!c&&s),d=Boolean("other"===c&&!r&&s);return Object(i.b)("div",{className:"EditQuestionReasonInput",children:Object(i.b)(J,{mb:"0",before:Object(i.c)(J.Header,{mb:"0",children:[Object(i.b)(ve.b,{css:{marginRight:"8px"},needsReposition:!0,plain:!0,text:c?null:"请选择一个修改理由",value:c,onChange:o,children:O.map((function(e){return Object(i.b)(ve.a,{value:e.value,text:e.text},e.value)}))}),u&&Object(i.b)(ee,{level:s.level,children:s.text}),!["org","commercial"].includes(n)&&Object(i.b)(J.HeaderRight,{children:Object(i.b)(me.Link,{className:"EditQuestion-whyEdit",target:"blank",to:"/question/19550238/answer/95068125",children:"为什么问题可以被公共编辑？"})})]}),children:"other"===c&&Object(i.b)(L.Box,{css:d&&{"& input::placeholder":{color:l.colors.GRD03A}},children:Object(i.b)(M.a,{onRef:t,spread:!0,large:!0,value:r,placeholder:"请输入修改理由（必填）",onChange:a})})})})};Oe.propTypes={onInputRef:u.a.func,questionType:u.a.string.isRequired,reason:u.a.string,otherReason:u.a.string,reasonError:g,onReasonChange:u.a.func,onInputChange:u.a.func};var je=Oe;function ge(e){if(!e)return"提交修改时发生未知错误";if("string"==typeof e)return e;var t=e.status,n=e.message,i=e.name;return n?Object(ae.c)(n)?"提交修改时发生网络请求错误":n.startsWith("request http")?"提交修改时发生错误".concat(t?"："+t:""):"提交修改时发生错误：".concat(n):"提交修改时发生错误：".concat(i||"Unknown")}function ye(e){var t=e.onSuccess,n=e.onFailure,i=Object(d.useSelector)((function(e){var t=e.notification;return t[m.c]||t.updateQuestion}));return Object(s.useEffect)((function(){if(i){var e=i.id,c=i.code,r=i.text;e?t(e):n(function(e,t){switch(e){case 103003:return["title",{level:"error",text:"已经存在的问题"}];case 103001:return["detail",{level:"error",text:"过长的补充说明"}];default:return["overall",{text:ge(t)}]}}(c,r))}}),[i]),null}ye.propTypes={onSuccess:u.a.func.isRequired,onFailure:u.a.func.isRequired};var we=function(e){return["title","reason","topics"].find((function(t){var n;return"error"===(null===(n=e[t])||void 0===n?void 0:n.level)}))};function Ce(e){var t=e.onClose,n=e.show,c=e.id,r=e.title,l=e.detail,u=e.topics,O=e.questionType,g=e.isAnonymous,y=e.brand,w=e.permitEditTopics,B=Object(d.useSelector)(p.b),Q=Object(d.useDispatch)(),I=Object(s.useCallback)((function(){return Q(m.h.apply(void 0,arguments))}),[Q]),E=Object(s.useRef)({titleInput:null,editable:null,reasonInput:null}),L=function(e){var t;if("title"===e)null===(t=E.current.titleInput)||void 0===t||t.focus();else if("reason"===e){var n;null===(n=E.current.reasonInput)||void 0===n||n.focus()}},M=Object(s.useReducer)(N,Object.assign(Object.assign({},S),{},{title:r,detail:l,topics:u})),D=Object(a.a)(M,2),F=D[0],H=D[1],_=F.step,U=F.title,V=F.reason,G=F.otherReason,W=F.onceChanged,K=F.uploadModalShown,J=F.videoQuestionConfirmShown,Z=F.videoQuestionConfirmAllowContinue,Y=F.videoQuestionConfirmTitle,$=F.videoQuestionConfirmText,ee=F.errors,te=ee.title,ie=ee.detail,ce=ee.reason,re=ee.overall;T(n,(function(e){Object(a.a)(e,1)[0]&&H({type:k,payload:{title:r,detail:{toHTML:function(){return l}},topics:u,onceChanged:!1}})}));var oe=Object(s.useCallback)((function(){H({type:R}),I("问题修改成功！"),t()}),[I,t]),ae=Object(s.useCallback)((function(e){var t=Object(a.a)(e,2),n=t[0],i=t[1];H({type:x,payload:Object(o.a)({},n,i)}),L(n)}),[]),se=Object(s.useMemo)((function(){return we(ee)}),[ee]),le=Object(s.useCallback)((function(e){var t=e.target.value;H({type:C,payload:["title",t]})}),[]),de=Object(s.useCallback)((function(){H({type:x,payload:q({title:U},"title")})}),[U]),be=Object(s.useCallback)((function(e){H({type:C,payload:["detail",e]})}),[]),he=Object(s.useCallback)((function(e,t){H({type:C,payload:["topics",e]}),H({type:x,payload:{topics:t}})}),[]),pe=Object(s.useCallback)((function(e){H({type:k,payload:{reason:e,step:1}}),"other"===e&&setTimeout((function(){return L("reason")}))}),[]),me=Object(s.useCallback)((function(e){var t=e.target.value;H({type:C,payload:["otherReason",t]}),"reason"===se&&t&&H({type:x,payload:{reason:null}})}),[se]),ve=Object(s.useCallback)((function(){var e;null!==(e=E.current.editable)&&void 0!==e&&e.hasVideo("upload")?H({type:A,payload:["uploadModalShown",!0]}):t()}),[t]),Oe=function(){var e=F.title,t=F.detail,n=F.topics,i=F.reason,r=F.otherReason,o={question:{title:e},meta:{reason:"other"===i?r:i}},a=t.toHTML();a!==l&&(o.question.detail=a),n!==u&&(o.question.topicUrlTokens=n.map((function(e){return e.urlToken||e.id}))),Object.keys(o.question).length>0&&Q(Object(f.ob)(c,o))},ge=function(){H({type:A,payload:["videoQuestionConfirmShown",!1]})},Ce=function(){H({type:A,payload:["uploadModalShown",!1]})},ke=Object(s.useCallback)((function(){Ce(),t()}),[t]),xe=Boolean(!W||se),Ae=0===_,Re=Ae?j[0]:{css:{width:"595px","& .Modal-content":{paddingBottom:re?0:"32px"}}};return Object(i.c)(i.a,{children:[Object(i.b)(ye,{onSuccess:oe,onFailure:ae}),Object(i.b)(h.b,Object.assign(Object.assign({footer:re&&Object(i.b)(X,{level:"error",children:re.text}),onClose:ve,hotKeyClosable:!1,maskClosable:!1},Re),{},{children:n&&(Ae?Object(i.b)(P,{onSelect:pe}):Object(i.c)("div",{className:"QuestionAsk",children:[Object(i.b)(z,{title:Y,text:$,shown:J,allowConfirm:Z,onSubmit:function(){ge(),Oe()},onClose:ge,buttonText:{ok:"发布",cancel:"继续编辑"}}),Object(i.b)(z,{text:"关闭弹窗将丢失上传中的视频内容",shown:K,onSubmit:ke,onClose:Ce}),Object(i.c)("form",{onSubmit:function(e){return e.preventDefault()},noValidate:!0,children:[Object(i.b)(ne,{onInputRef:function(e){return E.current.titleInput=e},title:U,onChange:le,onBlur:de,titleError:te,before:Object(i.b)(v.a,{isAnonymous:g,questionType:O,brand:y,css:{flexShrink:0,marginTop:"3px",marginRight:"16px"}})}),Object(i.b)(ue,{onEditableRef:function(e){return E.current.editable=e},defaultValue:l,onChange:be,detailError:ie,isAnonymous:g}),Object(i.b)(fe,{topics:u,onChange:he,permitEditTopics:w}),Object(i.b)(je,{onInputRef:function(e){return E.current.reasonInput=e},questionType:O,reason:V,otherReason:G,reasonError:ce,onReasonChange:pe,onInputChange:me}),Object(i.b)(h.a,{css:{marginTop:re?"16px":"25px"},children:Object(i.b)(b.c,{preset:"primary",color:"blue",disabled:xe,onClick:function(){var e=q(F);H({type:x,payload:e});var t=we(e);if(t)L(t);else{var n=E.current.editable;if(!function(e,t){return e.hasVideo("upload")?(t("请等待视频上传完成后发布","red",m.c),!0):!!e.hasImage("upload")&&(t("请等待图片上传完成后发布","red",m.c),!0)}(n,I)){var i=function(e,t){return e.hasVideo()&&!t.isOrg?{videoQuestionConfirmShown:!0,videoQuestionConfirmAllowContinue:!0,videoQuestionConfirmText:"包含视频的编辑将在审核完成后生效，是否继续？"}:e.hasImage("error")||e.hasVideo("error")&&!e.hasVideo("error-review")?{videoQuestionConfirmShown:!0,videoQuestionConfirmAllowContinue:!1,videoQuestionConfirmTitle:"上传失败",videoQuestionConfirmText:"草稿中含有上传失败的内容，请更改后重新提交"}:e.hasVideo("error-review")||e.hasVideo("censor")?{videoQuestionConfirmShown:!0,videoQuestionConfirmAllowContinue:!1,videoQuestionConfirmTitle:"视频未通过审核",videoQuestionConfirmText:"视频中包含未通过审核的信息，请更改后重新提交"}:null}(n,B);i?H({type:k,payload:i}):Oe()}}},children:"提交修改"})})]})]}))}))]})}Ce.propTypes={id:u.a.number,title:u.a.string,detail:u.a.string,topics:u.a.arrayOf(u.a.object),show:u.a.bool,onClose:u.a.func,isAnonymous:u.a.bool,brand:u.a.object,permitEditTopics:u.a.bool},Ce.defaultProps={onClose:function(){}};var ke=Ce;function xe(e){return Object(i.b)(c.a,{children:Object(i.b)(r.a,{children:Object(i.b)(ke,Object.assign({},e))})})}},1485:function(e,t,n){"use strict";var i=n(14),c=n(15),r=n(17),o=n(18),a=n(7),s=n(1),l=n(0),u=n(21),d=n(896),b=n(225),h=n(310),p=n(130);function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(a.a)(e);if(t){var c=Object(a.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(o.a)(this,n)}}var m=function(e){Object(r.a)(n,e);var t=f(n);function n(){var e;Object(i.a)(this,n);for(var c=arguments.length,r=new Array(c),o=0;o<c;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={value:"",items:[]},e.handleChange=function(t){var n=e.props.dispatch;e.setState({value:t});var i=t.match(/^https:\/\/www.zhihu.com\/question\/(\d+)/);i?n(Object(p.Y)(i[1])).then((function(t){var n=t.payload;e.setState({items:[{name:n.title,urlToken:n.id}]})})):Object(h.b)(t).then((function(t){e.setState({items:t})}))},e.handleSelect=function(t,n){var i=e.props,c=i.dispatch,r=i.question.id,o=i.onSubmitted,a=n.urlToken,s=c(Object(p.g)(r,a));o&&o({id:a},s)},e}return Object(c.a)(n,[{key:"render",value:function(){var e=this.state,t=e.value,n=e.items;return Object(s.b)("div",{className:"QuestionRedirectionCreator",children:Object(s.b)("div",{className:"QuestionRedirectionCreator-content",children:Object(s.b)(b.b,{value:t,items:n,inputProps:{spread:!0,large:!0,after:Object(s.b)(d.a,{fill:"grey",size:20})},menuProps:{targetClassName:"QuestionRedirectionCreator-menu"},onChange:this.handleChange,onSelect:this.handleSelect})})})}}]),n}(l.Component);t.a=Object(u.connect)()(m)},1661:function(e,t,n){"use strict";(function(e){var i=n(14),c=n(15),r=n(17),o=n(18),a=n(7),s=n(1),l=n(0),u=n(21),d=n(2669),b=n(130),h=n(201);function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(a.a)(e);if(t){var c=Object(a.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(o.a)(this,n)}}var f=function(t){Object(r.a)(o,t);var n=p(o);function o(){var t;Object(i.a)(this,o);for(var c=arguments.length,r=new Array(c),a=0;a<c;a++)r[a]=arguments[a];return(t=n.call.apply(n,[this].concat(r))).getTrackUrls=function(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=t.props,r=c.pageType,o=c.advancedStyle,a=o.viewTracks,s=o.clickTracks,l="view"===n?a:s,u=Object.assign({},{eru:encodeURIComponent(e.location.href),ct:1,pt:"question"===r?1:2,rt:1},i),d=Object.keys(u).map((function(e){return"&".concat(e,"=").concat(u[e])})).join("");return l.map((function(e){return"".concat(e).concat(d)}))},t.handleViewTrack=function(e){t.getTrackUrls("view",e).forEach(h.c)},t.handleClickTrack=function(e){t.getTrackUrls("click",e).forEach(h.c)},t}return Object(c.a)(o,[{key:"UNSAFE_componentWillMount",value:function(){var e=this.props,t=e.questionId;(0,e.loadBrandQuestionAdvancedStyle)(t)}},{key:"componentDidUpdate",value:function(e){var t=e.advancedStyle,n=(t=void 0===t?{}:t).cardType,i=this.props,c=i.advancedStyle,r=(c=void 0===c?{}:c).cardType,o=i.onLoad;!n&&r&&"function"==typeof o&&o()}},{key:"render",value:function(){var e=this.props,t=e.brand,n=e.advancedStyle;return n&&n.id?Object(s.b)(d.a,{brand:t,advancedStyle:n,handleViewTrack:this.handleViewTrack,handleClickTrack:this.handleClickTrack,isMobileView:!1}):null}}]),o}(l.Component);t.a=Object(u.connect)((function(e){var t=e.question;return{brand:t.brand,advancedStyle:t.advancedStyle}}),{loadBrandQuestionAdvancedStyle:b.J})(f)}).call(this,n(117))},2139:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(1087),c=n(62);function r(e){return Object(c.a)(1,arguments),Object(i.a)(e,Date.now())}},2140:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(1087),c=n(501),r=n(62);function o(e){return Object(r.a)(1,arguments),Object(i.a)(e,Object(c.a)(Date.now(),1))}},2152:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),c=n.n(i),r=n(12),o=Object.assign;function a(e){return c.a.createElement(r.a,o(o({width:"24",height:"24",viewBox:"0 0 24 24","data-new-api":"TextPencil24","data-old-api":"Preview"},e),{className:"Zi Zi--Preview"+(e.className?" ".concat(e.className):"")}),c.a.createElement("path",{d:"M4.75 3.5a.75.75 0 000 1.5h14.5a.75.75 0 000-1.5H4.75zm0 7a.75.75 0 000 1.5h6.5a.75.75 0 000-1.5h-6.5zM4 18.25a.75.75 0 01.75-.75h4.1a.75.75 0 010 1.5h-4.1a.75.75 0 01-.75-.75zm15.22-9.463a.751.751 0 00-.412-.978.749.749 0 00-.98.404L15.2 14.606a.751.751 0 00.412.979.749.749 0 00.98-.405l2.629-6.393zm-3.808 9.388a.751.751 0 00-.426-.972.749.749 0 00-.973.42l-.237.6c-.151.385.04.82.426.973a.749.749 0 00.974-.42l.236-.6z",fillRule:"evenodd",clipRule:"evenodd"}))}},2252:function(e,t,n){e.exports=n.p+"assets/placeholder.765f50e5.svg"},2253:function(e,t,n){e.exports=n.p+"assets/liukanshan_desert.547bd049.svg"},2254:function(e,t,n){e.exports=n.p+"assets/empty.2df52de0.png"},2669:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n(1),c=n(13),r=n.n(c),o=n(463),a=n(912),s=n(150),l=n(981),u=n(30),d={question:"提问",answer:"回答",post:"文章",live:"Live",ebook:"电子书"},b=function(e){var t=e.src,n=e.style;return Object(i.b)("div",{className:"AdvancedViewer-imgField",style:Object.assign(Object.assign({},n),t?{backgroundImage:"url(".concat(t,")"),backgroundSize:"cover",backgroundPosition:"center"}:{})})};function h(e){var t=e.isMobileView,n=e.advancedStyle,c=(n=void 0===n?{}:n).cardType,r=n.url,a=n.material,s=e.handleViewTrack,h=e.handleClickTrack;if(null==a||!a.length)return null;var p=function(e){return"function"==typeof h?{onClick:function(){h(e)}}:{}},f=function(e,t){return Object(i.c)("a",Object.assign(Object.assign({className:"AdvancedViewer-commodityItem",target:"_blank",rel:"noopener noreferrer",href:r},p({etu:r,pi:t+1})),{},{children:[Object(i.b)("img",{src:e.image,alt:""}),e.mainTitle&&Object(i.c)("div",{className:"AdvancedViewer-commodityIntro",children:[Object(i.b)("span",{className:"AdvancedViewer-mainTitle",children:e.mainTitle}),Object(i.b)("span",{className:"AdvancedViewer-subTitle",children:e.subTitle})]})]}),"AdvancedViewer-commodity-".concat(t))};if("image"===c)return Object(i.b)("a",Object.assign(Object.assign({className:"AdvancedViewer-material AdvancedViewer-image",target:"_blank",rel:"noopener noreferrer",href:r},p({etu:r})),{},{children:Object(i.b)(b,{src:a[0].image,style:t?{width:375,height:156.25}:{}})}));if("image_text"===c)return Object(i.c)("a",Object.assign(Object.assign({className:"AdvancedViewer-material AdvancedViewer-imageText",target:"_blank",rel:"noopener noreferrer",href:r},p({etu:r})),{},{children:[t&&Object(i.b)("div",{className:"AdvancedViewer-intro",children:a[0].intro}),Object(i.b)(b,{src:a[0].image}),!t&&Object(i.b)("div",{className:"AdvancedViewer-intro",children:a[0].intro})]}));if("commodity"===c)return a.length&&Object(i.b)("div",{className:"AdvancedViewer-material AdvancedViewer-commodity",children:t?a.map(f):Object(i.b)(l.a,{items:a,renderItem:f})});if("recommended"===c){var m=function(e,t){return Object(i.c)("a",Object.assign(Object.assign({className:"AdvancedViewer-recommendedItem",href:e.url,target:"_blank",rel:"noopener noreferrer"},p({etu:e.url,pi:t+1})),{},{children:[Object(i.c)("div",{className:"AdvancedViewer-summary",children:[Object(i.c)("div",{className:"AdvancedViewer-wrap",children:[Object(i.b)("div",{className:"AdvancedViewer-title",children:e.title}),e.intro&&Object(i.b)("div",{className:"AdvancedViewer-desc",children:e.intro.replace(/<[\s\S]*?>/g,"")})]}),Object(i.c)("span",{className:"AdvancedViewer-data",children:[d[e.type]," · ",e.statisticText]})]}),Object(i.b)(b,{src:e.image||u.o})]}))};return Object(i.b)("div",{className:"AdvancedViewer-material AdvancedViewer-recommended",children:a.map((function(e,t){return s?Object(i.b)(o.a,Object.assign(Object.assign({},(n={pi:t+1},"function"==typeof s?{onChange:function(e,t){e.isIntersecting&&(t.disconnect(),s(n))}}:{})),{},{children:m(e,t)}),t):m(e,t);var n}))})}return null}function p(e){var t,n=e.isMobileView,c=e.brand,l=c.name,u=c.logo,d=e.advancedStyle,b=(d=void 0===d?{}:d).brandRecommendText,p=d.buttonText,f=d.url,m=d.cardType,v=e.handleViewTrack,O=e.handleClickTrack,j=function(e){return"function"==typeof O?{onClick:function(){O(e)}}:{}},g=l&&l.charCodeAt(l.length-1),y=g>=0&&g<=128?"".concat(l," "):l,w=n&&"recommended"!==m,C=b||"".concat(y,"的品牌推荐"),k=Object(i.c)(a.d,{className:r()("AdvancedViewer",{"is-mobile":n}),children:[!w&&Object(i.b)(a.b,{className:"AdvancedViewer-header",children:Object(i.b)("span",{className:"AdvancedViewer-headerText",children:C})}),Object(i.b)("div",{className:"AdvancedViewer-content",children:Object(i.b)(h,Object.assign({},e))}),!n&&m&&"recommended"!==m&&Object(i.b)("div",{className:"AdvancedViewer-footer",children:Object(i.b)(s.a,Object.assign(Object.assign({className:"AdvancedViewer-button",target:"_blank",to:f},j({etu:f})),{},{children:p||"了解更多"}))}),w&&Object(i.c)("div",{className:"AdvancedViewer-footer",children:[Object(i.c)("div",{className:"AdvancedViewer-brand",children:[Object(i.b)("img",{className:"AdvancedViewer-logo",src:u,alt:""}),Object(i.b)("span",{className:"AdvancedViewer-brandName",children:C})]}),Object(i.b)(s.a,Object.assign(Object.assign({className:"AdvancedViewer-button",target:"_blank",to:f},j({etu:f})),{},{children:p||"查看详情"}))]})]});return v?Object(i.b)(o.a,Object.assign(Object.assign({},"function"==typeof v?{onViewed:function(){v(t)}}:{}),{},{children:k})):k}},2805:function(e,t,n){"use strict";n.r(t);var i=n(1),c=n(48),r=n(47),o=n(37),a=n.n(o),s=n(65),l=n(14),u=n(15),d=n(17),b=n(18),h=n(7),p=n(0),f=n.n(p),m=n(3),v=n.n(m),O=n(21),j=n(72),g=n(20),y=n(116),w=n(58),C=n(155),k=n.n(C),x=n(431),A=n(152),R=n(218),S=n(97),N=n(2252),T=n.n(N);var q=function(){return Object(i.b)(S.a,{title:"该内容仅作者可见",subtitle:"",errorImage:T.a})},B=n(130),Q=n(436),I=Object(i.b)(y.a,{meta:[{name:"robots",content:"noindex"}]}),P=Object(g.compose)(Object(Q.a)(null))((function(e){var t=e.entity,n=t.type,c=t.id,r=t.isVisible,o=t.isCollapsed,a=t.suggestEdit,s=void 0===a?{}:a,l=t.adminClosedComment,u="";"question"===n?u=c:"answer"===n&&(u=t.question.id);var d=Object(O.useSelector)((function(e){return Object(B.eb)(e,{id:u})}));if(d){var b=d.status,h=d.adminClosedComment,p=d.isMuted,f=d.visibleOnlyToAuthor,m=d.reviewInfo,v=void 0===m?{}:m;if(null!=b&&b.isClose||null!=b&&b.isSuggest||null!=b&&b.isEvaluate||h||p||f||v.editIsReviewing)return I}return"question"===n&&d.redirection?Object(i.b)("link",{rel:"canonical",href:"https://www.zhihu.com/question/".concat(d.redirection.to.id)}):"answer"===n&&(null!=s&&s.status||o||l||!r)||"article"===n&&(null!=s&&s.status||l||!r)?I:""})),E=n(1419),z=n(122),L=n(45),M=n(603),D=n(89),F=n(31),H=n(108),_=n(1738),U=function(e){var t=e.isQAPage,n=void 0!==t&&t,c=e.children,r=Object(O.useSelector)((function(e){return e.env.userAgent.GoogleBot}));return n&&r?Object(i.b)("div",{itemScope:!0,itemType:"https://schema.org/QAPage",children:c}):Object(i.b)(i.a,{children:c})},V=n(193),G=n(2253),W=n.n(G);function K(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var J=function(e){Object(d.a)(n,e);var t=K(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={time:e.props.seconds},e.handleClearInterval=function(){e.interval&&clearInterval(e.interval)},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval((function(){e.setState({time:e.state.time-1},(function(){if(0===e.state.time){e.handleClearInterval();var t=e.props.id;location.href="/question/".concat(t)}}))}),1e3)}},{key:"componentWillUnmount",value:function(){this.handleClearInterval()}},{key:"render",value:function(){var e=this.props,t=e.title,n=e.destination,c=this.state.time;return Object(i.b)(V.b,{title:t,subtitle:"".concat(c," 秒后自动跳转至").concat(n),errorImage:W.a})}}]),n}(p.Component);J.defaultProps={seconds:5,destination:"回答所在的问题页",title:"该回答已被删除"};var Z=n(173),Y=n(220),$=n.n(Y),X=n(33),ee=n(1342),te=n(290),ne=n(264),ie=n(26),ce=n(13),re=n.n(ce),oe=n(1131),ae=n(975),se=n(192),le=n(1223),ue=n(1741),de=n(2),be=n(219),he=n(434),pe="SpecialQuestionAuthor";function fe(e){var t=e.author,n=e.className,r=e.isMobile,o=t.avatarUrl,a=t.name,s=t.badge,l=t.badgeV2;return Object(i.b)("div",{className:re()("".concat(pe,"-Wrapper"),n),children:Object(i.c)(c.Link,{className:re()("".concat(pe),Object(de.a)({},"ROOT_CLASS--mobile",r)),to:"/".concat(t.isOrg?"org":"people","/").concat(t.urlToken||t.id),children:[Object(i.b)(be.a,{size:r?22:28,url:o,alt:a,round:!0}),Object(i.b)("span",{className:"".concat(pe,"-Author"),children:t.name}),Object(i.b)(he.c,{className:"".concat(pe,"-Badge"),badge:l||s,size:r?16:18}),Object(i.b)("span",{className:"".concat(pe,"-Suffix"),children:"的提问"})]})})}fe.propTypes={author:v.a.object.isRequired,isMobile:v.a.bool};var me=n(1189),ve=n(516),Oe=(n(1570),n(311)),je=n(915),ge=n(46),ye=n.n(ge),we=n(942);function Ce(e){var t=e.question,n=e.isAuthorCurrentUser,c=e.hasExtraContent,o=t.author,a=Object(p.useState)(!1),s=Object(r.a)(a,2),l=(s[0],s[1],Object(p.useRef)(),Object(p.useRef)());return Object(p.useEffect)((function(){;""}),[n]),Object(p.useEffect)((function(){Object(je.onViewedOnce)(l.current,(function(){ie.a.trackCardShow(l.current,{id:7064})}))}),[]),Object(i.c)("div",{className:re()("QuestionAuthor",{"QuestionAuthor--hasExtraContent":c}),ref:l,children:[Object(i.b)(we.a,{preset:"plain",author:o,zaId:7063,zaExtra:{link:{url:"//www.zhihu.com/people/".concat(o.urlToken)}},noHeadline:!0}),""]})}var ke=n(32),xe=n(148),Ae=n(149),Re=n(922),Se=n(914),Ne=n(51),Te=Object.assign;var qe,Be=function(e){return f.a.createElement(Ne.a,Te({width:"99",height:"99",viewBox:"0 0 99 99"},e),f.a.createElement("path",{fill:"currentColor",d:"M118.269 98.6a4.063 4.063 0 01-2.54-.893L69.501 60.79l-44.83 36.055a4.06 4.06 0 01-4.972.1 4.2 4.2 0 01-1.419-4.834L29.43 61.626c.801-2.153 3.175-3.234 5.29-2.423 2.12.812 3.191 3.216 2.39 5.366l-5.897 16.387 35.73-28.735a4.053 4.053 0 015.09-.008l38.454 30.708-13.8-45.548a4.2 4.2 0 011.421-4.524L129.74 8.185H97.734L51.044 41.93A4.068 4.068 0 0145.31 41c-1.33-1.863-.918-4.466.917-5.815L93.995.648a4.067 4.067 0 012.408-.79h45.412a4.11 4.11 0 013.887 2.823 4.2 4.2 0 01-1.385 4.64L105.371 37.69l16.82 55.522a4.193 4.193 0 01-1.6 4.658 4.066 4.066 0 01-2.322.73M16.219 18.143a3.63 3.63 0 01-2.935-1.468c-1.16-1.577-.784-3.772.834-4.9L30.328.514c1.62-1.13 3.869-.765 5.028.812 1.16 1.577.785 3.772-.834 4.9L18.314 17.488a3.669 3.669 0 01-2.095.655M32.28 29.114a3.46 3.46 0 01-2.005-6.277L84.62-15.959a3.45 3.45 0 014.815.814 3.46 3.46 0 01-.812 4.822L34.28 28.474a3.435 3.435 0 01-2 .64M3.407 7.171c-1.053 0-2.092-.53-2.757-1.53-1.104-1.655-.764-3.97.757-5.17l2.202-1.737c1.52-1.2 3.648-.831 4.751.823 1.104 1.656.764 3.971-.757 5.171L5.4 6.466a3.204 3.204 0 01-1.994.705",fillRule:"evenodd"}))},Qe=["questionId","isInAnswerPage"],Ie=function(e){var t,n=e.items,c=null==n||null===(t=n[0])||void 0===t?void 0:t.image;return Object(i.b)(w.Box,{css:function(e){return{flex:"0 0 44px",borderRadius:"4px",position:"relative","::after":{content:'""',position:"absolute",top:4,bottom:4,borderRadius:"inherit",right:"-4px",background:"".concat(e.colorMod(e.colors.GBK09A).alpha(.8)),width:"10px",zIndex:0}}},children:Object(i.b)(Re.a,{bg:"GBK09C",ratio:1,css:{zIndex:1},children:c&&Object(i.b)(w.Image,{size:"100%",src:Object(Ae.imgUrl)(c,"100w"),css:{borderRadius:"inherit",objectFit:"cover"}})})})},Pe=function(e){return[{width:"33px",right:"10px",zIndex:3},{width:"29px",right:"5px",zIndex:2},{width:"24px",right:0,zIndex:1}][e]},Ee=function(e){var t=e.items,n=null==t?void 0:t.map((function(e){return e.image}));return Object(i.b)(w.Box,{css:{flex:"0 0 44px",borderRadius:"4px"},children:Object(i.b)(Re.a,{ratio:1,children:(null==n?void 0:n.length)>0&&n.map((function(e,t){return Object(i.b)(w.Box,{css:Object.assign({borderRadius:"inherit",position:"absolute",bottom:0},Pe(t)),children:Object(i.b)(Re.a,{bg:"GBK09C",ratio:3/4,css:{zIndex:1},children:e&&Object(i.b)(w.Image,{size:"100%",src:Object(Ae.imgUrl)(e,"100w"),css:{borderRadius:"inherit",objectFit:"cover",boxShadow:"0.5px 0 2px 0 rgba(0, 0, 0, 0.1)"}})})},t)}))})})},ze=function(e){var t=e.questionId,n=e.isInAnswerPage,c=Object(ke.default)(e,Qe),o=Object(O.useSelector)((function(e){return Object(B.fb)(e,t)})),a=Object(O.useDispatch)(),s=Object(me.b)(),l=Object(r.a)(s,3),u=l[0],d=l[1],b=l[2];if(Object(p.useEffect)((function(){o||a(Object(B.Z)(t)).catch(b)}),[o,t,b,a]),Object(p.useEffect)((function(){o&&("not found"!==o.message?d():b())}),[o,b,d]),!o||"not found"===o.message||!u)return null;var h=o.name,f=o.num,m=o.upvoteNum,v=o.rankFieldType,g=o.items,y=o.urlToken,C=2===v,k=C?Ee:Ie;return Object(i.b)(x.a,{module:"Content",view:{id:8766,name:n?"answer":"question"},content:{token:y,parent_token:String(t)},trackCardShow:!0,children:Object(i.b)(j.b,{content:{type:"Topic",token:String(y)},children:Object(i.b)(j.e,{zaText:!0,shouldTrackClick:!0,as:"div","data-za-extra":JSON.stringify({button:{text:h}}),css:{position:"relative",zIndex:0},zaType:"Card",zaAction:"OpenUrl",zaBlock:"blueStar_questionPage_detailCard",zaEventType:"Click",extra:{link:{url:"https://www.zhihu.com/blue-star/ranking/".concat(y,"?origin_from=").concat(n?"answer":"question")}},children:Object(i.c)(w.Flex,Object.assign(Object.assign({as:Se.a,my:"14px",py:"8px",px:"12px",alignItems:"center",css:function(e){return{backgroundImage:"linear-gradient(to left, ".concat(e.colorMod(e.colors.GBL01A).alpha(.1),", ").concat(e.colorMod(e.colors.GBL01A).alpha(.04),")"),backgroundColor:e.colors.GBK99C,borderRadius:"5px",position:"relative",overflow:"hidden"}},"data-za-detail-view-id":"8767","data-za-detail-view-name":n?"answer":"question","data-za-extra":JSON.stringify({button:{text:h}}),href:"https://www.zhihu.com/blue-star/ranking/".concat(y,"?origin_from=").concat(n?"answer":"question")},c),{},{children:[Object(i.b)(Be,{css:function(e){return{position:"absolute",width:"40.5px",height:"49.5px",top:-5,right:-1,color:e.colors.GBK99A}}}),Object(i.b)(k,{items:g}),Object(i.c)(w.Flex,{ml:"14px",alignItems:"center",children:[Object(i.b)(w.Text,{color:"GBK02A",fontWeight:"bold",css:{fontSize:"17px",lineHeight:"18px"},children:"小蓝星 · ".concat(h)}),Object(i.b)(w.Text,{color:"GBK05A",css:{fontSize:"14px",lineHeight:"16px",marginLeft:"10px"},children:C?$()(qe||(qe=Object(Z.a)(["收录",""," · ","知友推荐"])),Object(xe.cnNiceNumber)(f),C?"部影视":"个商品",Object(xe.cnNiceNumber)(m)):"来自知友的真实反馈"})]})]}))})})})},Le=n(479),Me=n(999);function De(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var Fe=function(e){Object(d.a)(n,e);var t=De(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props.item;return Object(i.b)(Le.a,{className:"QuestionTopic",children:Object(i.b)(Me.a,{noHoverCard:!1,topic:e})})}}]),n}(p.Component),He=Object(x.b)((function(e){return{module:"TopicItem",content:{type:"Topic",token:e.item.id},trackCardShow:!0}}))(Fe),_e=n(1465),Ue=n(1564),Ve=n(976),Ge=n(1069),We=n(1041),Ke=n(1124),Je=["text"],Ze=function(e){var t=e.text,n=Object(ke.default)(e,Je);return Object(i.b)(X.c,Object.assign(Object.assign({preset:"plain"},n),{},{icon:Ke.a,label:t||"修改"}))};function Ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var $e=function(e){Object(d.a)(n,e);var t=Ye(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props.tips;return Object(i.b)("div",{className:"QuestionReviewInfo",children:Object(i.b)("p",{children:e})})}}]),n}(p.PureComponent);$e.propsTypes={tips:v.a.string};function Xe(e){var t,n,c=e.html,o=e.excerpt,a=e.thumbnailInfo,s=e.collapsed,l=e.onExpand,u=e.editable,d=e.onEdit,b=e.isVisible,h=e.isAuthor,f=e.hideWatermark,m=o.length<c.length,v=(m||o.length>=75)&&s,O=!h&&!b,j=Object(p.useMemo)((function(){var e;return null==a||null===(e=a.thumbnails)||void 0===e?void 0:e.find((function(e){return"video"===e.type}))}),[a]),g=null==a||null===(t=a.thumbnails)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.url,y=Object(p.useState)(null),w=Object(r.a)(y,2),C=w[0],k=w[1];return Object(i.b)("div",{css:{minHeight:"10px"},children:Object(i.c)("div",{className:re()("QuestionRichText",{"QuestionRichText--expandable":m,"QuestionRichText--collapsed":s,"QuestionRichText--video":j&&s}),onClick:function(e){v&&"function"==typeof l&&l(e);var t=e.target;"IMG"===t.tagName&&t.classList.contains("zh-lightbox-thumb")&&k(t)},children:[j&&s&&Object(i.b)("div",{className:"QuestionRichText--wrapImgae",children:Object(i.b)("img",{src:g,alt:"video",className:"QuestionRichText--image"})}),!O&&Object(i.c)("div",{children:[v?Object(i.b)("span",{itemProp:"text",children:Object(We.b)(o,75)}):Object(i.b)(Ge.a,{itemProp:"text",tag:"span",html:c,hideWatermark:f}),v&&Object(i.c)(X.c,{preset:"plain",className:"QuestionRichText-more",children:["显示全部 ",Object(i.b)(Ue.a,{center:!0})]})]}),u&&!v&&Object(i.b)(Ze,{onClick:d}),C&&Object(i.b)(Ve.a,{img:C,onClose:function(){return k(null)}})]})})}function et(e){var t=e.reviewInfo,n=e.thumbnailInfo,c=e.html,r=e.excerpt,o=(t||{}).tips,a=Object(p.useMemo)((function(){var e;return null==n||null===(e=n.thumbnails)||void 0===e?void 0:e.find((function(e){return"video"===e.type}))}),[n]),s=Boolean(c&&r);return Object(i.c)("div",{children:[o&&a&&Object(i.b)($e,{tips:o}),s?Object(i.b)(Xe,Object.assign({},e)):null]})}var tt=n(289),nt=n(81),it=n(172),ct=n(2007),rt=n(2152),ot=n(538),at=n(150),st=n(64),lt=n(1139);function ut(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var dt=function(e){Object(d.a)(n,e);var t=ut(n);function n(){var e;Object(l.a)(this,n);for(var c=arguments.length,r=new Array(c),o=0;o<c;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).getRenderProps=function(){var t=e.props,n=t.draft,c=t.question,r=c.id,o=c.relationship,a=(o=void 0===o?{}:o).myAnswer,s=t.params.answerId,l=t.isMobile;return a?a.isDeleted?{icon:Object(i.b)(ct.a,{size:17,className:"QuestionButton-icon"}),text:"撤销删除",props:{onClick:e.handleRestoreAnswer}}:!l&&s&&s===String(a.answerId)?{icon:Object(i.b)(rt.a,{size:17,className:"QuestionButton-icon"}),text:"编辑回答",props:{onClick:e.handleEditAnswer}}:{icon:Object(i.b)(rt.a,{size:17,className:"QuestionButton-icon"}),text:"查看我的回答",props:{to:"/question/".concat(r,"/answer/").concat(a.answerId),onClick:e.handleFocusAnswer},Wrapper:at.a}:{icon:Object(i.b)(Ke.a,{size:16,center:!0,className:"QuestionButton-icon"}),text:n?"编辑回答":"写回答",props:{onClick:e.handleAddAnswer}}},e.handleFocusAnswer=function(){var t=document.querySelector(".AnswerCard");t&&(t.classList.add("is-focus"),e.timeout&&clearTimeout(e.timeout),e.timeout=setTimeout((function(){return t.classList.remove("is-focus")}),300))},e.handleRestoreAnswer=function(){var t=e.props,n=t.question,i=n.relationship.myAnswer,c=n.id,r=t.restoreAnswer,o=t.showNotification;i.isDeleted&&r(c,i.answerId).then((function(){return o("已撤销删除回答")}))},e.handleAddAnswer=e.props.authRequired((function(t){var n=e.props,i=n.draft,c=n.question,r=c.id,o=c.reviewInfo,a=(o=void 0===o?{}:o).tips,s=n.zaId,l=n.cancelScheduledPublish;if(n.isMobile)window.location.href="/question/".concat(r,"/answers/editor");else if(Object(lt.c)())Object(lt.g)(r);else{var u=t.currentTarget,d=function(){a?e.props.showNotification(a,"red"):(s&&ie.a.trackEvent(null,{id:s}),ie.a.trackEvent(Object(nt.a)(e),{action:i&&i.editableContent?"Edit":"Answer",is_intent:!0,name:u.textContent}),e.context.startAddAnswer())};i&&i.schedule?it.a.confirm("如果继续编辑该回答，原定时发送设置将会失效，需重新设置定时发送时间，是否继续编辑？",{title:"编辑回答",text:{ok:"继续编辑",cancel:"我再想想"}}).then((function(){l(e.props.question.id).then(d)}),(function(){})):d()}})),e.handleEditAnswer=e.props.authRequired((function(){var e=document.querySelector(".AnswerItem-editButton");e&&e.click()})),e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){Object(ot.b)()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout)}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.className,c=e.size,r=e.preset,o=e.color,a=void 0===o?"blue":o,s=e.onClick,l=this.getRenderProps(),u=l.icon,d=l.text,b=l.props,h=l.Wrapper,f=void 0===h?X.c:h,m=Object(i.c)(p.Fragment,{children:[u,d]});return Object(i.b)(j.e,{zaType:"Button",zaText:d,as:"a",children:Object(i.b)(j.a,Object.assign(Object.assign(Object.assign({as:f,zaType:"Button",zaText:d,zaBlock:d},b),s&&{onClick:s}),{},{color:a,size:c,preset:r,className:n,children:t||m}))})}}]),n}(p.Component);dt.contextTypes={startAddAnswer:v.a.func};var bt=Object(g.compose)(c.withRouter,R.a,Object(O.connect)((function(e,t){return{draft:Object(B.n)(e,{id:t.params.id}),question:Object(B.eb)(e,{id:t.params.id}),isMobile:Object(st.d)(e),currentUser:Object(L.b)(e)}}),{restoreAnswer:D.A,cancelScheduledPublish:D.d,showNotification:F.h}))(dt),ht=n(926),pt=n(30),ft=n(378),mt=n(1099);function vt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var Ot={follow_question:mt.b.follow,write_answer:mt.b.write_answer},jt=function(e){Object(d.a)(n,e);var t=vt(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).createOpenInAppHandler=function(t){var n=e.props,i=n.question.id,c=n.isSpecialQuestionOrAnswer;return function(){c?location.href="zhihu://question/".concat(i,"?utm_app_name=zhihu_check&utm_content=").concat(t):Object(tt.e)(Object(ft.a)({type:"question",id:i},{launch_button:Ot[t]}))}},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props,t=e.question,n=e.question,c=n.relationship,r=n.relationship.isAuthor,o=n.isNormal,a=n.status,s=(a=void 0===a?{}:a).isLocked,l=n.questionType,u=n.isMuted,d=n.id,b=e.shouldOia,h=e.inTopBar,p="commercial"===l&&u;return Object(i.c)("div",{className:"QuestionButtonGroup",children:[r&&p?Object(i.b)(at.a,{preset:"primary",a:!0,to:"https://e.zhihu.com",color:"green",children:"推广问题"}):Object(i.b)(ht.a,Object.assign({id:d,zaId:h?3408:3309,type:"question",preset:"primary",isFollowing:(c&&{}.hasOwnProperty.call(c,"isFollowing")?c:t).isFollowing,disabled:p},b&&!pt.D&&{onClick:this.createOpenInAppHandler("follow_question")})),o&&!s&&Object(i.b)(bt,{color:"blue",zaId:h?3409:3311})]})}}]),n}(p.Component),gt=Object(g.compose)(c.withRouter,Object(O.connect)((function(e,t){var n;return{shouldOia:Object(st.h)(e),isSpecialQuestionOrAnswer:Object(st.j)(e,{type:"question",id:null===(n=t.question)||void 0===n?void 0:n.id})}})))(jt),yt=n(23),wt=n.n(yt),Ct=n(28),kt=n.n(Ct),xt=n(27),At=n.n(xt),Rt=n(29),St=n.n(Rt),Nt=n(19),Tt=n.n(Nt),qt=n(8);function Bt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Tt()(e);if(t){var c=Tt()(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return St()(this,n)}}var Qt=function(e){At()(n,e);var t=Bt(n);function n(){var e;wt()(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={count:Math.round(e.props.count)},e.next=function(){var t=e.props.onEnd,n=e.state.count-1;e.setState({count:n}),0===n&&(clearInterval(e.handle),t&&t())},e}return kt()(n,[{key:"componentDidMount",value:function(){this.state.count<=0||(this.handle=setInterval(this.next,this.props.interval))}},{key:"componentWillUnmount",value:function(){clearInterval(this.handle)}},{key:"render",value:function(){var e=this.state.count;return Object(qt.g)("span",null,e)}}]),n}(p.Component);Qt.propTypes={count:v.a.number.isRequired,interval:v.a.number,onEnd:v.a.func},Qt.defaultProps={interval:1e3};var It=Qt,Pt=n(430),Et=n(195),zt=n(88),Lt=n(437),Mt=n(921),Dt=n(1211),Ft=n(221);function Ht(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var _t=function(e){Object(d.a)(n,e);var t=Ht(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={redirectionLoading:!1,redirectionHidden:!1,invitersHidden:!1,invitationModalShown:!1},e.nextQuestion=function(t){var n=t.location.query,i=t.question.id,c=t.fromQuestion,r=t.loadItems,o=t.loadQuestion,a=t.currentUser;clearTimeout(e.timeout),e.setState({redirectionLoading:!1,redirectionHidden:!1,invitersHidden:!1}),a&&"guest"!==a.userType&&r(i,"inviters"),n.rf&&/^\d+$/.test(n.rf)&&!c&&(e.setState({redirectionLoading:!0}),o(Number(n.rf)).catch((function(){})).then((function(){e.setState({redirectionLoading:!1})})))},e.redirect=function(){var t=e.props,n=t.router,i=t.location.query,c=t.question,r=c.id,o=c.redirection;o&&o.to&&o.to.id&&"1"!==i.nr&&n.push("/question/".concat(o.to.id,"?rf=").concat(r))},e.handleRedirectionClose=function(){e.setState({redirectionHidden:!0,invitersHidden:!0}),e.timeout=setTimeout((function(){e.setState({invitersHidden:!1})}),1e3)},e.handleCloseInviters=function(){e.setState({invitersHidden:!0})},e.handleDeleteInviters=function(t){var n=e.props,i=n.question.id;(0,n.deleteInviters)(i),e.handleCloseInviters(),ie.a.trackEvent(t.target,{action:"Ignore"})},e.handleCancelAnonymous=function(){(0,e.props.onInvitationTipClose)(),e.context.toggleAnonymous(!1)},e.handleInvite=function(t){e.setState({invitersHidden:!0,invitationModalShown:!0}),ie.a.trackEvent(t.target,{action:"Invite",is_intent:!0})},e.handleInvitationModalHide=function(){e.setState({invitationModalShown:!1})},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.nextQuestion(this.props)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.question.id!==e.question.id&&this.nextQuestion(e)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout)}},{key:"revokeRedirection",value:function(e){var t=this.props,n=t.router,i=t.question.id;(0,t.revokeQuestionRedirection)(e).then((function(){n[e===i?"replace":"push"]("/question/".concat(e))})),this.handleRedirectionClose()}},{key:"renderCommercialMuteStatus",value:function(){var e=this.props.question,t=e.questionType,n=e.isMuted;return e.relationship.isAuthor&&"commercial"===t&&n?Object(i.b)("div",{className:"QuestionStatus-bar",children:Object(i.c)("div",{className:"QuestionStatus-bar-inner",children:[Object(i.c)("div",{className:"QuestionStatus-bar-commercialMuted",children:["该品牌提问尚未激活，无法在社区内流通。请"," ",Object(i.b)("a",{href:"https://e.zhihu.com",target:"_blank",rel:"noopener noreferrer",children:"前往广告平台"})," ","进行设置。"]}),Object(i.b)("p",{children:"未激活的品牌提问页可以添加回答，但相关动态不在社区内流通，包括不会出现在知乎首页、用户主页，也不会被搜索到。当与该品牌提问关联的广告开始投放时，提问被激活，并开始流通。"})]})}):null}},{key:"renderMute",value:function(){var e=this.props,t=e.isMuteSpecial,n=e.isMuteFreeze;return t?Object(i.b)("div",{className:"QuestionStatus-bar",children:Object(i.c)("div",{className:"QuestionStatus-bar-inner",children:[Object(i.b)("strong",{children:"问题已解散"}),Object(i.b)("p",{children:"当前问题下的回答暂时无法查看。"})]})}):n?Object(i.b)("div",{className:"QuestionStatus-bar",style:{display:"none"},children:Object(i.c)("div",{className:"QuestionStatus-bar-inner",children:[Object(i.b)("strong",{children:"问题已冻结"}),Object(i.b)("p",{children:"除浏览外不开放其他用户互动功能。"})]})}):null}},{key:"renderBar",value:function(){var e=this.props.question.status.unnormalDetails;return e&&Object(i.b)("div",{className:"QuestionStatus-bar",children:Object(i.c)("div",{className:"QuestionStatus-bar-inner",children:[Object(i.c)("strong",{children:[e.description,"。"]}),Object(i.c)("em",{children:["原因：",e.reason,"。"]}),1033!==e.reasonId&&Object(i.b)(Lt.a,{html:e.note})]})})}},{key:"renderNotification",value:function(){var e=this,t=this.props,n=t.location.query,c=t.question,r=c.id,o=c.redirection,a=c.relationship,s=(a=void 0===a?{}:a).myAnswer,l=t.inviters,u=t.fromQuestion,d=t.isAnswerPage,b=this.state,h=b.redirectionLoading,p=b.redirectionHidden,f=b.invitersHidden,m=null,v=null;if(!h)if(o&&o.to&&o.to.id&&!p){var O=o.to,j=O.id,g=O.title,y="1"!==n.nr&&!d;m=y?"redirect-countdown":"redirect",v=Object(i.c)("div",{className:"QuestionStatus-notification-inner",children:[Object(i.c)("div",{className:"QuestionStatus-notification-content",children:[y?Object(i.c)("span",{children:["此问题将在 ",Object(i.b)(It,{count:5,onEnd:this.redirect})," ","秒后跳转至"]}):Object(i.b)("span",{children:"此问题已重定向至"})," ",Object(i.b)(at.a,{preset:"plain",to:"/question/".concat(j,"?rf=").concat(r),children:g})]}),Object(i.c)("div",{className:"QuestionStatus-notification-actions",children:[Object(i.b)(X.c,{preset:"plain",className:"QuestionStatus-notification-primary",onClick:function(){return e.revokeRedirection(r)},children:"撤销重定向"}),Object(i.b)("div",{className:"QuestionStatus-notification-divider"}),Object(i.b)(X.c,{preset:"plain",onClick:this.handleRedirectionClose,children:"关闭"})]})]})}else if(u&&u.redirection&&u.redirection.to&&u.redirection.to.id&&u.redirection.to.id===r&&!p){var w=u.id,C=u.title;m="redirect-from",v=Object(i.c)("div",{className:"QuestionStatus-notification-inner",children:[Object(i.c)("div",{className:"QuestionStatus-notification-content",children:["从问题"," ",Object(i.b)(at.a,{preset:"plain",to:"/question/".concat(w,"?nr=1"),children:C})," ","跳转而来"]}),Object(i.c)("div",{className:"QuestionStatus-notification-actions",children:[Object(i.b)(X.c,{preset:"plain",className:"QuestionStatus-notification-primary",onClick:function(){return e.revokeRedirection(w)},children:"撤销重定向"}),Object(i.b)("div",{className:"QuestionStatus-notification-divider"}),Object(i.b)(X.c,{preset:"plain",onClick:this.handleRedirectionClose,children:"关闭"})]})]})}else l&&l.length&&!f&&!s&&(v=Object(i.b)(x.a,{module:"InvitationCard",trackCardShow:!0,children:Object(i.c)("div",{className:"QuestionStatus-notification-inner",children:[Object(i.c)("div",{className:"QuestionStatus-notification-content",children:[l.map((function(e,t){return Object(i.c)("span",{children:[0!==t&&"、",Object(i.b)(Mt.a,{user:e,noBadge:!0,noHoverCard:!0,"data-za-detail-view-element_name":"User"})]},e.urlToken)}))," ","邀请你回答此问题"]}),Object(i.c)("div",{className:"QuestionStatus-notification-actions",children:[Object(i.b)(X.c,{preset:"plain",className:"QuestionStatus-notification-primary",onClick:this.handleInvite,children:"邀请别人"}),Object(i.b)("div",{className:"QuestionStatus-notification-divider"}),Object(i.b)(X.c,{preset:"plain",onClick:this.handleDeleteInviters,children:"忽略邀请"})]}),Object(i.b)("div",{children:Object(i.b)(X.c,{className:"QuestionStatus-notification-closeButton",preset:"plain",onClick:this.handleCloseInviters,icon:Pt.a})})]})}));return Object(i.b)(Et.a,{className:"QuestionStatus-notification",notification:v?{key:m,text:v}:null})}},{key:"renderInvitationTip",value:function(){var e=this.props,t=e.invitationTipShown,n=e.onInvitationTipClose;return Object(i.b)(Et.a,{className:"QuestionStatus-notification",notification:t?{text:Object(i.c)("div",{className:"QuestionStatus-notification-inner",children:[Object(i.b)("div",{className:"QuestionStatus-notification-content",children:"在匿名状态下无法邀请他人回答"}),Object(i.c)("div",{className:"QuestionStatus-notification-actions",children:[Object(i.b)(X.c,{preset:"plain",className:"QuestionStatus-notification-primary",onClick:this.handleCancelAnonymous,children:"取消匿名"}),Object(i.b)("div",{className:"QuestionStatus-notification-divider"}),Object(i.b)(X.c,{preset:"plain",onClick:n,children:"关闭"})]})]})}:null})}},{key:"render",value:function(){var e=this.props.question,t=this.state.invitationModalShown;return Object(i.c)("div",{className:"QuestionStatus",children:[this.renderCommercialMuteStatus(),this.renderMute(),this.renderBar(),this.renderNotification(),this.renderInvitationTip(),Object(i.b)(zt.b,{size:"fullPage",onClose:this.handleInvitationModalHide,children:t&&Object(i.b)(Dt.a,{question:e})})]})}}]),n}(p.Component);_t.contextTypes={toggleAnonymous:v.a.func};var Ut=Object(g.compose)(Object(Q.a)({replacement:null}),c.withRouter,Ft.a,Object(O.connect)((function(e,t){var n=e.entities.questions,i=e.question.inviters,c=t.location.query,r=t.question.id,o={isMuteSpecial:Object(B.E)(t.question),isMuteFreeze:Object(B.D)(t.question),inviters:i[r]};if(c.rf&&/^\d+$/.test(c.rf)){var a=n[Number(c.rf)];a&&(o.fromQuestion=a)}return o}),{loadItems:B.R,loadQuestion:B.T,revokeQuestionRedirection:B.hb,deleteInviters:B.k}))(_t),Vt=n(96),Gt=n(1009),Wt=n(4),Kt=n(1326);function Jt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var Zt,Yt=function(e){Object(d.a)(n,e);var t=Jt(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).load=function(){var t=e.props,n=t.parent.id;(0,t.loadQuestionFollowers)(n)},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props,t=e.parent.followerCount,n=e.isFetching,c=e.isDrained,r=e.items,o=e.currentUser;return Object(i.b)(Kt.a,{currentUser:o,isFetching:n,isDrained:c,items:r,voteupCount:t,onLoad:this.load,text:"关注了"})}}]),n}(p.Component),$t=Object(O.connect)((function(e,t){var n=t.parent.id,i=e.entities.users,c=e.question,r=c.followers,o=c.concernedFollowers,a=r[n]||{isFetching:!1,isDrained:!1,order:"normal",ids:[]},s=a.isFetching,l=a.isDrained,u=a.order,d=a.ids,b=(o[n]||{ids:[]}).ids;return{isFetching:s,isDrained:l,order:u,items:[].concat(Object(Wt.a)(b),Object(Wt.a)(d.filter((function(e){return!b.includes(e)})))).map((function(e){return i[e]})),currentUser:Object(L.b)(e)}}),{loadQuestionFollowers:B.W})(Yt),Xt=n(323);function en(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var tn=function(e){Object(d.a)(n,e);var t=en(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={followersShown:!1},e.showFollowers=function(){e.setState({followersShown:!0})},e.closeFollowers=function(){e.setState({followersShown:!1})},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props,t=e.question,n=e.currentUser,c=e.concernedFollowers,r=t.followerCount,o=t.visitCount,a=this.state.followersShown;return Object(i.c)("div",{className:"QuestionFollowStatus",children:[Object(i.c)(Gt.a,{divider:!0,className:"QuestionFollowStatus-counts",children:[n?Object(i.b)(Gt.a.Item,{tag:X.c,preset:"plain",onClick:this.showFollowers,name:"关注者",value:r}):Object(i.b)(Gt.a.Item,{name:"关注者",value:r}),Object(i.b)(Gt.a.Item,{name:"被浏览",value:o})]}),Boolean(c&&c.length)&&Object(i.c)(X.c,{preset:"plain",className:"QuestionFollowStatus-people",onClick:this.showFollowers,children:[Object(i.b)("span",{className:"QuestionFollowStatus-people-tip",children:$()(Zt||(Zt=Object(Z.a)(["","也关注了该问题"])),1===c.length?c[0].name:"他们")}),c.map((function(e){return Object(i.b)(Mt.a,{user:e,avatar:!0,avatarProps:{size:26,round:!0},noLink:!0,noBadge:!0,noHoverCard:!0},e.id)}))]}),Object(i.b)(Vt.b,{size:"fullPage",onClose:this.closeFollowers,children:a&&Object(i.b)($t,{parent:t})})]})}}]),n}(p.Component),nn=Object(g.compose)(c.withRouter,Object(O.connect)((function(e,t){var n=t.params;return{currentUser:Object(L.b)(e),concernedFollowers:Object(B.f)(e,{id:n.id})}}),{loadQuestionConcernedFollowers:B.V}),Object(Xt.a)({shouldLoad:function(e){return e.currentUser&&!e.concernedFollowers},load:function(e){return e.loadQuestionConcernedFollowers(e.params.id)}}))(tn),cn=n(872),rn=n(905),on=n(2009),an=n(897),sn=n(131),ln=n(969),un=n(962),dn=n(298),bn=n(1485),hn=n(53),pn=n(2215),fn=n(1021),mn=n(67);function vn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var On=function(e){Object(d.a)(n,e);var t=vn(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={commentsShown:!1},e.handleCommentsShow=function(){var t=e.props,n=t.question.reviewInfo.tips,i=t.handleReviewingNotification;n?i():(ie.a.trackEvent(Object(nt.a)(e),{action:"Comment",element:"Button",is_intent:!0}),e.setState({commentsShown:!0}))},e.handleCommentsClose=function(){e.setState({commentsShown:!1})},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.router,n=e.router.location,i=n.pathname,c=n.search,r=Boolean(/^\/question\/(\d*)$/.test(i)),o=Object(hn.parse)(location.search.slice(1)).answer_deleted_redirect;if(r&&"true"!==o){var a=Object(mn.a)(location.hash);this.setState({byComment:a}),a&&(t.replace("".concat(i).concat(c)),this.handleCommentsShow())}}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.question.id!==e.question.id&&this.setState({commentsShown:!1})}},{key:"render",value:function(){var e=this.props,t=e.question,n=e.textStyle,c=e.isMuteSpecial,r=t.commentCount,o=t.adminClosedComment,a=this.state.commentsShown,s="",l=r&&!o;return s="textNumber"===n?l?"评论 ".concat(Object(xe.formatNumber)(r)):"":l?"".concat(Object(xe.formatNumber)(r)," 条评论"):"添加评论",Object(i.c)("div",{className:"QuestionHeader-Comment",children:[Object(i.b)(j.a,{zaText:!0,zaType:"Button",zaBlock:"添加评论",as:X.c,preset:"plain",onClick:this.handleCommentsShow,icon:pn.a,label:s,disabled:c}),Object(i.b)(zt.b,{size:"fullPage",onClose:this.handleCommentsClose,children:a&&Object(i.b)(fn.a,{type:"question",parent:t,byComment:this.state.byComment,commentNeedsReview:"censor"===t.commentPermission})})]})}}]),n}(p.Component);On.propTypes={question:v.a.object.isRequired,handleReviewingNotification:v.a.func.isRequired};var jn=Object(g.compose)(c.withRouter,Object(O.connect)((function(e,t){return{isMuteSpecial:Object(B.E)(t.question)}})))(On),gn=n(2216);var yn=function(e){var t=Object(p.useRef)(null),n=e.authRequired,c=e.questionId,r=Object(O.useDispatch)(),o=Object(O.useSelector)((function(e){return Object(B.eb)(e,{id:c})})),l=o.relationship,u=l.voting,d=l.isFollowing,b=o.voteupCount,h=o.canVote,f="0"===String(u);Object(p.useEffect)((function(){ie.a.trackCardShow(t.current,{name:String(b),id:7228})}),[]);var m=function(){if(!d){var e=f;return r(Object(B.qb)(c,e))}},v=re()("GoodQuestionAction-commonBtn",{"GoodQuestionAction-highLightBtn":"1"===String(u)}),g=n(Object(s.a)(a.a.mark((function e(){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(Object(B.tb)(c,u));case 2:return e.next=4,m();case 4:n=f?"Upvote":"UnUpvote",ie.a.trackEvent(t.current,{action:n,name:String(b),id:7229});case 6:case"end":return e.stop()}}),e)}))));return Object(i.b)("div",{className:"GoodQuestionAction",children:h&&Object(i.b)(j.a,{as:X.c,zaText:f?"好问题":"取消好问题",zaType:"Button",zaAction:f?"Upvote":"UnUpvote",onRef:function(e){return t.current=e},className:v,preset:"plain",onClick:g,icon:gn.a,zaBlock:f?"好问题":"取消好问题",label:b>0?"好问题 ".concat(b):"好问题"})})},wn=n(1396),Cn=n(1163),kn={true:{title:"确定解锁问题编辑？",subtitle:"该问题编辑已锁定，解锁后可被其他用户编辑，要解锁编辑吗？",confirmText:"解锁问题编辑"},false:{title:"确定锁定问题编辑？",subtitle:"锁定后，其他用户将不可编辑你提出的问题",confirmText:"锁定问题编辑"}};function xn(e){var t=e.showModal,n=e.showEncourageAuthorEditLock,c=e.handleConfirmEditLock,o=e.handleEditLockShown,a=n?"编辑已锁定":"锁定编辑",s=Object(p.useRef)(),l=Object(p.useState)(!1),u=Object(r.a)(l,2),d=u[0],b=u[1];Object(p.useEffect)((function(){ye.a.get("question::hasSeenShowEditLockHint")||Object(Cn.b)([Object(Cn.a)(3e3).then((function(){ye.a.set("question::hasSeenShowEditLockHint",!0),b(!0)})),Object(Cn.a)(3e3).then((function(){b(!1)}))])}),[]),Object(p.useEffect)((function(){Object(je.onViewedOnce)(s.current,(function(){ie.a.trackCardShow(s.current,{id:7666},{button:{text:a}})}))}),[a]);var h=Object(p.useCallback)((function(){ie.a.trackEvent(s.current,{id:7669,action:"Click"},{button:{text:a}}),o()}),[o,a]),f=function(e){var t=e?kn[n].confirmText:"取消";ie.a.trackEvent(null,{id:7678,action:"Select",name:t},{button:{text:a}}),e?c():o()};return Object(i.c)(i.a,{children:[Object(i.b)(X.c,{preset:"plain",onClick:h,label:a,icon:wn.a,onRef:s}),Object(i.b)(Oe.a,{className:"QuestionEditLockMenu-Hint",isOpen:d,target:s.current,placement:"top",children:"锁定后问题不可被其他用户编辑"}),Object(i.b)(ln.a,Object.assign({needCancel:!1,showButtonHorizontal:!0,showConfirmButtonRight:!0,onCancel:function(){return f(!1)},onSubmit:function(){return f(!0)},shown:t},kn[n]))]})}function An(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var Rn={invitationShown:!1,reportShown:!1,editLockShown:!1,lockTipsShown:!1,deleteShown:!1,redirectionCreatorShown:!1},Sn=[{key:"all",name:"开放评论"},{key:"censor",name:"预审评论"},{key:"nobody",name:"关闭评论"}],Nn=[{key:"open",name:"开放回答"},{key:"censor",name:"预审回答"}],Tn=function(e){Object(d.a)(n,e);var t=An(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state=Rn,e.handleReviewingNotification=function(){var t=e.props.question.reviewInfo.tips;e.props.showNotification(t,"red")},e.handleInvite=e.props.authRequired((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.eventId,i=void 0===n?3312:n;ie.a.trackEvent(null,{id:i});var c,r=e.props,o=r.question,a=o.relationship.isAnonymous,s=o.status,l=(s=void 0===s?{}:s).isLocked,u=s.isClose,d=s.isEvaluate,b=s.isSuggest,h=o.reviewInfo,p=(h=void 0===h?{}:h).tips,f=r.onInvitationTipShow;p?e.handleReviewingNotification():a?f():(l?c="锁定":u?c="关闭":(d||b)&&(c="建议修改"),c?e.props.showNotification("该问题已被".concat(c,"，不能邀请人回答此问题"),"red"):e.handleInvitationShow())}),pt.Y.invite),e.handleInvitationShow=function(){return e.setState({invitationShown:!0})},e.handleInvitationHide=function(){return e.setState({invitationShown:!1})},e.handleReport=function(){e.setState({reportShown:!e.state.reportShown})},e.handleEditLockShown=function(){e.setState({editLockShown:!e.state.editLockShown})},e.handleLockClick=function(){return e.props.question.status.isLocked?e.handleUpdateQuestionLocked():e.handleLockTipsShow()},e.handleOpenStatusChange=function(t){var n=e.props;(0,n.updateBrandQuestionOpenStatus)(n.question.id,t)},e.handleUpdateQuestionLocked=function(){var t=e.props,n=t.question.id;(0,t.updateQuestionLocked)(n)},e.handleLockTipsShow=function(){return e.setState({lockTipsShown:!0})},e.handleLockTipsHide=function(){return e.setState({lockTipsShown:!1})},e.handleDelete=function(){return e.setState({deleteShown:!0})},e.handleDeleteModalClose=function(){return e.setState({deleteShown:!1})},e.handleConfirmDelete=function(){e.handleDeleteModalClose();var t=e.props,n=t.question,i=n.id,c=n.questionType,r=t.deleteQuestion,o=t.deleteBrandQuestion;return("commercial"===c?o:r)(i).then((function(){location.href="/"}))},e.handleConfirmEditLock=function(){e.handleEditLockShown();var t=e.props;(0,t.toggleQuestionEditLock)(t.question.id)},e.handleRedirectionCreatorShow=function(){e.props.question.reviewInfo.tips?e.handleReviewingNotification():e.setState({redirectionCreatorShown:!0})},e.handleRedirectionCreatorClose=function(){e.setState({redirectionCreatorShown:!1})},e.handleRedirectionCreated=function(t,n){var i=e.props,c=i.router,r=i.question.id,o=t.id;e.handleRedirectionCreatorClose(),n.then((function(){c.push("/question/".concat(o,"?rf=").concat(r))}))},e.handleCommentPermissionChange=function(t){var n=e.props;(0,n.updateQuestionPermission)(n.question.id,t)},e.handleShareMenuTogglerClick=function(){var t=e.props.question.reviewInfo;return!(t=void 0===t?{}:t).tips||(e.handleReviewingNotification(),!1)},e.toggleAnonymous=function(){var t=e.props,n=t.question.reviewInfo,i=n.tips,c=n.editTips,r=t.isCurrentAnswerCommercialReported;i?e.handleReviewingNotification():c?e.props.showNotification(c,"red"):r?e.props.showNotification("已经进行商业声明的内容不能启用匿名","red"):e.context.toggleAnonymous()},e.getQuestionStatus=function(){return Object(mt.c)(e.props.question.status)},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.getHandleInvite;e&&e(this.handleInvite)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.question.id!==e.question.id&&this.setState(Rn)}},{key:"shouldShowAnonymousMenuItem",get:function(){var e=this.props.currentUser;if(e&&!e.isOrg){var t=this.props,n=t.question,i=n.questionType,c=n.relationship.isAnonymous,r=t.allowCommercialAnonymousAnswer;if(c)return!0;if("normal"===i)return!0;if("commercial"===i&&r)return!0}return!1}},{key:"shouldShowMenu",get:function(){var e=this.props,t=e.question.questionType,n=e.permission.canBrandAdminEdit,i="commercial"===t;return!i||!(!i||!n)}},{key:"renderCommercialMenuItems",value:function(e){var t=this,n=this.props,c=n.permission.canBrandAdminEdit,r=n.question,o=r.status,a=(o=void 0===o?{}:o).isLocked,s=r.commentPermission,l=r.brandOpenStatus,u=r.brand,d=(u=void 0===u?{}:u).isPuQuestion;if(!c)return null;var b=Sn,h=Nn;return Object(i.c)(p.Fragment,{children:[b.map((function(n){var c=n.key,r=n.name,o=!s&&"all"===c||s===c;return Object(i.c)(sn.b,{className:e,onClick:function(){return t.handleCommentPermissionChange(c)},children:[o&&Object(i.b)(cn.a,{className:"MenuItem-icon",text:!0,center:!0})," ",r]},c)})),Object(i.b)("li",{className:"Menu-divider"}),(d&&(h=[{key:"open",name:"开放回答"}]),Object(i.c)(i.a,{children:[!a&&h.map((function(n){var c=n.key,r=n.name,o=l===c;return Object(i.c)(sn.b,{className:e,onClick:function(){return!o&&t.handleOpenStatusChange(c)},children:[o&&Object(i.b)(cn.a,{className:"MenuItem-icon",text:!0,center:!0})," ",r]},c)})),!d&&Object(i.b)(sn.b,{className:e,onClick:t.handleLockClick,children:a?"开放回答":"关闭回答"}),Object(i.b)("li",{className:"Menu-divider"})]}))]})}},{key:"renderMobileMenuItems",value:function(e){var t=this.props,n=t.question.id,c=t.shouldOia;return e.map((function(e){var t=e.text,r=e.handler;return Object(i.b)(sn.b,{onClick:c?function(){return Object(tt.e)(Object(ft.a)({type:"question",id:n},{utm_content:"invite"}))}:r,children:t},t)}))}},{key:"renderLogMenuItem",value:function(){var e=this.props,t=e.question.id;return e.shouldOia?Object(i.b)(sn.b,{onClick:function(){return Object(tt.e)(Object(ft.a)({type:"question",id:t}))},children:"查看问题日志"}):Object(i.b)(sn.b,{tag:at.a,a:!0,to:"/question/".concat(t,"/log"),children:"查看问题日志"})}},{key:"render",value:function(){var e=this.state,t=e.invitationShown,n=e.reportShown,c=e.editLockShown,r=e.lockTipsShown,o=e.deleteShown,a=e.redirectionCreatorShown,s=this.props,l=s.question,u=s.question,d=u.id,b=u.title,h=u.answerCount,p=u.collapsedAnswerCount,f=u.relationship,m=f.isAuthor,v=f.isAnonymous,O=u.questionType,g=u.isEditable,y=u.author.urlToken,w=u.showEncourageAuthorEditLock,C=s.isMuteSpecial,k=s.isMuteFreeze,x=s.publicEditPermission,A=(x=void 0===x?{}:x).isQuestionRedirectEditable,R=s.currentUserUrlToken,S=s.permission.canBrandAdminEdit,N=s.editQuestionButton,T=s.currentUser,q=s.authRequired,B="commercial"===O,Q=T&&!m,I=T&&m&&"boolean"==typeof w,P=B?S:Boolean(m&&0===h&&0===p),E=[Q&&{text:"举报",icon:rn.a,handler:this.handleReport}].filter(Boolean),z=y===R,L=Object(mt.e)(g,z,A),M=this.shouldShowAnonymousMenuItem,D=M||this.shouldShowMenu,F=re()("QuestionHeader-menu-item",{"QuestionHeader-menu-item--com":B});return Object(i.c)("div",{className:"QuestionHeaderActions",children:[Object(i.b)(j.a,{as:X.c,zaText:!0,zaType:"Button",color:"grey",style:{marginRight:16},onClick:this.handleInvite,zaBlock:"邀请回答",label:"邀请回答",icon:on.a,disabled:C||k}),Object(i.b)(yn,{questionId:d,authRequired:q}),Object(i.b)(jn,{question:l,handleReviewingNotification:this.handleReviewingNotification}),Object(i.b)(un.a,{id:d,title:b,href:"/question/".concat(d),onTogglerClick:this.handleShareMenuTogglerClick,type:"question",disabled:C||k}),N,I&&Object(i.b)(xn,{showModal:c,showEncourageAuthorEditLock:w,handleEditLockShown:this.handleEditLockShown,handleConfirmEditLock:this.handleConfirmEditLock}),D&&Object(i.c)(sn.c,{toggler:Object(i.b)(X.c,{preset:"plain","aria-label":"更多",icon:an.a}),menuClassName:"QuestionHeader-menu",itemClassName:F,children:[!1,M&&Object(i.b)(sn.b,{onClick:this.toggleAnonymous,children:v?"取消匿名身份":"使用匿名身份"}),B&&this.renderCommercialMenuItems(F),P&&Object(i.b)(sn.b,{onClick:this.handleDelete,children:"删除问题"}),L&&!T.isOrg&&"normal"===O&&Object(i.b)(sn.b,{onClick:this.handleRedirectionCreatorShow,children:"问题重定向"}),!B&&this.renderLogMenuItem(),E.map((function(e){var t=e.text,n=e.handler,c=e.disabled;return Object(i.b)(sn.b,{onClick:n,disabled:c,children:"举报问题"},t)}))]}),Object(i.b)(dn.a,{type:"question",urlToken:d,shown:n,status:this.getQuestionStatus(),onClose:this.handleReport,zaEnabled:!0}),Object(i.b)(zt.b,{size:"fullPage",onClose:this.handleInvitationHide,children:t&&Object(i.b)(Dt.a,{question:l})}),Object(i.b)(ln.a,{title:B?"关闭回答":"锁定问题",subtitle:"".concat(B?"关闭":"锁定","后该问题将无法添加新回答，你确定要").concat(B?"关闭":"锁定","吗？"),shown:r,onCancel:this.handleLockTipsHide,onSubmit:this.handleUpdateQuestionLocked}),Object(i.b)(zt.b,{size:"large",title:"问题重定向",onClose:this.handleRedirectionCreatorClose,children:a&&Object(i.b)(bn.a,{question:l,onSubmitted:this.handleRedirectionCreated})}),Object(i.b)(ln.a,{title:"删除问题",subtitle:"你确定要删除这个问题吗？相关的评论也将被删除。",onCancel:this.handleDeleteModalClose,onSubmit:this.handleConfirmDelete,shown:o})]})}}]),n}(p.PureComponent);Tn.contextTypes={toggleAnonymous:v.a.func};var qn=Object(g.compose)(c.withRouter,R.a,Object(O.connect)((function(e,t){return{shouldOia:Object(st.h)(e),isMuteSpecial:Object(B.E)(t.question),isMuteFreeze:Object(B.D)(t.question),publicEditPermission:e.publicEditPermission,currentUserUrlToken:e.currentUser,permission:Object(B.cb)(e),allowCommercialAnonymousAnswer:"show"===Object(st.a)(e,"gue_anonymous"),isCurrentAnswerCommercialReported:Object(B.C)(e,t.question)}}),{deleteQuestion:B.l,deleteBrandQuestion:B.i,updateQuestionLocked:B.rb,toggleQuestionEditLock:B.jb,showNotification:F.h,updateQuestionPermission:B.sb,updateBrandQuestionOpenStatus:B.kb}))(Tn);function Bn(e){var t=e.brand,n=e.noDivider,c=t.name,r=t.logo,o=t.target,a=t.description,s=t.typeDescription,l=o?"a":"div";return Object(i.c)("div",{className:re()("BrandQuestionSymbol",{"is-mobile":!1}),children:[Object(i.c)(l,Object.assign(Object.assign({className:"BrandQuestionSymbol-brandLink"},o&&{href:"/".concat("organization"===o.userType?"org":"people","/").concat(o.urlToken)}),{},{children:[Object(i.b)("img",{role:"presentation",src:r,className:"BrandQuestionSymbol-logo",alt:""}),Object(i.b)("span",{className:"BrandQuestionSymbol-name",children:c}),o&&Object(i.b)(he.c,{badge:o.badge})]})),Object(i.b)("span",{css:{marginLeft:5},children:a}),Boolean(s)&&Object(i.b)("span",{className:"BrandQuestionSymbol-typeDesc",children:s}),!n&&Object(i.b)("div",{className:"BrandQuestionSymbol-divider"})]})}var Qn=n(1463);function In(e,t){var n=new Date(e),i=new Date(t),c=Date.UTC(n.getFullYear(),n.getMonth(),n.getDate()),r=Date.UTC(i.getFullYear(),i.getMonth(),i.getDate());return Math.floor((r-c)/864e5)}var Pn=Object.assign;var En=function(e){return f.a.createElement(Ne.a,Pn({viewBox:"0 0 72 18"},e),f.a.createElement("g",{fillRule:"evenodd"},f.a.createElement("rect",{width:"72",height:"18",rx:"2"}),f.a.createElement("text",{fill:"#FFF",fontSize:"12",fontWeight:"500"},f.a.createElement("tspan",{x:"19",y:"13"},"有奖问答")),f.a.createElement("path",{fill:"#FFF",d:"M13.4 5.8H11a.4.4 0 01-.4-.3l.1-.4 1.6-1.7c.4-.4 1-.5 1.6-.2.5.3.8 1 .7 1.5-.2.6-.7 1-1.3 1zm0-1.9L13 4l-.7.8h1c.3 0 .5-.2.5-.4 0-.3-.2-.5-.5-.5zM10 6.4v1.5H5.8a.8.8 0 110-1.5H10zm.8 0h4.3a.8.8 0 010 1.5H11V6.4zM10 8.7v6H8.4c-.8 0-1.1-.2-1.5-.4-.3-.1-.5-.4-.7-.7-.2-.3-.3-.7-.3-1.5v-.9c0-.8.1-1.1.3-1.5l.7-.7c.4-.2.7-.3 1.5-.3h1.7zm.8 0h1.7c.8 0 1.1.1 1.5.3l.7.7c.2.4.3.7.3 1.5v1c0 .7-.1 1-.3 1.4-.2.3-.4.6-.7.7-.4.2-.7.3-1.5.3h-1.7V8.7zm-3.3-3c-.6 0-1.1-.4-1.3-1-.1-.5.2-1.2.7-1.5.5-.3 1.2-.2 1.6.2l1.6 1.7s.1.3 0 .4c0 .2-.2.2-.3.3H7.6zM8 4a.4.4 0 00-.5 0c-.2 0-.4.3-.3.5 0 .2.2.3.4.3h1L8 4z",fillRule:"nonzero"})))};function zn(e){var t=["一","二","三"],n=function(){var t=e.question,n=t.id,r=t.prize,o=r.endTime,a=r.rule,s=r.status;return Object(i.c)("div",{className:"BrandQuestionPrizes-tips",children:[Object(i.c)("div",{className:"BrandQuestionPrizes-tip",children:[Object(i.c)("span",{className:"BrandQuestionPrizes-tipTitle",children:["活动时间","："]}),Qn.a(new Date(1e3*o),"yyyy-MM-dd HH:mm")," 截止"]}),Object(i.c)("div",{className:"BrandQuestionPrizes-tip",children:[Object(i.c)("span",{className:"BrandQuestionPrizes-tipTitle",children:["活动规则","："]}),a]}),Object(i.c)("div",{className:"BrandQuestionPrizes-tip",children:[Object(i.c)("span",{className:"BrandQuestionPrizes-tipTitle",children:["获奖公示","："]}),"ongoing"===s&&"获奖名单将在活动结束后公布","finished"===s&&"开奖中，即将公布获奖名单","awarded"===s&&Object(i.b)(c.Link,{target:"_blank",to:"/organization/question/".concat(n,"/winners"),children:"查看获奖名单"}),!1]}),Object(i.c)("div",{className:"BrandQuestionPrizes-rule",children:["本问题设置了有奖问答，添加回答即视为参与活动，并同意遵守",Object(i.b)("a",{className:"BrandQuestionPrizes-ruleLink",href:"https://www.zhihu.com/organization/ophelp/norm/53",target:"_blank",rel:"noopener noreferrer",children:"《有奖问答活动管理办法》"})]})]})},r=e.handleToggle,o=e.expanded,a=e.question,s=a.id,l=a.prize,u=a.relationship,d=(u=void 0===u?{}:u).isAuthor,b=a.permission,h=(b=void 0===b?{}:b).isSuperUser;if(!l||!l.status)return null;var p=l.endTime,f=l.prizes,m=l.status,v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date,n=new Date(t),i=Math.floor(n.getTime()/1e3),c=e-i;if(c<0)return null;var r,o=0,a=1,s=60*a,l=60*s,u=24*l;if(c>u){var d=new Date(1e3*e);o=In(n,d),r="天"}else c>l?(o=Math.floor(c/l),r="小时"):c>s?(o=Math.floor(c/s),r="分钟"):(o=c,r="秒");return{quantity:o,unit:r}}(p);return Object(i.c)("div",{className:re()("BrandQuestionPrizes",{"is-mobile":!1}),children:[Object(i.c)("div",{className:"BrandQuestionPrizes-info",children:[Object(i.c)("div",{className:"BrandQuestionPrizes-bar",onClick:r,children:[Object(i.c)("div",{className:"BrandQuestionPrizes-desc",children:[Object(i.c)("div",{className:"BrandQuestionPrizes-symbol",children:[Object(i.b)(En,{alt:"logo",width:72,height:18,fill:"ongoing"===m?"#ff9607":"#999999"}),"ongoing"===m&&Object(i.c)("span",{children:["距离结束还有",Object(i.b)("em",{children:v.quantity}),v.unit]}),"finished"===m&&"待开奖","awarded"===m&&"已开奖"]}),Object(i.c)("div",{className:"BrandQuestionPrizes-name",children:["奖品：",f[0].name,f.length>1&&"等"]})]}),Object(i.c)("div",{className:"BrandQuestionPrizes-images",children:[f.map((function(e,t){var n=e.imageUrl;return n&&Object(i.b)("img",{src:n,alt:""},"BrandQuestionPrizes-images".concat(t))})),Object(i.b)(Ue.a,{text:!0,center:!0,fill:"#9fadc7"})]})]}),o&&Object(i.b)("div",{className:"BrandQuestionPrizes-detail",children:f.map((function(e,n){var c=e.imageUrl,r=e.name,o=e.value,a=e.quantity;return Object(i.c)("div",{className:"BrandQuestionPrizes-prize",children:[Object(i.c)("div",{className:"BrandQuestionPrizes-intro",children:[c&&Object(i.b)("img",{className:"BrandQuestionPrizes-prizeImage",src:c,alt:""}),Object(i.c)("div",{className:"BrandQuestionPrizes-prizeInfo",children:[Object(i.c)("div",{className:"BrandQuestionPrizes-prizeName",children:[f.length>1&&"".concat(t[n],"等奖："),r]}),Object(i.c)("div",{className:"BrandQuestionPrizes-prizeValue",children:["价值 ¥ ",o]})]})]}),Object(i.c)("div",{className:"BrandQuestionPrizes-prizeQuantity",children:[a," 份"]})]},"BrandQuestionPrizes-prize".concat(n))}))}),o&&!1]}),o&&n(),o&&Object(i.b)("hr",{className:"BrandQuestionPrizes-split"}),(h||d)&&Object(i.c)(at.a,{className:"BrandQuestionPrizes-edit",to:"/organization/question/".concat(s,"/setting/").concat("finished"===m?"winners":"prize"),children:["ongoing"===m&&"编辑有奖回答","finished"===m&&"填写获奖名单"]})]})}function Ln(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var Mn=function(e){Object(d.a)(n,e);var t=Ln(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props,t=e.question,n=t.id,c=t.permission,r=void 0===c?{}:c,o=e.router,a=r.isSuperUser,s=r.canBrandAdminEdit,l=r.haveCard;return s||a?Object(i.b)(sn.c,{className:"BrandQuestionSettingMenu",toggler:Object(i.b)(X.c,{children:"设置样式"}),children:Object(i.c)(i.a,{children:[Object(i.b)(sn.b,{className:"BrandQuestionSettingMenu-item",onClick:function(){o.push("/organization/question/".concat(n,"/setting/topbanner"))},children:"设置提问头图"}),Object(i.b)(sn.b,{className:"BrandQuestionSettingMenu-item",onClick:function(){o.push("/organization/question/".concat(n,"/setting/prize"))},children:"编辑有奖问答"}),l&&Object(i.b)(sn.b,{className:"BrandQuestionSettingMenu-item",onClick:function(){o.push("/organization/question/".concat(n,"/setting/advanced"))},children:"编辑品牌推荐"})]})}):null}}]),n}(p.Component),Dn=Object(g.compose)(c.withRouter,Object(O.connect)((function(e,t){return{question:e.entities.questions[t.question.id]}})),Ft.a)(Mn),Fn=n(874),Hn=n(1081),_n=n(478);function Un(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var Vn=function(e){Object(d.a)(n,e);var t=Un(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).handleFollow=function(){var t=e.props.pin,n=(t=void 0===t?{}:t).author.isFollowing?1977:1976;e.handleTrack(n)},e.handleTrack=function(t){var n=e.props.pin,i=(n=void 0===n?{}:n).author;ie.a.trackEvent(Object(nt.a)(e),{id:t},{button:{text:i.name}})},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.target,i=n.type,c=n.id,r=t.getPinContents;"pin"===i&&r(c,{failsafe:!0}).then((function(t){var n=t.payload,i=(void 0===n?{}:n).author,c=(i=void 0===i?{}:i).name;ie.a.trackCardShow(e,{id:1969},{button:{text:c}})}))}},{key:"render",value:function(){var e=this,t=this.props.pin;if(!t||!t.content)return null;var n=t.author,c=t.id,r=t.content[0].content.replace(/<a.*class="hash_tag".*?<\/a>/g,""),o=n||{},a=o.type,s=o.urlToken,l=o.isFollowing,u="https://www.zhihu.com/pin/".concat(c);return Object(i.c)("div",{className:"QuestionRelatedCard",children:[Object(i.b)("div",{className:"QuestionRelatedCard-title",children:"相关报道"}),Object(i.c)("div",{className:"QuestionRelatedCard-content",children:[Object(i.b)("span",{dangerouslySetInnerHTML:{__html:Object(Hn.truncateHTML)(r,110).content}}),u&&Object(i.b)("a",{className:"QuestionRelated-jump",href:u,onClick:function(){e.handleTrack(1975)},children:"查看详情"})]}),s&&Object(i.c)("div",{className:"QuestionRelatedCard-footer",children:[Object(i.c)("div",{children:["来自",Object(i.b)("a",{className:"QuestionRelatedCard-from",href:"https://www.zhihu.com/people/".concat(s),target:"_blank",rel:"noopener noreferrer",onClick:function(){e.handleTrack(1971)},children:n.name})]}),Object(i.b)("div",{role:"button",tabIndex:0,onClick:this.handleFollow,children:Object(i.c)(ht.a,{className:"QuestionRelatedCard-follow",type:a,id:s,isFollowing:l,children:[Object(i.b)(Fn.a,{text:!0,center:!0},"icon"),"关注机构"]})})]})]})}}]),n}(p.Component);Vn.propTypes={target:v.a.shape({type:v.a.string,id:v.a.string}).isRequired};var Gn=Object(g.compose)(Object(O.connect)((function(e,t){return{pin:Object(_n.g)(e,t.target.id)}}),{getPinContents:_n.e}),Object(x.b)((function(e){return{module:"PinItem",card:{content:{type:"Pin",id:e.target.id}}}})))(Vn);function Wn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var Kn,Jn,Zn,Yn,$n=function(e){Object(d.a)(n,e);var t=Wn(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props.question.author;return Object(i.b)("div",{className:"OrgQuestionSymbol",children:Object(i.c)("div",{className:re()("OrgQuestionSymbol-inner",{"OrgQuestionSymbol-inner--mobile":!1}),children:[Object(i.c)("div",{className:"OrgQuestionSymbol-main QuestionHeader-main",children:[Object(i.b)("div",{className:"OrgQuestionSymbol-avatar",children:Object(i.b)(Mt.a,{user:e,avatar:!0,avatarProps:{size:38}})}),Object(i.c)("div",{className:"OrgQuestionSymbol-name",children:[Object(i.b)(Mt.a,{user:e})," 的提问"]})]}),Object(i.b)("div",{className:"OrgQuestionSymbol-tip",children:Object(i.b)(at.a,{preset:"plain",a:!0,to:"/org-intro#org-question",target:"_blank",children:"了解机构提问"})})]})})}}]),n}(p.Component),Xn=n(34),ei=n.n(Xn),ti=n(447),ni=n.n(ti),ii=n(25),ci=n.n(ii),ri=n(151),oi=n.n(ri),ai=n(40),si=n(170),li=n(59),ui=n.n(li),di=n(42),bi=n(506),hi=n(93),pi=n(910),fi=["data"],mi=["data","onVote","onVoteError"],vi=function(e,t){return Object(ai.d)(oi()(a.a.mark((function n(){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e();case 3:n.next=8;break;case 5:n.prev=5,n.t0=n.catch(0),t(n.t0);case 8:case"end":return n.stop()}}),n,null,[[0,5]])}))))},Oi=f.a.createContext({}),ji=function(){return Object(p.useContext)(Oi)},gi=function(e){var t=e.data,n=e.onVote,c=void 0===n?ui.a:n,r=e.onVoteError,o=void 0===r?ui.a:r,s=e.children,l=Object(p.useState)(t),u=ci()(l,2),d=u[0],b=u[1],h=Object(p.useState)(!0),f=ci()(h,2),m=f[0],v=f[1],O=d.urlToken,j=d.vote,g=function(e){var t=Object(bi.b)();return function(n,i){return t("https://www.zhihu.com/api/v4/topics/".concat(e,"/vote/").concat(n),{method:i})}}(O);Object(p.useEffect)((function(){return b(t)}),[t]);var y=function(){var e=oi()(a.a.mark((function e(t,n){var i,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(null==j?void 0:j.totalVotes)||0,((null==j?void 0:j.liked)||(null==j?void 0:j.disliked))&&i--,c=Object.assign(Object.assign({},d),{},{vote:Object.assign(Object.assign({},j),{},{liked:t,disliked:n,totalVotes:i+(t||n?1:0)})}),e.next=5,di.a.supportsAction("iOS/hapticFeedback");case 5:if(!e.sent){e.next=7;break}di.a.dispatch("iOS/hapticFeedback");case 7:return b(c),v(!1),e.abrupt("return",c);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),w=vi(oi()(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g("like","POST");case 2:c(y(!0,!1));case 3:case"end":return e.stop()}}),e)}))),o),C=vi(oi()(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g("like","DELETE");case 2:c(y(!1,!1));case 3:case"end":return e.stop()}}),e)}))),o),k=vi(oi()(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g("dislike","POST");case 2:c(y(!1,!0));case 3:case"end":return e.stop()}}),e)}))),o),x=vi(oi()(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g("dislike","DELETE");case 2:c(y(!1,!1));case 3:case"end":return e.stop()}}),e)}))),o),A=Object(p.useMemo)((function(){return{data:d,noAnimation:m,recommendVote:w,recommendUnVote:C,againstVote:k,againstUnVote:x}}),[x,k,C,w,d,m]);return Object(i.b)(Oi.Provider,Object.assign({value:A},{children:s}),void 0)},yi=function(e,t,n){return function(t){var i=t.colors;return Object.assign({textDecoration:"none",border:e?"":"1px solid ".concat(i.GBK09A),borderRadius:e?"8px":"2px",fontSize:e?"13px":"15px",color:e?i.GBK06A:i.GBK02A},n&&{"*, *::before, *::after":{animation:"none !important"}})}},wi=function(e,t){var n=null;if(e){var i="answer"===t;n={width:i?"30px":"48px",height:i?"40px":"66px"}}else n={width:"36px",height:"54px"};return Object.assign(Object.assign({},n),{},{flex:"0 0 auto",borderRadius:"3px",overflow:"hidden",objectFit:"cover",marginRight:"10px",filter:"brightness(.95)"})},Ci=Object(qt.h)(Kn||(Kn=ni()(["\n50% { opacity: 1; transform: scale(2.5); }\nto { transform: scale(0.6); top: -5px; }\n"]))),ki=Object(qt.h)(Jn||(Jn=ni()(["\n50% { opacity: 1; transform: scale(2.5); }\nto { transform: scale(0.6); bottom: -5px; }\n"]))),xi=Object(qt.h)(Zn||(Zn=ni()(["\nfrom, 70%, to { transform: scale(1); }\n40% { transform: scale(1.2); }\n90% { transform: scale(1.05); }\n"]))),Ai=Object(qt.h)(Yn||(Yn=ni()(["to { transform: scale(1); }"]))),Ri=function(e){var t=e.colors;return{position:"relative",boxSizing:"content-box",borderRadius:"50%",border:"0.5px solid ".concat(t.GBK09A),cursor:"pointer",transition:"background-color .5s","::before":{content:'""',width:"40px",height:"40px",margin:"-20px",position:"absolute",top:"50%",left:"50%",borderRadius:"50%",background:t.GBK99A,opacity:"0.2",zIndex:0,transform:"scale(0)"},'&[aria-pressed="true"]':{"::before":{animation:"".concat(Ai," .5s ease-in-out")},".Icon":{animation:"".concat(xi," .5s ease-in-out"),animationDelay:".5s"},".Sparkle":{"::before":{animation:"".concat(Ci," .6s ease-in-out"),animationDelay:".2s"},"::after":{animation:"".concat(ki," .6s ease-in-out"),animationDelay:".2s"}}}}},Si=function(e){return{position:"absolute",top:0,left:0,width:"40px",height:"40px","::before, ::after":{content:'""',position:"absolute",marginLeft:"-1px",left:"50%",width:"2px",height:"2px",backgroundColor:e.colors.GBL01A,borderRadius:"50%",opacity:"0"},"::before":{top:"0"},"::after":{bottom:"0"},":nth-of-type(3)":{transform:"rotate(45deg)"},":nth-of-type(4)":{transform:"rotate(90deg)"},":nth-of-type(5)":{transform:"rotate(135deg)"}}},Ni={normal:"知友推荐",less:"评分积累中",close:"暂无评分"},Ti=function(e){var t=e.vote,n=Object(si.b)().Mobile;return!t||t.disable?null:Object(i.c)(w.Text,{children:["normal"===t.ratioStatus&&Object(i.c)(w.Text,Object.assign({as:"span",color:"GBL01A",fontSize:n?"inherit":"17px",fontWeight:"bold"},{children:[(100*t.score).toFixed(),"% "]}),void 0),Ni[t.ratioStatus]]},void 0)},qi=function(e){var t=e.vote,n=e.isTitle;return!t||t.disable||"close"===t.ratioStatus?null:Object(i.c)(w.Text,{children:[n&&Object(i.b)(i.a,{children:" · "},void 0),"".concat(Object(xe.cnNiceNumber)(t.totalVotes),"人评价")]},void 0)},Bi=function(e){var t,n=e.topic,c=n.title,r=n.vote,o=Object(si.b)().Mobile;return Object(i.c)(w.Flex,Object.assign({alignItems:"baseline",css:(t=o,function(e){return{color:e.colors.GBK02A,".topicMetaTitle":{display:"inline-block",marginRight:t?0:"11px",fontWeight:"bold",fontSize:t?"15px":"17px"}}})},{children:[Object(i.b)(w.Text,Object.assign({className:"topicMetaTitle"},{children:c}),void 0),!o&&Object(i.b)(Ti,{vote:r},void 0),!o&&Object(i.b)(qi,{isTitle:!0,vote:r},void 0)]}),void 0)},Qi=function(e){var t=e.topic,n=e.lines,c=void 0===n?1:n;return Object(i.b)(w.Text,Object.assign({color:"GBK06A",css:Object(hi.d)(c)},{children:t.excerpt}),void 0)},Ii=function(e){var t=e.topic,n=e.position,c=t.vote,r=Object(si.b)().Mobile,o=!c||c.disable;if(!r)return Object(i.b)(Qi,{topic:t},void 0);var a="question"===n;return o?Object(i.b)(Qi,{topic:t,lines:a?2:1},void 0):Object(i.c)(i.a,{children:[Object(i.b)(Ti,{vote:c},void 0),a&&Object(i.b)(qi,{vote:c},void 0)]},void 0)},Pi={recommend:{tip:"推荐",icon:gn.a,color:"GBL01A"},against:{tip:"不推荐",icon:function(e){return Object(i.b)(gn.a,Object.assign({css:{transform:"rotate(180deg)"}},e),void 0)},color:"GBK04A"}},Ei=[0,1,2,3].map((function(e){return Object(i.b)("div",{css:Si,className:"Sparkle"},e)})),zi=function(e){var t=e.className,n=e.checked,c=e.type,r=e.onClick,o=Pi[c],a=o.tip,s=o.icon,l=o.color,u=Object(ai.d)((function(e){e.preventDefault(),e.stopPropagation(),r("".concat(c).concat(n?"UnVote":"Vote"))}));return Object(i.c)(w.Flex,Object.assign({as:"button",alignItems:"center",justifyContent:"center",width:"40px",height:"40px",p:0,bg:n?l:"GBK99A",color:n?"GBK99A":"GBL05A",css:Ri,className:t,"data-tooltip":a,"aria-pressed":n,"aria-label":a,onClick:u},{children:[Object(i.b)("div",Object.assign({className:"Icon"},{children:Object(i.b)(s,{size:20,center:!0},void 0)}),void 0),"recommend"===c&&Ei]}),void 0)},Li=function(){var e,t,n=ji(),c=n.data,r=ei()(n,fi),o=Object(ai.d)((function(e){var t;null===(t=r[e])||void 0===t||t.call(r)}));return Object(i.c)(w.Flex,Object.assign({flex:"0 0 auto",css:{margin:"0 12px"}},{children:[Object(i.b)(zi,{css:{marginRight:"9px"},type:"recommend",checked:null===(e=null==c?void 0:c.vote)||void 0===e?void 0:e.liked,onClick:o},void 0),Object(i.b)(zi,{type:"against",checked:null===(t=null==c?void 0:c.vote)||void 0===t?void 0:t.disliked,onClick:o},void 0)]}),void 0)},Mi=function(e){var t=e.className,n=e.position,c=e.onClick,r=ji(),o=r.data,a=r.noAnimation,s=o.urlToken,l=o.avatar,u=o.title,d=void 0===u?"":u,b=o.vote,h=Object(ai.d)((function(){null==c||c()})),p=Object(si.b)().Mobile,f=b&&"close"!==b.ratioStatus;return Object(i.c)(w.Flex,Object.assign({as:"a",alignItems:"center",bg:"GBK10A",p:"12px",className:t,css:yi(p,0,a),"aria-label":"话题 ".concat(d),target:"_blank",href:"https://www.zhihu.com/topic/".concat(s),onClick:h},{children:[l&&Object(i.b)("img",{alt:"",src:l,css:wi(p,n)},void 0),Object(i.c)(w.Flex,Object.assign({flexDirection:"column",flex:"1 1 auto",justifyContent:"space-around"},{children:[Object(i.b)(Bi,{topic:o},void 0),Object(i.b)(Ii,{topic:o,position:n},void 0)]}),void 0),f&&Object(i.b)(Li,{},void 0)]}),void 0)},Di=function(e){var t=e.data,n=e.onVote,c=e.onVoteError,r=ei()(e,mi);return(null==t?void 0:t.title)?Object(i.b)(gi,Object.assign({data:t,onVote:n,onVoteError:c},{children:Object(i.b)(Mi,Object.assign({},r),void 0)}),void 0):null},Fi=function(e){var t=e.className,n=e.data,c=n.avatar,r=n.urlToken,o=n.title,a=n.excerpt;return Object(i.c)(w.Box,Object.assign({as:"a",display:"block",p:"20px 20px 12px",className:t,css:{textDecoration:"none",outlineOffset:"-1px"},"aria-label":"话题 ".concat(o),target:"_blank",href:"https://www.zhihu.com/topic/".concat(r)},{children:[Object(i.c)(w.Flex,Object.assign({mb:"12px"},{children:[c&&Object(i.b)(w.Image,{flex:"0 0 auto",width:"50px",height:"70px",overflow:"hidden",mr:"12px",css:{objectFit:"cover",borderRadius:"3px",filter:"brightness(.95)"},alt:"",src:c},void 0),Object(i.c)("div",{children:[Object(i.b)(w.Text,Object.assign({color:"GBK02A",mb:"7px",fontSize:"15px",fontWeight:"bold",css:Object(hi.d)(1)},{children:o}),void 0),Object(i.b)(w.Text,Object.assign({color:"GBK04A",fontSize:"14px",css:Object(hi.d)(2)},{children:a}),void 0)]},void 0)]}),void 0),Object(i.c)(w.Text,Object.assign({color:"GBL07A",fontSize:"14px"},{children:["查看更多",Object(i.b)(pi.a,{center:!0,size:22},void 0)]}),void 0)]}),void 0)},Hi=function(e){var t=e.data,n=Object(me.b)(),c=Object(r.a)(n,2),o=c[0],a=c[1];return Object(p.useEffect)((function(){a()}),[]),o?!t.vote||t.vote.disable?null:Object(i.b)(Di,{css:{margin:"14px 0"},data:t,position:"question"}):null},_i=Object.assign;var Ui=function(e){return f.a.createElement(Ne.a,_i({viewBox:"0 0 24 24"},e),f.a.createElement("path",{d:"M17.248 6.5H13.11a.71.71 0 01-.657-.446.731.731 0 01.154-.787l2.812-3.045a2.395 2.395 0 012.926-.392c.95.558 1.527 1.767 1.243 2.844A2.431 2.431 0 0117.248 6.5zm-.114-3.357a.798.798 0 00-.572.24l-1.265 1.474h1.95c.447 0 .695-.44.695-.893a.815.815 0 00-.808-.821zM11.286 7.61v2.857H3.429a1.429 1.429 0 010-2.857h7.857zm1.428 0h7.857a1.429 1.429 0 010 2.857h-7.857V7.611zm-1.428 4.286V22.61H6.23c-.892 0-1.215-.093-1.541-.267a1.817 1.817 0 01-.756-.756c-.175-.326-.267-.65-.267-1.54V14.46c0-.892.092-1.215.267-1.541.174-.326.43-.582.756-.756.326-.174.649-.267 1.54-.267h5.056zm1.428 0h5.055c.892 0 1.215.093 1.541.267.326.174.582.43.756.756.175.326.267.65.267 1.54v5.587c0 .892-.092 1.215-.267 1.541-.174.326-.43.582-.756.756-.326.174-.649.267-1.54.267h-5.056V11.897zM6.752 6.5a2.431 2.431 0 01-2.341-1.826c-.284-1.077.293-2.286 1.243-2.844a2.395 2.395 0 012.926.392l2.812 3.045a.731.731 0 01.153.787.711.711 0 01-.656.446H6.752zm.686-3.117a.798.798 0 00-.976-.13c-.317.185-.585.637-.49.996a.81.81 0 00.78.608h1.951L7.438 3.383z"}))};function Vi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var Gi=function(e){Object(d.a)(n,e);var t=Vi(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={remainedTime:null},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.totalCountdownTime,i=t.onFinish;"number"==typeof n?(this.setState({remainedTime:n}),this.timer=setInterval((function(){e.setState({remainedTime:e.state.remainedTime-5})}),5e3)):"function"==typeof i&&i()}},{key:"componentDidUpdate",value:function(){var e=this.props.onFinish;this.state.remainedTime<=0&&(clearInterval(this.timer),"function"==typeof e&&e())}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer)}},{key:"renderCountdownTime",value:function(){var e=this.state.remainedTime;if(e<60)return Object(i.c)(p.Fragment,{children:["距结束不足 ",Object(i.b)("span",{children:"1"})," 分钟"]});var t,n,c=(t=e,n=Math.floor(t/60),{hours:Math.floor(n/60),minutes:n%60}),r=c.hours,o=c.minutes;return 0===r?Object(i.c)(p.Fragment,{children:["距结束还有 ",Object(i.b)("span",{children:o})," 分钟"]}):Object(i.c)(p.Fragment,{children:["距结束还有 ",Object(i.b)("span",{children:r})," 小时"," ",o>0&&Object(i.c)(p.Fragment,{children:[Object(i.b)("span",{children:o})," 分钟"]})]})}},{key:"render",value:function(){var e=this.props.className;return null===this.state.remainedTime?Object(i.b)("div",{className:e,children:"距结束还有"}):Object(i.b)("div",{className:e,children:this.renderCountdownTime()})}}]),n}(p.Component);function Wi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}Gi.propTypes={totalCountdownTime:v.a.number.isRequired,onFinish:v.a.func};var Ki,Ji=function(e){Object(d.a)(n,e);var t=Wi(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={expanded:!1,bodyHeight:0},e.contentRef=Object(p.createRef)(),e.handleExpand=function(){var t=e.contentRef.current;e.setState({expanded:!0,bodyHeight:"".concat(t.offsetHeight+1,"px")}),ie.a.trackEvent(Object(nt.a)(e),{id:5036,action:"Expand"})},e.handleCollapse=function(){e.setState({expanded:!1,bodyHeight:0}),ie.a.trackEvent(Object(nt.a)(e),{id:5037,action:"Fold"})},e.handleClickHeader=function(){e.state.expanded?e.handleCollapse():e.handleExpand()},e.handleCountdownFinish=function(){var t=e.props;(0,t.removeBrandQuestionRedPacket)(t.questionId)},e}return Object(u.a)(n,[{key:"renderCountdown",value:function(){var e=this.props.redPacket,t=e.countDownType,n=e.countDownValue,c="".concat("CommercialAnswerRedPacket","-countdown");return 2===t?Object(i.b)(Gi,{className:c,totalCountdownTime:n,onFinish:this.handleCountdownFinish}):Object(i.c)("div",{className:c,children:["还剩 ",Object(i.b)("span",{children:Object(xe.cnNiceNumber)(n)}),"个红包"]})}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.redPacket,c=n.title,r=n.image,o=n.iconText,a=n.content,s=this.state,l=s.expanded,u=s.bodyHeight;return Object(i.b)(x.a,{view:{id:5035},trackCardShow:!0,children:Object(i.c)("div",{className:re()("CommercialAnswerRedPacket",t,Object(de.a)({},"".concat("CommercialAnswerRedPacket","--expanded"),l)),children:[Object(i.c)("div",{className:"".concat("CommercialAnswerRedPacket","-header"),role:"button",tabIndex:0,onClick:this.handleClickHeader,children:[Object(i.c)("div",{className:"".concat("CommercialAnswerRedPacket","-main"),children:[Object(i.c)("div",{className:"".concat("CommercialAnswerRedPacket","-subtitle"),children:[Object(i.c)("div",{className:"".concat("CommercialAnswerRedPacket","-badge"),children:[Object(i.b)("span",{children:Object(i.b)(Ui,{size:11})}),Object(i.b)("span",{children:o})]}),this.renderCountdown()]}),Object(i.b)("div",{className:"".concat("CommercialAnswerRedPacket","-title"),children:c})]}),Object(i.b)("div",{className:"".concat("CommercialAnswerRedPacket","-image"),children:Object(i.b)("img",{src:Object(Ae.imgUrl)(r,"xl"),alt:""})}),Object(i.b)("div",{className:"".concat("CommercialAnswerRedPacket","-icon"),children:l?Object(i.b)(ee.a,{size:20}):Object(i.b)(Ue.a,{size:20})})]}),Object(i.b)("div",{className:"".concat("CommercialAnswerRedPacket","-body"),style:{height:u},children:Object(i.b)("div",{ref:this.contentRef,className:"".concat("CommercialAnswerRedPacket","-content"),dangerouslySetInnerHTML:{__html:a}})})]})})}}]),n}(p.Component),Zi=Object(O.connect)(null,{removeBrandQuestionRedPacket:B.gb})(Ji),Yi=Object(Q.a)(null)((function(e){var t,n,c,r=e.id,o=e.question,a=e.position,s=void 0===a?"top":a,l=function(e,t,n){var i=Object(O.useSelector)((function(t){var n,i;return null==t||null===(n=t.question)||void 0===n||null===(i=n.questionBanners)||void 0===i?void 0:i[e]})),c=Object(O.useDispatch)();return Object(p.useEffect)((function(){t&&c(Object(B.v)(e))}),[t,c,e]),null==i?void 0:i.filter((function(e){return e.position===n}))}(r,null==o?void 0:o.isBannered,s),u="normal"===o.questionType&&(null==l||null===(t=l[0])||void 0===t||null===(n=t.imagePc)||void 0===n?void 0:n[0]),d=null==l||null===(c=l[0])||void 0===c?void 0:c.verbPc;if(Object(p.useEffect)((function(){u&&ie.a.trackCardShow(null,{id:7707},{button:{text:d}})}),[u,d]),!u)return null;var b=l[0],h=b.targetLinkPc,f=b.entryVerbPc,m=b.imagePc[0].url;return h&&d&&f&&m?Object(i.b)(w.Link,{className:"Card",css:Object.assign({display:"block",fontSize:0,marginBottom:16},"top"===s?{width:654,height:54,borderRadius:4}:{width:296,height:90,borderRadius:"2px 2px 0 0"}),href:h,onClick:function(e){ie.a.trackEvent(e.target,{id:7708,action:"OpenUrl"},{link:{url:h},button:{text:d}})},target:"_blank",children:Object(i.b)(w.Image,{alt:f,src:m,css:{height:"100%",width:"100%",objectFit:"cover"}})}):null}));function $i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var Xi=function(e){Object(d.a)(n,e);var t=$i(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={collapsed:!0,editShown:!1,invitationTipShown:!1,brandQuestionPrizesExpanded:!1},e.getHandleInvite=function(t){t&&(e.handleInvite=t)},e.handleExpand=function(){e.setState({collapsed:!1}),ie.a.trackEvent(null,{id:6783,action:"Click"})},e.handleCollapse=function(){e.setState({collapsed:!0,shareMenuPositionStatus:"normal"})},e.handleEditShow=e.props.authRequired((function(){var t=(e.props.question.reviewInfo||{}).editTips;t?e.props.showNotification(t,"red"):e.setState({editShown:!0})})),e.handleEditClose=function(){e.setState({editShown:!1})},e.handleInvitationShow=function(){e.setState({invitationModalShown:!0})},e.handleInvitationHide=function(){e.setState({invitationModalShown:!1})},e.handleInvitationTipShow=function(){e.setState({invitationTipShown:!0})},e.handleInvitationTipClose=function(){e.setState({invitationTipShown:!1})},e.handleRedirectionCreatorShow=function(){e.setState({redirectionCreatorShown:!0})},e.handleRedirectionCreatorClose=function(){e.setState({redirectionCreatorShown:!1})},e.handleRedirectionCreated=function(t,n){var i=e.props,c=i.router,r=i.question.id,o=t.id;e.handleRedirectionCreatorClose(),n.then((function(){c.push("/question/".concat(o,"?rf=").concat(r))}))},e.handleDelete=function(){var t=e.props,n=t.question.id,i=t.isCommercialQuestion,c=t.deleteQuestion,r=t.deleteBrandQuestion;return i?r(n).then((function(){location.href="/"})):c(n).then((function(){location.href="/"}))},e.handleConfirmDelete=function(){e.handleDeleteModalClose(),e.handleDelete()},e.handleDeleteModalShow=function(){e.setState({deleteModalShown:!0})},e.handleDeleteModalClose=function(){e.setState({deleteModalShown:!1})},e.handlePositionStatusChange=function(t){e.setState({shareMenuPositionStatus:t})},e.handleBrandQuestionPrizesToggle=function(){e.setState({brandQuestionPrizesExpanded:!e.state.brandQuestionPrizesExpanded})},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=(e.isAnswerPage,e.question.id),n=e.isCommercialQuestion,i=e.loadBrand,c=e.loadQuestionCommercialBanner,r=e.loadBrandQuestionRedPacket,o=e.loadBrandQuestionPermission,a=e.loadBrandQuestionOpenStatus,s=e.loadBrandQuestionAdvancedStyle,l=e.loadBrandQuestionPrize,u=e.currentUser;u&&Object(oe.c)("question",t,oe.a),n&&(i(t),c(t),s(t),r(t).then((function(e){e&&e.payload||l(t)})),u&&"guest"!==u.userType&&(o(t),a(t)))}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props,n=t.question.id,i=t.isAnswerPage,c=e.question,r=c.id,o=c.relationship.isAnonymous,a=e.isAnswerPage;!this.state.collapsed&&e.question&&this.props.question&&e.question.detail.length!==this.props.question.detail.length&&this.setState({collapsed:!0,editShown:!1}),n===r&&i===a||this.setState({collapsed:!0,invitationTipShown:!1}),o||this.setState({invitationTipShown:!1})}},{key:"componentDidUpdate",value:function(e,t){var n=this.state.collapsed,i=t.collapsed;if(n&&!i){var c=this.container.getBoundingClientRect().top;window.scrollTo(0,window.pageYOffset+c-document.documentElement.clientHeight)}}},{key:"hasExtraContentUnderAuthor",get:function(){var e=this.props,t=e.question,n=e.isCommercialQuestion,i=e.topicMeta,c=t.relatedCards,r=void 0===c?[]:c,o=t.annotationDetail,a=t.redPacket,s=t.prize;return o||r[0]||a||(null==s?void 0:s.status)||i.urlToken&&!n}},{key:"renderEditModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.permitEditTopics,n=this.props,c=n.question,r=n.brand,o=c.id,a=c.title,s=c.editableDetail,l=c.topics,u=c.questionType,d=c.relationship.isAnonymous,b=this.state.editShown;return Object(i.b)(_e.a,{id:o,title:a,detail:s,topics:l,questionType:u,isAnonymous:d,show:b,onClose:this.handleEditClose,brand:r,permitEditTopics:t})}},{key:"renderFooter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.permitEditQuestion,n=e.permitEditTopics,c=this.props,r=c.question,o=c.isCommercialQuestion,a=c.currentUser,s=this.state.collapsed,l=o&&!0;return Object(i.c)("div",{className:"QuestionHeader-footer",children:[Object(i.b)("div",{className:"QuestionHeader-footer-inner",children:Object(i.c)("div",{className:"QuestionHeader-main QuestionHeader-footer-main",children:[Object(i.b)(gt,{question:r}),l&&Object(i.b)(Dn,{question:r}),Object(i.b)(qn,{question:r,onInvitationTipShow:this.handleInvitationTipShow,getHandleInvite:this.getHandleInvite,editQuestionButton:t&&Object(i.b)(Ze,{onClick:this.handleEditShow,text:"修改问题"})}),Object(i.b)("div",{className:"QuestionHeader-actions",children:!s&&Object(i.c)(X.c,{preset:"plain",onClick:this.handleCollapse,children:["收起 ",Object(i.b)(ee.a,{center:!0})]})})]})}),a&&this.renderEditModal({permitEditTopics:n})]})}},{key:"renderSpecialQuestionAuthor",value:function(){var e=this.props.question.author;return Object(i.c)(p.Fragment,{children:[Object(i.b)(fe,{className:"QuestionHeader-specialQuestionAuthor",author:e}),Object(i.b)("div",{className:"QuestionHeader-topicDivider"})]})}},{key:"render",value:function(){var e=this,t=this.props,n=t.location,c=t.question,r=t.isAnswerPage,o=t.isCommercialQuestion,a=t.isOrgQuestion,s=t.isAuthorCurrentUser,l=t.brand,u=t.publicEditPermission,d=t.topicMeta,b=t.permission.canBrandAdminEdit,h=t.currentUser,p=c.title,f=c.detail,m=c.topics,v=void 0===m?[]:m,O=c.author,g=c.showAuthor,y=c.showEncourageAuthor,w=c.excerpt,C=c.thumbnailInfo,k=c.isEditable,A=c.id,R=c.reviewInfo,S=c.relatedCards,N=void 0===S?[]:S,T=c.annotationDetail,q=c.redPacket,B=c.isVisible,Q=c.relationship.isAuthor,I=this.state,P=I.collapsed,E=I.invitationTipShown,z=I.brandQuestionPrizesExpanded,L=v.map((function(e){return{name:e.name,id:e.id}})),M=u||{},D=M.isQuestionEditable,F=M.isQuestionTopicEditable,H=Object(mt.e)(k,s,D)||b,_=Object(mt.e)(k,s,F)||b,U=this.renderFooter({permitEditQuestion:H,permitEditTopics:_}),V=h&&"guest"!==h.userType;return Object(i.c)("div",{"data-zop-question":JSON.stringify({title:p,topics:L,id:A,isEditable:k}),children:[Object(i.b)(se.a,{children:Object(i.b)(Ut,{question:c,location:n,invitationTipShown:E,onInvitationTipClose:this.handleInvitationTipClose,isAnswerPage:r})}),o&&(!P||!r)&&Object(i.b)(ue.a,{type:c.type,id:c.id}),Object(i.b)(x.a,{module:"QuestionDescription",card:{content:{type:"Question",token:String(A)}},children:Object(i.c)("div",{children:[!1===B&&Q&&Object(i.c)("div",{className:"QuestionReviewing",children:[Object(i.b)("div",{className:"QuestionReviewing-title",children:"内容审核中"}),Object(i.b)("div",{className:"QuestionReviewing-text",children:"内容将在审核通过后自动发布"})]}),Object(i.c)("div",{className:"QuestionHeader",ref:function(t){e.container=t},children:[Object(i.c)("div",{className:"QuestionHeader-content",children:[Object(i.c)("div",{className:"QuestionHeader-main",children:[Object(i.b)(Yi,{id:A,question:c}),Object(i.c)("div",{className:"QuestionHeader-tags",children:[o&&Object(i.b)(Bn,{brand:l}),Object(i.c)("div",{className:"QuestionHeader-topics",children:[Boolean(g&&!(o&&null!=l&&l.name))&&this.renderSpecialQuestionAuthor(),v.map((function(e){return Object(i.b)(He,{item:e},e.id)}))]})]}),Object(i.c)("h1",{className:"QuestionHeader-title",children:[a&&$()(Ki||(Ki=Object(Z.a)(["","提问："])),O.name),p]}),Boolean(!g&&!a&&!o&&y)&&Object(i.b)(Ce,{question:c,isAuthorCurrentUser:s,hasExtraContent:this.hasExtraContentUnderAuthor}),Object(i.b)(le.a,{item:c,annotationProps:T&&{annotationDetail:T}}),N[0]&&Object(i.b)(Gn,{target:N[0]}),q&&Object(i.b)(Zi,{questionId:A,redPacket:q}),Object(i.b)(zn,{question:c,expanded:z,handleToggle:this.handleBrandQuestionPrizesToggle}),Object(i.c)(me.a,{children:[!o&&Object(i.b)(Hi,{data:d}),Object(i.b)(ze,{questionId:A,isInAnswerPage:r})]}),Object(i.b)(et,{html:f,reviewInfo:R,excerpt:w,thumbnailInfo:C,collapsed:P,onExpand:this.handleExpand,onEdit:this.handleEditShow,isVisible:B,isAuthor:Q,hideWatermark:null==l?void 0:l.noWatermark})]}),Object(i.b)("div",{className:"QuestionHeader-side",children:Object(i.b)("div",{className:"QuestionHeader-follow-status",children:Object(i.b)(nn,{question:c})})})]}),P?U:Object(i.b)(te.a,{bottom:!0,container:function(){return e.container},onPositionStatusChange:this.handlePositionStatusChange,children:U}),a&&Object(i.b)($n,{question:c})]})]})}),Object(i.b)(ae.a,{children:Object(i.c)("div",{className:re()("QuestionHeader-content",{isLogin:V}),children:[Object(i.b)("div",{className:"QuestionHeader-main",children:Object(i.b)("h1",{className:"QuestionHeader-title",onClick:function(){Object(ne.scrollTo)(window,{top:0,behavior:"smooth"})},children:p})}),Object(i.b)(j.b,{block:"Toolbar",children:Object(i.b)(x.a,{module:"ToolBar",card:{content:{type:"Question",token:String(A)}},children:Object(i.b)("div",{className:"QuestionHeader-side",children:Object(i.b)(gt,{question:c,inTopBar:!0})})})}),Object(i.b)("div",{className:"QuestionHeader-profile",children:Object(i.b)(ve.a,{currentUser:h})})]})})]})}}]),n}(p.PureComponent);Xi.propTypes={question:v.a.object,location:v.a.object,isAnswerPage:v.a.bool};var ec=Object(g.compose)(c.withRouter,R.a,Object(O.connect)((function(e,t){var n=e.question.brand,i=e.publicEditPermission,c=e.currentUser,r=t.question,o=r.questionType,a=r.author;return{brand:n,publicEditPermission:i,currentUserUrlToken:c,permission:Object(B.cb)(e),isCommercialQuestion:"commercial"===o,isOrgQuestion:"org"===o,isAuthorCurrentUser:Object(L.i)(e,a)}}),{loadBrand:B.I,updateQuestionLocked:B.rb,deleteQuestion:B.l,deleteBrandQuestion:B.i,showNotification:F.h,loadQuestionCommercialBanner:B.U,loadBrandQuestionRedPacket:B.O,loadBrandQuestionPermission:B.M,loadBrandQuestionOpenStatus:B.L,loadBrandQuestionAdvancedStyle:B.J,loadBrandQuestionPrize:B.N}))(Xi),tc=n(1295),nc=n(1653);function ic(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}function cc(e){var t=e.toString();return 1===t.length?"0".concat(t):t}var rc=function(e){var t=Object(A.parseInputTime)(e);return t?"".concat(t.getFullYear(),"-").concat(cc(t.getMonth()+1),"-").concat(cc(t.getDate()),"T").concat(cc(t.getHours()),":").concat(cc(t.getMinutes()),":").concat(cc(t.getSeconds())):""};function oc(){var e=document.querySelector("#js-answerAddCard .Editable-content");e?e.scrollIntoView({block:"end"}):window.scrollTo(0,0)}var ac=function(e){Object(d.a)(n,e);var t=ic(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={anonymousConfirmShown:!1,answering:!1,hideIsMutedCover:!1,signFlowModalShown:!1},e.editableStatscReporter=Object(tc.c)("AnswerPage"),e.getPublicEditPermission=function(){var t=e.props,n=t.question,i=t.currentUserUrlToken,c=t.getPublicEditPermission,r=k()(n,"author.urlToken","");k()(n,"isEditable",!1)&&i&&r!==i&&c()},e.handleToggleAnonymous=function(){var t=e.props,n=t.showNotification,i=t.reward.question,c=void 0===i?{}:i,r=t.id;r&&c[r]&&c[r].isRewardable?n("已开启赞赏的回答无法设为匿名，请先关闭赞赏","red"):e.setState({anonymousConfirmShown:!e.state.anonymousConfirmShown})},e.startAddAnswer=function(){var t=e.props,n=t.params.answerId,i=t.location.query.group_id,c=t.router;n||i?(c.push("/question/".concat(e.props.id)),setTimeout(e.focusAddAnswer)):e.focusAddAnswer()},e.endAddAnswer=function(){e.setState({answering:!1})},e.focusAddAnswer=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];oc(),e.setState({answering:Date.now()},(function(){t&&setTimeout((function(){oc()}))}))},e}return Object(u.a)(n,[{key:"getChildContext",value:function(){return{toggleAnonymous:this.handleToggleAnonymous,startAddAnswer:this.startAddAnswer,endAddAnswer:this.endAddAnswer}}},{key:"componentDidMount",value:function(){var e=this;Object(tc.d)();var t,n=this.props,i=n.question,c=n.answer,r=n.draft,o=n.currentUser,l=n.params,u=n.attachedArticleId,d=n.loadAttachedArticleToDraft,b=n.location;(!(t=null==c?void 0:c.updatedTime)||Date.now()-1e3*t>6e4)&&Object(z.loadScript)("https://zz.bdstatic.com/linksubmit/push.js",{crossOrigin:void 0}),function(){var t=Object(s.a)(a.a.mark((function t(){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=Object(mt.f)(b),t.prev=1,!i){t.next=7;break}return t.next=5,e.fetchDraft();case 5:t.next=9;break;case 7:return t.next=9,e.fetchQuestionAndDraft();case 9:if(!e.props.params.answerId){t.next=11;break}return t.abrupt("return");case 11:if(!u){t.next=14;break}return t.next=14,d(l.id,u);case 14:(r&&!r.schedule||!r&&n||u)&&e.focusAddAnswer(n||u),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(1),console.log(t.t0);case 20:case"end":return t.stop()}}),t,null,[[1,17]])})));return function(){return t.apply(this,arguments)}}()(),this.getPublicEditPermission(),o&&"guest"!==o.userType||this.setState({signFlowModalShown:!0})}},{key:"componentDidUpdate",value:function(e){this.props.params.id!==e.params.id&&this.fetchQuestionAndDraft()}},{key:"componentWillUnmount",value:function(){this.subscription&&this.subscription.unsubscribe(),this.scrollSubscription&&this.scrollSubscription.unsubscribe()}},{key:"fetchQuestionAndDraft",value:function(){var e=this.props,t=e.id,n=e.loadQuestion;return Promise.all([n(t),this.fetchDraft()])}},{key:"fetchDraft",value:function(){var e,t=this.props,n=t.loadDraft;return t.currentUser&&(e=n(this.props.params.id)),this.setState({anonymousConfirmShown:!1}),e}},{key:"renderMeta",value:function(){var e=this.props.question,t=Object(mt.d)(e);return Object.keys(t).map((function(e){return Object(i.b)("meta",{itemProp:e,content:t[e]},e)}))}},{key:"renderJSONLD",value:function(){var e=this.props,t=e.location,n=e.question,c=e.answer,o=e.params.answerId,a=e.ua;if(!/baiduspider/i.test(a.origin))return null;var s=Boolean(o),l=s?c:n;if(l){var u=s?[l.createdTime,l.updatedTime]:[l.created,l.updatedTime],d=Object(r.a)(u,2),b=d[0],h=d[1],p=rc(b),f=rc(h);return Object(i.b)("script",{type:"application/ld+json",children:'\n        {\n          "@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",\n          "@id": "https://www.zhihu.com'.concat(t.pathname,'",\n          "appid": "否",\n          "pubDate": "').concat(p,'",\n          "upDate": "').concat(f,'"\n        }')})}}},{key:"handleSignFlowModalClose",value:function(){this.setState({signFlowModalShown:!1})}},{key:"render",value:function(){var e,t=this,n=this.props,c=n.location,r=n.params,o=n.children,a=n.question,s=n.router.location.query,l=n.topicMeta,u=n.answer,d=n.firstAnswer,b=Boolean(r.answerId);if(!a)return Object(i.b)("div",{});if("true"===s.answer_deleted_redirect)return Object(i.b)(J,{id:a.id});var h=a.questionType,f=a.isMuted,m=a.title,v=a.relationship,O=v.isAuthor,g=v.myAnswer,C=a.visibleOnlyToAuthor;if(!b&&!O&&C||b&&null!=u&&u.visibleOnlyToAuthor&&(null==u||null===(e=u.relationship)||void 0===e||!e.isAuthor))return Object(i.b)(q,{});var k=this.state,A=k.anonymousConfirmShown,R=k.answering,S=k.hideIsMutedCover,N=k.signFlowModalShown,T=b?u:a;return Object(i.b)(j.b,{content:{type:"Question",token:String(null==a?void 0:a.id)},children:Object(i.b)(j.e,{zaType:"Card",children:Object(i.b)(x.a,{module:"QuestionItem",card:{content:{type:"Question",token:String(a.id)}},children:Object(i.b)(U,{isQAPage:!b,children:Object(i.c)("div",{className:"QuestionPage",itemScope:!0,itemProp:"mainEntity",itemType:"http://schema.org/Question",children:[T&&Object(i.b)(P,{entity:T}),N&&Object(i.b)(H.b,{showQrcodeFirst:!0,titlePart:Object(i.b)(nc.a,{title:"登录知乎，问答干货一键收藏"}),maskClosable:!1,defaultType:"login",onClose:function(){t.handleSignFlowModalClose()}}),Object(i.b)(y.a,Object.assign({title:m},!b&&{meta:Object(E.c)(a,d)})),this.renderMeta(),this.renderJSONLD(),"commercial"===h&&f&&!S&&O&&Object(i.b)("div",{className:"QuestionPage-commercialIsMutedCover",onClick:function(){t.setState({hideIsMutedCover:!0})}}),C&&O&&!b&&Object(i.b)("div",{className:"QuestionPage-visibleYourself",children:"仅自己可见"}),Object(i.b)(ec,{topicMeta:l,question:a,location:c,isAnswerPage:b}),Object(i.b)(w.Box,{id:"AnswerFormPortalContainer",bg:"GBK10C",mt:"10px",mx:"auto",css:{width:"1000px"}}),Object(i.b)(tc.b.Provider,{value:this.editableStatscReporter,children:Object(p.cloneElement)(p.Children.only(o),{question:a,answering:R})}),Object(i.b)(_.a,{question:a,myAnswer:g,shown:A,onClose:this.handleToggleAnonymous})]})})})})})}}]),n}(p.PureComponent);ac.fetchData=function(e){var t=e.dispatch,n=e.getState,i=e.params,c=i.id,r=i.answerId;return n().env.userAgent.isBot?Promise.all([t(Object(B.ab)(c,r)),t(Object(B.bb)(c)),t(Object(B.T)(c))]):t(Object(B.T)(c))},ac.childContextTypes={toggleAnonymous:v.a.func,startAddAnswer:v.a.func,endAddAnswer:v.a.func};var sc=Object(g.compose)(c.withRouter,R.a,Object(O.connect)((function(e,t){var n=t.params,i=n.id,c=n.answerId,r=t.location.query,o=e.question.topicMeta,a=e.entities.drafts,s=void 0===a?{}:a,l=e.env,u=l.referer,d=l.userAgent,b=e.reward,h=void 0===b?{}:b,p=e.currentUser,f=Boolean(c);return Object.assign({id:i,topicMeta:o[i]||{},question:Object(B.eb)(e,{id:i}),attachedArticleId:r.attach_to_article,reward:h,draft:s["question_".concat(i)],referer:u,ua:d,currentUserUrlToken:p,currentUser:Object(L.b)(e)},f?{answer:Object(D.c)(e,{id:c})}:{firstAnswer:Object(D.i)(e,{id:i})})}),{loadQuestion:B.T,loadDraft:B.Q,loadAttachedArticleToDraft:B.F,showNotification:F.h,getPublicEditPermission:M.b}))(ac),lc=n(912),uc=n(432),dc=n(1146),bc=n(1197),hc=function(e){var t,n,c,o=e.question,a=o.id,s=o.title,l=o.person,u=e.headerInfo,d=e.enableIgnore,b=e.extraFooterInfo,h=e.button,f=e.handleIgnoreQuestion,m=void 0===f?ui.a:f,v="https://www.zhihu.com/question/".concat(a),O=Object(j.i)().trackEvent,g=Object(p.useState)(!1),y=Object(r.a)(g,2),C=y[0],k=y[1];return Object(i.b)(j.b,{content:{type:"Question",token:String(a)},children:Object(i.c)(j.e,{zaType:"Card",as:w.Flex,zaText:s,justifyContent:"space-between",alignItems:"center",css:function(e){return{padding:"22px 0px",borderBottom:"1px solid ".concat(e.colors.GBK09A),position:"relative"}},onMouseEnter:function(){k(!0)},onMouseLeave:function(){k(!1)},children:[Object(i.c)(w.Box,{css:{flex:"1"},children:[Object(i.c)(w.Flex,{mb:12,color:"GBL05A",alignItems:"center",css:{fontSize:"15px"},children:[Object(i.b)("img",{alt:"",css:{width:"20px",height:"20px",borderRadius:"50%",marginRight:"8px"},src:null==u||null===(t=u.avatar)||void 0===t?void 0:t.url}),Boolean(l||(null==u||null===(n=u.avatar)||void 0===n?void 0:n.people))&&Object(i.c)(w.Flex,{alignItems:"center",css:function(e){return{color:e.colors.GBK03A,marginRight:"6px",fontSize:"14px",fontWeight:"16px"}},children:[Object(i.c)(w.Flex,{alignItems:"center",css:function(e){return{color:e.colors.GBK03A}},children:[l||(null==u||null===(c=u.avatar)||void 0===c?void 0:c.people),null!=u&&u.labels?Object(i.b)(w.Flex,{css:function(e){return{marginBottom:"3px",padding:"1px 2px",marginLeft:"4px",marginRight:"8px",color:e.colors.GBL01A,fontSize:"12px",border:"1px solid ".concat(e.colorMod(e.colors.GBL01A).alpha(.2)),borderRadius:"2px"}},children:null==u?void 0:u.labels}):null," ","邀请你回答"===(null==u?void 0:u.invite)?"":"的提问"]}),Object(i.b)(w.Flex,{css:function(e){return{color:e.colors.GBK06A,marginLeft:"6px",lineHeight:"21px"}},children:null==u?void 0:u.createdTime}),Object(i.b)(w.Flex,{css:function(e){return{color:e.colors.GBK06A,marginLeft:"6px"}},children:null==u?void 0:u.invite})]}),d&&C&&Object(i.b)(X.c,{css:{position:"absolute",top:"12px",right:"0"},className:"QuestionItem-ignoreButton",preset:"plain","data-tooltip":"不感兴趣","aria-label":"不感兴趣","data-tooltip-preset":"white","data-tooltip-classname":"QuestionItem-ignoreButtonTooltip",color:"GBL07A",icon:Pt.a,onClick:function(){m(a),O({eventType:"Click",elementLocation:{type:"Button",text:"不感兴趣",content:{type:"Question",token:String(a)}}})}})]}),Object(i.b)(bc.b,{item:{question:{url:v,title:s}}}),Object(i.b)(w.Flex,{css:function(e){return{color:e.colors.GBK06A,fontSize:"14px"}},children:b})]}),h||Object(i.b)(at.a,{css:function(e){return{width:"96px",height:"28px",lineHeight:"26px",borderRadius:"3px",color:e.colors.GBK99B,padding:0,border:"1px solid ".concat(e.colors.GBL01A),backgroundColor:e.colors.GBL01A,boxSizing:"border-box"}},icon:Ke.a,label:"写回答",href:"".concat(v,"?write"),target:"_blank",onClick:function(){O({action:"OpenUrl",eventType:"Click",elementLocation:{type:"Button",text:"写回答",content:{type:"Question",token:String(a)}}},{link:{url:"".concat(v,"?write")}})}})]})})};var pc=function(e){var t=e.type,n=e.index,r=e.onClick,o=e.enablingTypeName,a=e.totals,s=t.name,l=t.text,u=t.queryName,d=t.icon,b=s===o;return Object(i.c)(c.Link,{className:re()("QuestionType","QuestionWaiting-type",{"QuestionType--active":b}),role:"tab","aria-selected":b,"aria-setsize":a,"aria-posinset":n+1,to:u?"/question/waiting?type=".concat(u):"/question/waiting","data-za-detail-view-id":5362,"data-za-extra":JSON.stringify({button:{text:l}}),onClick:r,children:[Object(i.b)(d,{className:"QuestionType-icon",size:18}),l]})},fc=n(630);var mc=Object(c.withRouter)(Object(O.connect)((function(e,t){var n=t.location.query.type;return{allWaitingQuestions:e.question.waitingQuestions,defaultType:fc.b.find((function(e){return e.queryName===n}))||fc.b[0]}}),{getWaitingQuestions:B.z,getWaitingInvitedQuestions:B.y,deleteWaitingQuestion:B.m,ignoreToolsQuestionInvite:B.B})((function(e){var t=e.allWaitingQuestions,n=e.defaultType,c=e.getWaitingQuestions,o=e.getWaitingInvitedQuestions,a=e.deleteWaitingQuestion,s=e.ignoreToolsQuestionInvite,l=Object(p.useRef)(null),u=Object(p.useState)(n.name),d=Object(r.a)(u,2),b=d[0],h=d[1],f=Object(p.useState)(fc.b.reduce((function(e,t){var n=t.name;return Object.assign(Object.assign({},e),{},Object(de.a)({},n,0))}),{})),m=Object(r.a)(f,2),v=m[0],O=m[1],j=t[b].paging,g=function(){return o(null!=j&&j.next?j.next:"notifications/v3/timeline/entry/invite?invite_with_time_slice=1&limit=20&offset=0")},w=Object(p.useState)(new Set),C=Object(r.a)(w,2),k=C[0],x=C[1],A=t[b],R=A.isEnd,S=A.isLoading,N=A.questions.filter((function(e){var t=Object(fc.a)(e,b).question,n=t.ignoreId,i=t.id;return!k.has(n||i)}));return Object(i.c)("div",{className:"QuestionWaiting",children:[Object(i.b)(y.a,{title:"等你来答"}),Object(i.c)(lc.d,{role:"region","aria-label":"问题列表",className:"QuestionWaiting-mainColumn",children:[Object(i.b)(te.a,{offset:62,children:function(e){var n=e.isFixed;return Object(i.c)("div",{className:re()("QuestionWaiting-typesContainer",{"QuestionWaiting-typesContainer--fixed":n}),children:[n&&Object(i.b)("div",{className:"QuestionWaiting-typesTopper"}),Object(i.b)("div",{role:"tablist","aria-label":"问题分类",className:re()("QuestionWaiting-types",{"QuestionWaiting-types--fixed":n}),children:fc.b.map((function(e,n){return Object(i.b)(pc,{totals:fc.b.length,type:e,index:n,enablingTypeName:b,onClick:function(){return function(e){O(Object.assign(Object.assign({},v),{},Object(de.a)({},b,window.pageYOffset)));var n=e.name,i=e.request,r=i.endpoint,o=i.query;t[e.name].questions.length||("invite"!==e?c({type:n,endpoint:r,query:o}):g()),h(n),window.scrollTo(0,v[n])}(e)}},e.name)}))})]})}}),Object(i.b)(uc.b,{ref:l,className:"QuestionWaiting-questions",onLoad:function(){"invite"===b?g():c({type:b,endpoint:n.request.endpoint,query:n.request.query,offset:N.length})},isLoading:S,placeholder:Object(i.b)(uc.a,{className:"QuestionWaiting-placeholder"}),isDrained:R,children:N.map((function(e){var t,n=Object(fc.a)(e,b),c=n.question,r=n.headerInfo,o=n.extraFooter,u=n.showTime,d=n.button,h=n.titleLink;return Object(i.b)(hc,{className:"QuestionWaiting-questionItem",question:c,headerInfo:r,extraFooterInfo:o,showTime:u,enableIgnore:!0,handleIgnoreQuestion:(t=c.ignoreId||c.id,function(){x(new Set(k).add(t)),"invite"===b?s(t):a(t),l.current.maybeRun()}),button:d,titleLink:h},e.id)}))})]}),Object(i.b)(dc.a,{omit:{noBanner:!0,noCategory:!0}})]})}))),vc=n(12),Oc=Object.assign;function jc(e){return f.a.createElement(vc.a,Oc(Oc({width:"24",height:"24",viewBox:"0 0 24 24","data-new-api":"TimeArrow24","data-old-api":"Later"},e),{className:"Zi Zi--Later"+(e.className?" ".concat(e.className):"")}),f.a.createElement("path",{d:"M19.537 9.269C18.414 6.34 15.532 4.25 12.146 4.25 7.773 4.25 4.25 7.732 4.25 12s3.523 7.75 7.896 7.75c3.663 0 6.734-2.446 7.63-5.75a.75.75 0 011.448.393c-1.073 3.956-4.736 6.857-9.078 6.857-5.177 0-9.396-4.13-9.396-9.25s4.219-9.25 9.396-9.25a9.433 9.433 0 017.394 3.543V5.5a.75.75 0 011.5 0V9a.75.75 0 01-.773.75.75.75 0 01-.73-.481z",fillRule:"evenodd",clipRule:"evenodd"}),f.a.createElement("path",{d:"M14.437 14.622a.75.75 0 10.86-1.229L12.75 11.61V8.5a.75.75 0 00-1.5 0V12c0 .26.119.48.32.614l2.867 2.008z"}))}var gc=n(875);var yc=function(e){var t=e.className,n=e.titleClassName,c=e.sourceClassName,o=e.hideButtonClassName,a=e.question,s=a.id,l=a.title,u=a.detail,d=a.excerpt,b=a.isDeleted,h=e.mainSource,f=e.subSource,m=e.mainTool,v=e.subTool,O=e.zaId,j=void 0===O?{}:O,g=e.onMouseEnter,y=void 0===g?ui.a:g,w=e.onMouseLeave,C=void 0===w?ui.a:w,k=e.onExpand,A=void 0===k?ui.a:k,R=e.onCollapse,S=void 0===R?ui.a:R,N="https://www.zhihu.com/question/".concat(s),T=Object(p.useState)(!0),q=Object(r.a)(T,2),B=q[0],Q=q[1],I=Object(p.useCallback)((function(e){Q(!0),S(e),ie.a.trackEvent(e.target,{id:j.collapse,action:"Collapse"})}),[Q,S,j]),P=Object(p.useCallback)((function(e){Q(!1),A(e),ie.a.trackEvent(e.target,{id:j.expand,action:"Expand"})}),[Q,A,j]);return b?Object(i.c)("div",{className:re()("ListQuestionItem","ListQuestionItem--deleted",t),children:[Object(i.b)("div",{className:"ListQuestionItem-hint",children:"该问题已被删除"}),Object(i.b)("div",{className:"ListQuestionItem-mainTool",children:m})]}):Object(i.b)(x.a,{module:"QuestionItem",card:{content:{type:"Question",token:String(s)}},trackCardShow:Boolean(j.cardShow),view:{id:j.cardShow},children:Object(i.c)("div",{className:re()("ListQuestionItem",t),onMouseEnter:y,onMouseLeave:C,children:[(h||f)&&Object(i.c)("div",{className:re()("ListQuestionItem-source",c),children:[h&&Object(i.b)("div",{className:"ListQuestionItem-mainSource",children:h}),f&&Object(i.b)("div",{className:"ListQuestionItem-subSource",children:f})]}),Object(i.b)("a",{className:re()("ListQuestionItem-title",n,{"ListQuestionItem-title--noDetail":!u}),href:N,target:"_blank",rel:"noopener noreferrer","data-za-detail-view-id":j.titleClick,children:l}),u&&Object(i.b)(et,{className:"ListQuestionItem-RichText",html:u,reviewInfo:{},excerpt:d,collapsed:B,onExpand:P,editable:!1}),Object(i.c)("div",{className:"ListQuestionItem-tool",children:[Object(i.c)("div",{className:"ListQuestionItem-mainTool",children:[Object(i.b)(at.a,{className:"ListQuestionItem-writeAnswerButton",color:"blue",icon:Ke.a,label:"写回答",href:"".concat(N,"?write"),target:"_blank","data-za-not-track-link":!0,onClick:function(e){ie.a.trackEvent(e.target,{id:j.writeAnswer,action:"Answer"})}}),m]}),(v||!v&&!B)&&Object(i.c)("div",{className:"ListQuestionItem-subTool",children:[v,!B&&Object(i.c)("div",{className:re()("ListQuestionItem-hideButton",o),role:"button",tabIndex:0,onClick:I,children:["收起",Object(i.b)(ee.a,{className:"ToolsQuestionItem-hideButtonIcon",center:!0})]})]})]})]})})},wc=n(2254),Cc=n.n(wc);function kc(e){var t=e.laterQuestions,n=e.getLaterQuestions,o=e.updateLaterQuestion,a=Object(p.useRef)(null),s=Object(p.useState)(new Set),l=Object(r.a)(s,2),u=l[0],d=l[1],b=t.count,h=t.isEnd,f=t.isLoading,m=t.questions.filter((function(e){return!u.has(e.id)}));return Object(i.c)("div",{className:"QuestionLater",children:[Object(i.c)(lc.d,{className:"QuestionLater-mainColumn",children:[Object(i.c)("div",{className:"QuestionLater-title",children:[Object(i.b)(jc,{className:"QuestionLater-titleIcon",size:30}),"我的稍后答",Boolean(b)&&Object(i.b)("div",{className:"QuestionLater-titleNumber",children:b})]}),!f&&0===m.length&&Object(i.c)("div",{className:"QuestionLater-empty",children:[Object(i.b)("img",{className:"QuestionLater-emptyImage",src:Cc.a,alt:""}),Object(i.c)("div",{className:"QuestionLater-emptyText",children:["还没有稍后答，",Object(i.b)(c.Link,{className:"QuestionLater-emptyLink",to:"/question/waiting",children:"看看为你推荐的问题"})]})]}),Object(i.b)(uc.b,{ref:a,className:"QuestionLater-questions",onLoad:function(){return n(20,m.length)},isLoading:f,placeholder:Object(i.b)(uc.a,{className:"QuestionLater-placeholder"}),isDrained:h,children:m.map((function(e){return Object(i.b)(yc,{className:"QuestionLater-questionItem",question:e,zaId:{titleClick:5372,expand:5373,cardShow:5375,writeAnswer:5374},mainTool:Object(i.c)(p.Fragment,{children:[Object(i.c)(X.c,{className:re()("QuestionLater-deletingButton"),preset:"outline",color:"grey",onClick:function(t){d(new Set(u).add(e.id)),o(e.id,!1),a.current.maybeRun(),ie.a.trackEvent(t.target,{id:5376,action:"Delete"})},children:[Object(i.b)(gc.a,{size:22}),"移除"]}),!e.isDeleted&&Object(i.c)("div",{className:"QuestionLater-info",children:[Object(xe.formatNumber)(e.answerCount)," 个回答"," · ",Object(xe.formatNumber)(e.visitCount)," 个浏览"]})]})},e.id)}))})]}),Object(i.b)(dc.a,{omit:{noWrite:!0,noCreator:!0,noBanner:!0,noCategory:!0}})]})}kc.fetchData=function(e){return(0,e.dispatch)(Object(B.u)())};var xc=Object(O.connect)((function(e){return{laterQuestions:e.question.laterQuestions}}),{getLaterQuestions:B.t,updateLaterQuestion:B.nb})(kc),Ac=n(1327);var Rc=function(e){var t=e.users,n=void 0===t?[]:t;return 0===n.length?null:1===n.length?Object(i.b)(Mt.a,{user:n[0]}):2===n.length?Object(i.c)(p.Fragment,{children:[Object(i.b)(Mt.a,{user:n[0]})," 和 ",Object(i.b)(Mt.a,{user:n[1]})]}):3===n.length?Object(i.c)(p.Fragment,{children:[Object(i.b)(Mt.a,{user:n[0]}),"、",Object(i.b)(Mt.a,{user:n[1]})," 和"," ",Object(i.b)(Mt.a,{user:n[2]})]}):n.length>3?Object(i.c)(p.Fragment,{children:[Object(i.b)(Mt.a,{user:n[0]}),"、",Object(i.b)(Mt.a,{user:n[1]})," 和"," ",Object(i.b)(Mt.a,{user:n[2]})," 等 ",n.length," 人"]}):null};var Sc=function(e){var t=e.user,n=t.isFollowed,c=t.isFollowing,r=t.gender,o=null;return n&&c?o="互相关注":c&&(o="你关注了".concat(function(e){return 0===e?"她":1===e?"他":"TA"}(r))),o?Object(i.b)("div",{className:"RelationLabel",children:o}):null},Nc=n(421),Tc=Nc.a[0];function qc(e){var t=e.allInvitedQuestions,n=e.getInvitedQuestions,c=e.ignoreInvitedQuestion,o=e.updateLaterQuestion,a=Object(p.useRef)(null),s=Object(p.useState)(Tc),l=Object(r.a)(s,2),u=l[0],d=l[1],b=Object(p.useState)(new Set),h=Object(r.a)(b,2),f=h[0],m=h[1],v=Object(p.useState)(new Set),O=Object(r.a)(v,2),j=O[0],g=O[1],y=Object(p.useState)(Nc.a.reduce((function(e,t){var n=t.name;return Object.assign(Object.assign({},e),{},Object(de.a)({},n,0))}),{})),w=Object(r.a)(y,2),C=w[0],k=w[1],x=t[u.name],A=x.isEnd,R=x.isLoading,S=x.questions.filter((function(e){var t=e.question;return!f.has(t.id)}));return Object(i.c)("div",{className:"QuestionInvited",children:[Object(i.c)(lc.d,{className:"QuestionInvited-mainColumn",children:[Object(i.c)("div",{className:"QuestionInvited-title",children:["邀请回答",Boolean(t.total.count)&&Object(i.b)("div",{className:"QuestionInvited-titleNumber",children:t.total.count-C.total})]}),Object(i.b)("div",{className:"QuestionInvited-tabs",children:Nc.a.map((function(e){return Object(i.c)("div",{className:re()("QuestionInvited-tab",{"QuestionInvited-tab--active":e.name===u.name}),role:"button",tabIndex:0,onClick:function(){return function(e){t[e.name].questions.length||n(e,20,0),ie.a.trackEvent(null,{id:5377},{button:{text:e.text}}),d(e)}(e)},children:[Object(i.b)("div",{className:"QuestionInvited-tabTitle",children:e.text}),Object(i.b)("div",{className:"QuestionInvited-tabMeta",children:t[e.name].count-C[e.name]})]},e.name)}))}),Object(i.b)(uc.b,{ref:a,className:"QuestionInvited-questions",onLoad:function(){return n(u,20,S.length)},isLoading:R,placeholder:Object(i.b)(uc.a,{className:"QuestionInvited-placeholder"}),isDrained:A,children:S.map((function(e){var t=e.inviters,n=e.question;return Object(i.b)(yc,{className:"QuestionInvited-questionItem",question:n,zaId:{titleClick:5378,expand:5379,cardShow:5380,writeAnswer:5381},mainSource:Object(i.c)("div",{className:"QuestionInvited-questionItemMainSource",children:[Object(i.b)(Rc,{users:t})," 邀请你回答"]}),subSource:1===t.length&&Object(i.b)(Sc,{user:t[0]}),mainTool:Object(i.c)(p.Fragment,{children:[Object(i.c)(X.c,{className:re()("QuestionInvited-deletingButton"),preset:"outline",color:"grey",onClick:function(e){m(new Set(f).add(n.id)),k(Object.assign(Object.assign({},C),{},Object(de.a)({total:C.total+1},u.name,C[u.name]+1))),c(n.id),a.current.maybeRun(),ie.a.trackEvent(e.target,{id:5382,action:"Ignore"})},children:[Object(i.b)(Ac.a,{size:18}),"忽略"]}),Object(i.c)(X.c,{className:re()("QuestionInvited-laterButton",{"QuestionInvited-laterButton--active":j.has(n.id)}),preset:"outline",color:"grey",onClick:function(e){var t=!j.has(n.id),i=new Set(j);t?i.add(n.id):i.delete(n.id),g(i),o(n.id,t),ie.a.trackEvent(e.target,{id:5383,action:t?"Add":"UnAdd"})},children:[j.has(n.id)?null:Object(i.b)(jc,{}),j.has(n.id)?"已添加":"稍后答"]}),Object(i.c)("div",{className:"QuestionInvited-info",children:[Object(xe.formatNumber)(n.answerCount)," 个回答"," · ",Object(xe.formatNumber)(n.visitCount)," 个浏览"]})]})},n.id)}))})]}),Object(i.b)(dc.a,{omit:{noWrite:!0,noCreator:!0,noBanner:!0,noCategory:!0}})]})}qc.fetchData=function(e){return(0,e.dispatch)(Object(B.s)())};var Bc=Object(O.connect)((function(e){return{allInvitedQuestions:e.question.invitedQuestions}}),{getInvitedQuestions:B.r,ignoreInvitedQuestion:B.A,updateLaterQuestion:B.nb})(qc),Qc=n(893),Ic=n(488),Pc=n(2139),Ec=n(2140),zc=n(234),Lc=n(87),Mc=n(62);var Dc=n(2219),Fc=n(2218),Hc=n(433);function _c(e){if(!Object(Ic.a)(e))return"";var t="";return Object(Pc.a)(e)?t+="今天":Object(Ec.a)(e)?t+="昨天":t+=Object(zc.a)(e,"yyyy/MM/dd"),0!==function(e){Object(Mc.a)(1,arguments);var t=Object(Lc.a)(e),n=t.getSeconds();return n}(e)?t+=" "+Object(zc.a)(e,"HH:mm:ss"):0!==Object(Dc.a)(e)?t+=" "+Object(zc.a)(e,"HH:mm"):0!==Object(Fc.a)(e)&&(t+=" "+Object(Fc.a)(e)+"点"),t}var Uc=function(e){var t=e.event,n=e.status,c=t.isOnline,r=t.events;if(!c&&0===n)return null;var o=Object(hi.f)(),a=o.colors,s=a.GBL05A,l=a.GBK09A,u=a.GBK99A,d=a.GBL01A,b=o.fontWeights;return Object(i.b)(w.Box,{pt:"16px",css:Object.assign(Object.assign({},Object(hi.c)({borderTop:"1px solid ".concat(l)})),{},{"&::after":{content:"''",display:"block",position:"absolute",width:"2px",height:"calc(100% - 30px - 52px)",backgroundColor:s,opacity:.12,left:"24px",top:"30px"}}),children:r.map((function(e,t){var c=e.content,r=e.created,o=e.url,a=0===t;return 1===n&&t>2?null:Object(i.c)(Hc.b,{zaBlock:"EventItem",target:"_blank","data-za-detail-view-id":6621,href:o,pl:"40px",css:{paddingLeft:"40px",paddingRight:"16px",position:"relative",display:"block",paddingBottom:"16px","&::after":Object.assign({content:"''",zIndex:1,display:"block",position:"absolute",left:"25px",top:"0.5em",transform:"translateX(-50%)",boxShadow:"0px 0px 0px 2px ".concat(u),borderRadius:"50%",width:"6px",height:"6px",background:s},a&&{background:d,border:"2px solid ".concat(u),boxShadow:"0 0 0 1px ".concat(d)})},children:[Object(i.b)(w.Text,{css:Object.assign({color:s},a&&{color:d,fontWeight:b.bold}),children:_c(1e3*r)}),Object(i.c)(w.Flex,{flexDirection:"row",alignItems:"center",mt:"6px",color:"GBK02A",css:Object.assign({},a&&{fontWeight:b.bold}),children:[Object(i.b)(w.Text,{flex:"0 1 auto",css:Object(hi.d)(1),children:c}),Object(i.b)(pi.a,{text:!0,css:{color:s,flex:"0 0 auto"}})]})]},r+o)}))})},Vc=function(e){var t=e.slice(0,2).map((function(e){return e.content})).join("、");return t.length<=16?t:e[0]&&e[0].content},Gc=function(e){var t=e.event,n=e.status,c=e.onClick,r=t.url,o=!r,a=null,s=Ue.a,l=6623;return 0===n?a="显示全部":1==n?(a=o?"展开全部进展":"查看全部进展",l=o?6623:6622,s=o?Ue.a:pi.a):2==n&&(a="收起",s=ee.a),Object(i.c)(Se.a,{zaAction:r?"OpenUrl":null,zaBlock:"ViewAll","data-za-detail-view-id":l,target:"_blank",flex:"0 0 auto",ml:"8px",color:"GBL05A",css:{display:"flex",flexDirection:"row",alignItems:"center",cursor:"pointer"},onClick:function(e){r||(e.preventDefault(),c(!1))},href:r,children:[a,Object(i.b)(s,{})]})},Wc=function(e){var t=e.event,n=e.status,c=e.onChangeStatus,r=e.getContainer,o=t.isOnline,a=t.url,s=t.events;if(o&&s.length<=3&&!a)return null;var l=Object(p.useRef)(),u=Object(ai.d)((function(){0===n||1===n?c(2):2===n&&c(o?1:0),setTimeout((function(){var e;return null===(e=l.current)||void 0===e?void 0:e.check()}))}));return Object(i.b)(te.a,{ref:l,bottom:!0,container:r,children:Object(i.c)(w.Flex,{flexDirection:"row",alignItems:"center",justifyContent:o||2===n?"flex-end":"flex-start",bg:"GBK99B",pl:"20px",pr:"13px",height:"48px",css:function(e){return Object(hi.c)({borderTop:"1px solid ".concat(e.colors.GBK09A)})},children:[!o&&2!==n&&Object(i.c)(w.Text,{children:[Vc(s),"等 ",s.length," 个事件进展"]}),Object(i.b)(Gc,{event:t,status:n,onClick:u})]})})},Kc=function(e){var t=e.event,n=t.isOnline,c=t.url,o=Object(p.useRef)(null),a=Object(p.useState)((function(){return c||n?1:0})),s=Object(r.a)(a,2),l=s[0],u=s[1];return Object(i.c)("div",{ref:o,children:[Object(i.b)(Uc,{event:t,status:l}),Object(i.b)(Wc,{event:t,status:l,onChangeStatus:u,getContainer:function(){return o.current}})]})},Jc={special_event:"事件讨论",timeline_event:"最新进展"};var Zc=function(e){var t,n=e.question;if(null===(t=n.event)||void 0===t||!t.events)return null;var c=Object(hi.f)().colors,r=c.GBK09A,o=c.GBL01A,a=n.event,s=n.id,l=a.url,u=a.type,d=a.title,b=a.isOnline,h=function(e){var t=e.match(/special\/(\d+)/);return t&&t[1]}(l);return Object(i.b)(j.b,{block:"SpecialTimeline",content:{type:"SpecialTopic",token:h},children:Object(i.b)(x.a,{trackCardShow:!0,module:"Content",content:{type:"SpecialTopic",token:h,parent_token:String(s)},extra:{button:{text:b?"online":"offline"}},view:{id:6620},children:Object(i.c)(j.e,{as:lc.d,zaType:"Card",css:{fontSize:15},children:[Object(i.c)(w.Flex,{flexDirection:"row",alignItems:"center",pl:"18px",height:"48px",css:Object(hi.c)({borderTop:"1px solid ".concat(r)}),children:[Object(i.b)(Qc.a,{css:{color:o},size:20}),Object(i.c)(w.Text,{fontWeight:"bold",ml:"10px",children:[Jc[u]," · ",d]})]}),Object(i.b)(Kc,{event:a})]})})})},Yc=n(944),$c=n(1156),Xc=n(141),er=n.n(Xc),tr=n(60),nr=n(41),ir=n.n(nr),cr=n(384),rr=n.n(cr),or=n(980),ar=n(493),sr=n(1323),lr=n(459),ur=n(1179),dr=function(e){function t(){var e,n;wt()(this,t);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(n=St()(this,(e=Tt()(t)).call.apply(e,[this].concat(c)))).state={display:!1},n.handleCloseByDocument=function(e){e.target.closest("div")&&"Pc-word-card-sign-label"!==e.target.closest("div").className&&n.setState({display:!1})},n.handleClick=function(){n.setState((function(e){return{display:!e.display}}));var e=n.sign.querySelector(".Pc-word-card-sign-label").getBoundingClientRect(),t=e.left,i=e.top,c=e.width,r=e.height+15,o=Math.floor(c/2);n.sign.querySelector(".Pc-word-card-sign-popup").style.top="".concat(i+r,"px"),n.sign.querySelector(".Pc-word-card-sign-popup").style.left="".concat(t-o,"px")},n.handleClose=function(){n.props.onClose&&n.props.onClose()},n.handleRef=function(e){n.sign=e},n}return At()(t,e),kt()(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.handleCloseByDocument)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleCloseByDocument)}},{key:"render",value:function(){return f.a.createElement("div",{className:"Pc-word-card-sign",ref:this.handleRef},f.a.createElement("div",{className:"Pc-word-card-sign-label",onClick:this.handleClick},"广告​",f.a.createElement(ur.a,{name:"triangle",className:"Pc-word-card-sign-svg"})),f.a.createElement("div",{className:"Pc-word-card-sign-popup ".concat(this.state.display?"Pc-word-card-sign-popup--isShowed":"Pc-word-card-sign-popup--isHidden")},f.a.createElement("span",{className:"Pc-word-card-sign-popup-arrow"}),f.a.createElement("div",{className:"Pc-word-card-sign-popup-menu"},f.a.createElement("button",{type:"button",onClick:this.handleClose},"不感兴趣"),f.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"/promotion-intro"},"知乎广告介绍"))))}}]),t}(p.Component);dr.propTypes={onClose:v.a.func};var br=n(1229),hr=n(49),pr=function(e){function t(){var e,n;wt()(this,t);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(n=St()(this,(e=Tt()(t)).call.apply(e,[this].concat(c)))).state={display:!0},n.handleClick=function(e){e.stopPropagation();var t=Object(ar.a)(n.props).ad.clickTracks;Object(lr.a)(t)},n.handleClose=function(){var e=Object(ar.a)(n.props).ad.closeTracks;Object(lr.b)(e).then((function(){n.setState((function(e){return{display:!e.display}})),n.props.onClose&&n.props.onClose()}))},n.handleRef=function(e){n.root=e},n}return At()(t,e),kt()(t,[{key:"componentDidMount",value:function(){if(this.root&&!this.props.preview){var e=Object(ar.a)(this.props).ad,t=e.impressionTracks,n=e.debugTracks,i={impressionTracks:t,viewTracks:e.viewTracks,debugTracks:n};Object(lr.f)(this.root,i),Object(lr.c)(n,!!this.props.data.adjson)}}},{key:"render",value:function(){if(!this.state.display)return null;var e=Object(ar.a)(this.props),t=e.ad,n=e.creative,i=t.expand.displayAdvertisingTag,c=n.asset,r=c.title,o=c.desc,a=c.cta,s=c.landingUrl,l=c.brandName,u=c.brandLogo,d="out_link"===Object(hr.e)(n,"protoInfo.contentType","");return f.a.createElement("div",{className:"Pc-word",ref:this.handleRef},f.a.createElement("div",{className:"Pc-word-card"},f.a.createElement(fr,{href:s,onClick:this.handleClick},f.a.createElement(mr,{data:{name:l,logo:u}})),i&&f.a.createElement(dr,{onClose:this.handleClose}),f.a.createElement(fr,{href:s,onClick:this.handleClick},f.a.createElement("h2",{className:"Pc-word-card-title"},r),f.a.createElement("div",{className:"Pc-word-card-content  "},o&&f.a.createElement(f.a.Fragment,null,f.a.createElement("span",null,o),f.a.createElement("span",{className:"Pc-word-card-content-cta  "},a))))),f.a.createElement(br.a,{url:d?"":s}))}}]),t}(p.Component);function fr(e){var t=e.children,n=rr()(e,["children"]);return f.a.createElement("a",ir()({target:"_blank"},n),t)}function mr(e){var t=e.data,n=t.name,i=t.logo;return f.a.createElement("div",{className:"Pc-word-card-brand"},f.a.createElement("div",{className:"Pc-word-card-brand-wrapper"},f.a.createElement("img",{width:"20",height:"20",src:i,alt:"logo"}),f.a.createElement("span",null,n)))}function vr(e){var t=Object(sr.a)(e.data);return t&&t.adjson?f.a.createElement(or.a,null,f.a.createElement(pr,ir()({},e,t))):null}pr.propTypes={data:v.a.object.isRequired,onClose:v.a.func};var Or=n(919),jr=n(1006),gr=n(6),yr=["item"];var wr={isDrained:!1,isFetching:!1,ids:[]};function Cr(e,t){var n=t.id,i=t.resource;return e.question[i][n]||wr}var kr=function(e){var t=e.item,n=Object(ke.default)(e,yr);return Object(i.b)(Or.a,{children:Object(i.b)(jr.a,Object.assign({editable:!0,expanded:!0,relatedTo:"question",answer:t,zaInfos:{cardShow:4351,index:String(n.dataZaIndex)}},n))},t.id)},xr=function(e,t,n){var i=t.relationship,c=i.canCollapseAnswers,r=i.canStickAnswers,o=t.hasPublishingDraft,a=e.map((function(e,t){return kr({item:e,canCollapse:c,canStick:r,hasPublishingDraft:o,itemProp:0===t?"acceptedAnswer":"suggestedAnswer",dataZaIndex:t})}));return n?a:Object(se.b)(2,a)},Ar=function(e,t){return e.map((function(e){return t[e]})).filter((function(e){return e&&!e.isDelete}))},Rr=Object(tr.isBrowser)()?er()(Ar,(function(e,t){return"".concat(e.join(","),"-").concat(t.length)})):Ar;function Sr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var Nr=function(e){Object(d.a)(n,e);var t=Sr(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).load=function(){var t=e.props,n=t.isFetching,i=t.id,c=t.loadNotificationAnswers;n||c(i)},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.isDrained,n=e.id,i=e.items,c=e.router;i.length||c.replace(location.pathname),(t||i.length)&&Object(B.S)(n)}},{key:"render",value:function(){var e=this.props,t=e.question,n=t.id,c=t.answerCount,r=e.question,o=e.items,a=e.isFetching,s=e.isDrained;return Object(i.c)("div",{className:"QuestionAnswers-answers",children:[Object(i.b)(lc.d,{children:Object(i.c)($c.a,{to:"/question/".concat(n),children:["查看全部 ",Object(xe.formatNumber)(c)," 条回答"]})}),Object(i.c)(lc.d,{children:[Object(i.c)(Yc.b,{children:[xr(o,r),a&&Object(i.b)(uc.a,{className:"List-item"})]}),!s&&!a&&Object(i.b)($c.a,{onClick:this.load,children:"更多"})]}),Object(i.b)(lc.d,{children:Object(i.c)($c.a,{to:"/question/".concat(n),children:["查看全部 ",Object(xe.formatNumber)(c)," 条回答"]})})]})}}]),n}(p.PureComponent),Tr=Object(g.compose)(c.withRouter,Object(O.connect)((function(e,t){var n=Cr(e,{id:t.id,resource:"notificationAnswers"}),i=n.isFetching,c=n.isDrained,r=n.ids;return{isFetching:i,isDrained:c,items:Rr(r,e.entities.answers)}}),{loadNotificationAnswers:B.S}))(Nr),qr=n(924),Br=n(154),Qr=n(987);function Ir(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var Pr=[{text:"默认排序",value:"default"},{text:"".concat("按","时间排序"),value:"updated"}],Er={updatedAnswers:"updated",answers:"default"};var zr=function(e){Object(d.a)(n,e);var t=Ir(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).handleResourceChange=function(t){e.props.router.push("/question/".concat(e.props.question.id).concat("default"===t?"":"/answers/".concat(t)))},e}return Object(u.a)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){JSON.stringify(this.props.permission)!==JSON.stringify(e.permission)&&this.loadQuestionAnswerCount(e)}},{key:"loadQuestionAnswerCount",value:function(e){var t=e.question,n=t.id,i=t.questionType,c=e.permission.canBrandAdminEdit,r=e.loadBrandQuestionAnswerCount;"commercial"===i&&c&&r(n)}},{key:"renderAnswerListHeader",value:function(){var e=this.props,t=e.resource,n=e.question,c=n.id,r=n.answerCount,o=n.questionType,a=n.brand,s=(a=void 0===a?{}:a).isPuQuestion,l=a.answerCntDescription,u=e.commonAnswerCount,d=e.hiddenAnswerCount,b=e.permission.canBrandAdminEdit;return"commercial"===o&&void 0!==s?b?Object(i.c)("div",{className:"QuestionAnswers-navs",children:[Object(i.c)(X.c,{preset:"plain",className:re()("QuestionAnswers-nav",{"is--active":["answers","updatedAnswers"].includes(t)}),onClick:function(){location.href="/question/".concat(c)},children:[Object(xe.formatNumber)(u)," 个回答",l]}),Object(i.c)(X.c,{preset:"plain",className:re()("QuestionAnswers-nav",{"is--active":"hiddenAnswers"===t}),onClick:function(){location.href="/question/".concat(c,"/answers/hidden")},children:[Object(xe.formatNumber)(d)," 个隐藏回答"]})]}):Object(i.c)("span",{children:[Object(xe.formatNumber)(r)," 个回答 ",l]}):Object(i.c)("span",{children:[Object(xe.formatNumber)(r)," 个回答"]})}},{key:"render",value:function(){var e=this.props,t=e.resource,n=e.children;return Object(i.b)(lc.d,{className:"AnswersNavWrapper",children:Object(i.b)(Qr.a,Object.assign(Object.assign({title:this.renderAnswerListHeader()},{options:"hiddenAnswers"===t?Object(i.b)("span",{children:"按时间排序"}):Object(i.b)(Br.b,{listClassName:"Answers-select",needsReposition:!0,plain:!0,value:Er[t],onChange:this.handleResourceChange,css:{".Select-arrow":{width:"1.2em",height:"1.2em"}},children:Pr.map((function(e){var t=e.value,n=e.text;return Object(i.b)(Br.a,{value:t,text:n},t)}))})}),{},{children:n}))})}}]),n}(p.PureComponent),Lr=Object(g.compose)(c.withRouter,Object(O.connect)((function(e){var t=e.question;return{commonAnswerCount:t.commonAnswerCount,hiddenAnswerCount:t.hiddenAnswerCount,permission:Object(B.cb)(e)}}),{loadBrandQuestionAnswerCount:B.K}))(zr),Mr=n(1065),Dr=n(16);function Fr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var Hr=function(e){Object(d.a)(n,e);var t=Fr(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).handlePaginationClick=function(t){e.props.router.push("".concat(location.pathname,"?page=").concat(t))},e.handleUpdatedAnswersLoad=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dr.b,i=e.props,c=i.question.id,r=i.loadItems;r(c,"updatedAnswers",{offset:t,limit:n})},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.question.id,n=e.page,i=e.isDrained,c=e.items,r=e.loadItems;!i&&c.length<Dr.b&&r(t,"updatedAnswers",{offset:Object(gr.c)(n)+c.length,limit:Dr.b-c.length})}},{key:"render",value:function(){var e=this.props,t=e.isFetching,n=e.isCurrentLoaded,c=e.page,r=e.items,o=e.total,a=e.question,s=e.isMuteSpecial;return Object(i.b)(Mr.a,{isFetching:t,isDrained:n,page:c,total:o,placeholder:Object(i.b)(uc.a,{className:"List-item"}),onPaginationClick:this.handlePaginationClick,onLoad:this.handleUpdatedAnswersLoad,children:(c>o||n)&&!r.length?Object(i.b)(lc.d,{className:"Answers-none",children:Object(i.c)(qr.k,{children:[Object(i.b)(qr.b,{}),Object(i.b)("div",{children:s?"回答暂时无法查看":"还没有回答"})]})}):xr(r,a)})}}]),n}(p.PureComponent),_r=Object(g.compose)(c.withRouter,Object(O.connect)((function(e,t){var n=t.page,i=Cr(e,{id:t.question.id,resource:"updatedAnswers"}),c=i.isFetching,r=i.isDrained,o=i.ids,a=Object(gr.d)(n,o),s=a.total,l=a.isCurrentLoaded,u=a.items;return{isMuteSpecial:Object(B.E)(t.question),isFetching:c,isDrained:r,total:s,isCurrentLoaded:l,items:Rr(u,e.entities.answers).filter((function(e){return!e.isDelete}))}}),{loadItems:B.R}))(Hr),Ur=n(2255),Vr=n.n(Ur),Gr=n(413),Wr=n.n(Gr),Kr=n(1469),Jr=n(1461),Zr=n(1470),Yr=n(304),$r=n(1479),Xr=n(1654),eo=function(){var e=Object(p.useState)(!1),t=Object(r.a)(e,2),n=t[0],c=t[1],o=Object(p.useState)("login"),a=Object(r.a)(o,2),s=a[0],l=a[1],u=Object(p.useState)(""),d=Object(r.a)(u,2),b=d[0],h=d[1],f=Object(p.useState)(""),m=Object(r.a)(f,2),v=m[0],O=m[1];return Object(i.c)("div",{className:"BlockTypeLogin",children:[Object(i.c)("div",{className:"BlockTypeLogin-leftPart",children:[Object(i.c)("div",{className:"BlockTypeLogin-headImg",children:[Object(i.b)(Xr.a,{css:{width:"59px",height:"70px"}}),Object(i.b)("div",{className:"BlockTypeLogin-imgTips",children:"登录查看余下内容"})]}),"login"===s?Object(i.b)("div",{children:Object(i.b)(Jr.a,{showSwitchTypeIcon:!1,showQrcode:!1,selectClassName:"BlockTypeLogin-select"})}):Object(i.c)("div",{children:[Object(i.b)(Yr.a,{selectClassName:"BlockTypeLogin-select",children:Object(i.b)(Zr.a,{socialType:v,defaultFullname:b,onResetRegister:function(){l("login"),h(""),O("")}})}),Object(i.b)("div",{className:"SignContainer-tip",children:Object(i.b)("div",{children:Object(i.c)("div",{children:["手机验证后自动登录，登录即代表同意",Object(i.b)("a",{href:"https://www.zhihu.com/term/zhihu-terms",children:"《知乎协议》"}),Object(i.b)("a",{href:"https://www.zhihu.com/term/privacy",children:"《隐私保护指引》"})]})})})]}),Object(i.b)("div",{className:"BlockTypeLogin-loginModeSwitch",onClick:function(){c((function(e){return!e}))},children:n?"关闭其他方式":"其他方式登录"})]}),Object(i.b)("div",{className:"BlockTypeLogin-rightPart",children:Object(i.c)("div",{className:"BlockTypeLogin-otherLoginMode",style:{opacity:n?1:0},children:[Object(i.b)(Kr.a,{showSwitchTypeIcon:!1,className:"smallVersion",isBlockType:!0}),Object(i.b)($r.a,{onRegister:function(e){var t=e.fullname,n=e.socialType;l("register"),h(t),O(n)}})]})})]})},to=function(){return Object(i.b)(j.e,{zaType:"Block",zaBlock:"blockingTypeLoginModal",zaText:"阻断式登录弹层",children:Object(i.b)("div",{css:{position:"absolute",zIndex:3,borderTop:"1px solid #e7eaf1",left:0,width:"100%",marginTop:-254,height:294,backgroundColor:"rgba(255, 255, 255, 0.95)"},children:Object(i.b)(eo,{})})})};function no(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var io=function(e){Object(d.a)(n,e);var t=no(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={showBlockModal:!1},e.handleLoad=function(){var t,n=e.state.showBlockModal,i=e.props,c=i.question.id,r=i.loadItems,o=i.isFetching,a=i.isDrained,s=i.items,l=i.resource,u=void 0===l?"answers":l,d=Number(null===(t=e.props.modalShowCondition)||void 0===t?void 0:t.insertIndex)||10;if(!a&&!o){if(s.length>=+d&&n)return;r(c,u,{limit:5})}},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.question.id,i=t.isDrained,c=t.items,r=t.loadItems,o=t.getShowConditions,a=t.getActiveDays;if(t.hasBlockLogin){var s=ye.a.get("blockShow"),l=(new Date).getTime();(!s||Vr.a.duration(l-s).asDays()>30)&&Promise.all([o(),a()]).then((function(t){var n,i,c,r,o=null===(n=t[0].payload)||void 0===n||null===(i=n.data)||void 0===i?void 0:i.activeDays;+(null===(c=t[1].payload)||void 0===c||null===(r=c.data)||void 0===r?void 0:r.num)>=+o&&(e.setState({showBlockModal:!0}),ye.a.set("blockShow",l))}))}!i&&c.length<5&&r(n,"answers",{offset:c.length,limit:5})}},{key:"render",value:function(){var e,t=this,n=this.state.showBlockModal,c=this.props,r=c.adverts,o=c.isBot,a=c.isFetching,s=c.isDrained,l=c.items,u=c.question,d=Number(null===(e=this.props.modalShowCondition)||void 0===e?void 0:e.insertIndex)||10,b=n?l.slice(0,d):l,h=u.relationship,p=h.canCollapseAnswers,f=h.canStickAnswers,m=u.hasPublishingDraft,v=[0].concat(Object(Wt.a)(Object.keys(r||{}).map(Number).sort((function(e,t){return e-t})))),O=n?v.filter((function(e){return e<d})):v,j={canCollapse:p,canStick:f,hasPublishingDraft:m};return Object(i.c)("div",{children:[Object(i.b)(uc.b,{onRef:function(e){t.listEl=e},isLocal:!0,isLoading:a,isDrained:s,onLoad:this.handleLoad,placeholder:Object(i.b)(uc.a,{className:"List-item"}),children:o?b.map((function(e,t){return kr(Object.assign({item:e,itemProp:0===t?"acceptedAnswer":"suggestedAnswer",dataZaIndex:t},j))})):Object(se.b)(2,Wr()(O.map((function(e,t){var c,o=O[t+1],a=(o?b.slice(e,o):b.slice(e)).map((function(c,r){var o=e+r+t;return o===d&&n?Object(i.b)("div",{style:{height:254,overflow:"hidden"},children:kr(Object.assign({item:c,itemProp:0===o?"acceptedAnswer":"suggestedAnswer",dataZaIndex:o},j))}):kr(Object.assign({item:c,itemProp:0===o?"acceptedAnswer":"suggestedAnswer",dataZaIndex:o},j))}));return o?[].concat(Object(Wt.a)(a),[(c=r[o],c?Object(i.b)(vr,{data:c}):null)]):a}))))}),b.length>d-1&&n&&Object(i.b)(to,{})]})}}]),n}(p.Component),co=Object(g.compose)(Object(O.connect)((function(e,t){var n=Cr(e,{id:t.question.id,resource:"answers"}),i=n.isFetching,c=n.isDrained,r=n.ids,o=c||i?r:r.slice(0,Math.max(5,r.length-5)),a=Object(L.b)(e);return{isBot:e.env.userAgent.isBot,isFetching:i,hasBlockLogin:!("1"!==Object(st.a)(e,"PC_blockLogin")||Object(st.d)(e)||a&&"guest"!==a.userType),modalShowCondition:e.question.modalShowCondition,isDrained:c,items:Rr(o,e.entities.answers).filter((function(e){return e&&!e.isDelete})),adverts:Object(B.c)(e)}}),{loadItems:B.R,getShowConditions:B.x,getActiveDays:B.p}))(io);function ro(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var oo=function(e){Object(d.a)(n,e);var t=ro(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).handlePaginationClick=function(t){e.props.router.push("".concat(location.pathname,"?page=").concat(t))},e.handleHiddenAnswersLoad=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dr.b,i=e.props,c=i.question.id,r=i.loadItems;r(c,"hiddenAnswers",{offset:t,limit:n})},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.question.id,n=e.page,i=e.isDrained,c=e.items,r=e.loadItems;!i&&c.length<Dr.b&&r(t,"hiddenAnswers",{offset:Object(gr.c)(n)+c.length,limit:Dr.b-c.length})}},{key:"render",value:function(){var e=this.props,t=e.isFetching,n=e.isCurrentLoaded,c=e.page,r=e.items,o=e.total,a=e.question;return Object(i.b)(Mr.a,{isFetching:t,isDrained:n,page:c,total:o,placeholder:Object(i.b)(uc.a,{className:"List-item"}),onPaginationClick:this.handlePaginationClick,onLoad:this.handleHiddenAnswersLoad,children:xr(r,a)})}}]),n}(p.PureComponent),ao=Object(g.compose)(c.withRouter,Object(O.connect)((function(e,t){var n=t.page,i=Cr(e,{id:t.question.id,resource:"hiddenAnswers"}),c=i.isFetching,r=i.isDrained,o=i.ids,a=Object(gr.d)(n,o,Dr.b);return Object.assign(Object.assign({isFetching:c,isDrained:r},a),{},{items:Rr(a.items,e.entities.answers).filter((function(e){return!e.isDelete}))})}),{loadItems:B.R}))(oo);function so(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var lo=function(e){Object(d.a)(n,e);var t=so(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.question,n=t.id,i=t.relationship.isAuthor,c=e.resource,r=e.router;"collapsedAnswers"!==c||i||r.push("/question/".concat(n))}},{key:"render",value:function(){var e=this.props,t=e.resource,n=e.question,c=e.question,r=c.questionType,o=c.answerCount,a=c.reviewInfo.tips,s=c.isVisible,l=e.location;if(e.isMuteSpecial||!s)return Object(i.b)(lc.d,{className:"Answers-none",children:Object(i.c)(qr.k,{children:[Object(i.b)(qr.b,{}),Object(i.b)("div",{children:"回答暂时无法查看"})]})});if("commercial"!==r&&!o){if(a)return null;var u=n.status||{},d=u.isClose,b=u.isLocked,h=u.isSuggest;return d||b||h?null:Object(i.b)(lc.d,{className:"Answers-none",children:Object(i.c)(qr.k,{children:[Object(i.b)(qr.b,{}),Object(i.c)("div",{children:["暂时还没有回答，开始",Object(i.b)(bt,{preset:"plain",className:"QuestionAnswers-answerLink",children:"写第一个回答"})]})]})})}return Object(i.b)("div",{id:"QuestionAnswers-answers",className:"QuestionAnswers-answers","data-zop-feedlistmap":"answers"===t?"0,0,1,0":"0,0,1",children:Object(i.c)(Lr,{question:n,resource:t,children:["updatedAnswers"===t&&Object(i.b)(_r,{question:n,page:Number(l.query.page)||1}),"answers"===t&&Object(i.b)(co,{question:n}),"hiddenAnswers"===t&&Object(i.b)(ao,{question:n,page:Number(l.query.page)||1})]})})}}]),n}(p.PureComponent),uo=Object(g.compose)(Object(x.b)({module:"ContentList"}),c.withRouter,Object(O.connect)((function(e,t){return{isMuteSpecial:Object(B.E)(t.question)}})))(lo),bo=n(1655),ho=n(909),po=n(1641),fo=n(1294),mo=n(1642),vo=n(1459);function Oo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var jo=function(e){Object(d.a)(n,e);var t=Oo(n);function n(){var e,i;Object(l.a)(this,n);for(var c=arguments.length,r=new Array(c),o=0;o<c;o++)r[o]=arguments[o];return(i=t.call.apply(t,[this].concat(r))).state={topicBiosModalShown:!1,activeTabKey:"video_answer"===(null===(e=i.props.draft)||void 0===e?void 0:e.draftType)?fo.a.videoAnswer:fo.a.textAnswer},i.answerFormRef=Object(p.createRef)(),i.handleSubmit=function(e){var t=i.props,n=t.currentUser,c=t.question.id,r=t.addAnswer,o=t.scheduledPublish,a=t.validateScheduledPublish,s=t.loadDraft;if(e.publishAt){var l=o(c,e);return l.then((function(){i.context.endAddAnswer(),s(c)})),l}var u=function(){return r(c,e)};return n.autoSendingCreations?a(c).then(u,(function(e){if(e&&e.payload&&e.payload.message&&400===e.status)return it.a.confirm(e.payload.message,{title:"提醒",text:{ok:"确定发布",cancel:"我再想想"}}).then(u,(function(){}))})):u()},i.focus=function(){var e;null===(e=i.answerFormRef.current)||void 0===e||e.focus()},i.handleToggleAnonymous=function(){var e=i.context.toggleAnonymous,t=i.props,n=t.showNotification,c=t.question.relationship.isAnonymous,r=t.isOffice;if(c||!i.answerFormRef.current.hasVideo()){if(c||!i.answerFormRef.current.hasMCNLinkCard())return!c&&i.answerFormRef.current.hasADLinkCard()?i.answerFormRef.current.hasFeeConsultCard()?n("不能使用匿名身份插入付费咨询卡片","red"):void n("不能使用匿名身份插入推荐卡片","red"):void(!c&&i.answerFormRef.current.hasCommercialReport()&&r?n("已经进行商业声明的内容不能启用匿名","red"):e());n("不能使用匿名身份推荐商品","red")}else n("匿名不能使用视频功能，如需启用匿名请删除草稿中的视频","red")},i.handleTabChange=function(e){if(e!==i.state.activeTabKey){var t=i.props,n=t.question.relationship.isAnonymous,c=t.showNotification;if(e===fo.a.videoAnswer){var r;if(n)return void c("视频回答不支持匿名","red");null!==(r=i.answerFormRef.current)&&void 0!==r&&r.hasEditorContent()&&(ye.a.get("answerContentSync")||(c("图文回答内容已同步至视频描述"),ye.a.set("answerContentSync",!0)))}i.setState({activeTabKey:e})}},i}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.question.id;(0,e.getBio)(t),this.props.answering&&setTimeout(this.focus)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.answering!==e.answering&&this.focus()}},{key:"render",value:function(){var e,t=this.state.activeTabKey,n=this.props.question,c=vo.a;return Object(i.c)("div",{className:"AnswerAdd",css:{position:"relative"},children:[Object(i.c)(w.Flex,{justifyContent:"space-between",css:function(e){return[{borderBottom:"1px solid ".concat(e.colors.GBK09A),".Tabs":{border:"none"}},{background:e.colors.GBK99A}]},children:[Object(i.b)(fo.b,{activeTabKey:t,onChange:this.handleTabChange}),Object(i.b)(mo.a,{handleClick:null===(e=this.answerFormRef.current)||void 0===e?void 0:e.toggleFullscreen})]}),Object(i.b)("div",{css:function(e){return{background:e.colorMod(e.colors.GBK10C).alpha(.45)}},children:Object(i.b)(c,{activeTabKey:t,handleTabChange:this.handleTabChange,handleToggleAnonymous:this.handleToggleAnonymous,imperativeRef:this.answerFormRef,question:n,onSubmit:this.handleSubmit,onCancel:this.context.endAddAnswer,useMediumEditor:!0})})]})}}]),n}(p.Component);jo.contextTypes={toggleAnonymous:v.a.func.isRequired,endAddAnswer:v.a.func};var go=Object(g.compose)(c.withRouter,Object(O.connect)((function(e,t){var n=e.question.bio,i=e.topic.bios,c=e.answers.newAnswer,r=e.entities.drafts,o=void 0===r?{}:r,a=t.question.id,s=(n[a]||{result:{type:"headline"}}).result;return"topic"===s.type&&(s.bio=i[s.topic.id]||s.bio),{currentUser:Object(L.b)(e),questionBio:s,newAnswer:c,allowCommercialAnonymousAnswer:"show"===Object(st.a)(e,"gue_anonymous"),isOffice:Object(st.e)(e),draft:o["question_".concat(a)]}}),{showNotification:F.h,addAnswer:D.a,scheduledPublish:D.B,validateScheduledPublish:D.M,loadDraft:B.Q,getBio:B.q}))(jo);function yo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var wo=function(e){Object(d.a)(n,e);var t=yo(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props,n=t.question,i=n.id,c=n.relationship.myAnswer,r=void 0===c?{}:c,o=t.router,a=e.question,s=a.id,l=a.relationship.myAnswer,u=void 0===l?{}:l;i===s&&r.answerId!==u.answerId&&(ie.a.trackEvent(this,{action:"StatusReport"},{status:{result:"Success",event:{action:"Answer"}}}),o.push("/question/".concat(i,"/answer/").concat(u.answerId)),ye.a.set("answer::justPublished",!0))}},{key:"render",value:function(){if(!this.props.currentUser)return null;var e=this.props,t=e.question,n=e.question,c=n.relationship.myAnswer,r=n.isNormal,o=n.status,a=(o=void 0===o?{}:o).isClose,s=o.isLocked,l=o.isSuggest,u=n.hasPublishingDraft,d=e.answering;return c?null:l?Object(i.c)("div",{className:"QuestionAnswers-answerTip",children:["被建议修改的问题不允许添加新的回答。",Object(i.b)(at.a,{preset:"plain",to:"/question/21290061",children:"问题为什么会被建议修改？"})]}):s?Object(i.c)("div",{className:"QuestionAnswers-answerTip",children:["该问题目前已经被锁定，无法添加新答案。",Object(i.b)(at.a,{preset:"plain",to:"/question/19604313",children:"问题为什么会被锁定？"})]}):a?Object(i.c)("div",{className:"QuestionAnswers-answerTip",children:["被关闭的问题不允许添加新的回答。",Object(i.b)(at.a,{className:"QuestionAnswers-iconLink",preset:"plain",to:"/question/21290061","data-tooltip":"为什么部分问题会被「关闭」「建议修改」？","aria-label":"为什么部分问题会被「关闭」「建议修改」？",icon:ho.a})]}):u?Object(i.b)(lc.d,{className:"QuestionAnswers-answerTipCard",children:"你创建的回答正在发布中…"}):r?Object(i.b)(po.a,{disabled:!1,children:Object(i.b)(bo.CSSTransitionGroup,{className:"QuestionAnswers-statusWrapper",transitionEnterTimeout:300,transitionLeaveTimeout:300,transitionName:"expand",component:"div",children:d&&Object(i.c)(lc.d,{className:"QuestionAnswers-answerAdd",id:"js-answerAddCard",children:[Object(i.b)("a",{name:"draft"}),Object(i.b)(go,{question:t,answering:d})]})})}):null}}]),n}(p.PureComponent),Co=Object(c.withRouter)(Object(Ft.a)(wo)),ko=n(303),xo=["className","children"];function Ao(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var Ro=function(e){Object(d.a)(n,e);var t=Ao(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.children,c=Object(ke.default)(e,xo);return Object(i.b)("div",Object.assign(Object.assign({},c),{},{className:re()("QuestionMainDivider",t),children:Object(i.b)("span",{className:"QuestionMainDivider-inner",children:n})}))}}]),n}(p.Component);function So(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var No=function(e){Object(d.a)(n,e);var t=So(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={opened:!1},e.handleLoad=function(){var t=e.props,n=t.question.id;return(0,t.loadItems)(n,"collapsedAnswers")},e.handleOpen=function(){e.handleLoad(),e.setState({opened:!0})},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props,t=e.isDrained,n=e.isFetching,c=e.items,r=e.question,o=e.question,a=o.collapsedAnswerCount,s=o.questionType,l=(e.currentUser,this.state.opened),u="org"===s,d="".concat(Object(xe.formatNumber)(a)," 个回答被").concat(u?"隐藏":"折叠"),b=Object(i.b)(at.a,{preset:"plain",to:u?"/org-intro#org-question":"/question/20120168",target:"_blank",children:"为什么？"});return l?Object(i.c)(lc.d,{children:[Object(i.c)(Ro,{children:[d,"（",b,"）"]}),Object(i.c)(Yc.b,{children:[xr(c,r),n&&Object(i.b)(uc.a,{className:"List-item"})]}),!t&&!n&&Object(i.b)($c.a,{onClick:this.handleLoad,children:"更多"})]}):Object(i.c)("div",{className:"CollapsedAnswers-bar",style:{},children:[Object(i.b)(X.c,{preset:"plain",onClick:this.handleOpen,children:d}),"（",b,"）"]})}}]),n}(p.Component),To=Object(g.compose)(ko.b,Object(O.connect)((function(e,t){var n=Cr(e,{id:t.question.id,resource:"collapsedAnswers"}),i=n.isFetching,c=n.isDrained,r=n.ids;return{isFetching:i,isDrained:c,items:Rr(r,e.entities.answers)}}),{loadItems:B.R}))(No),qo=n(1475),Bo=n(1483),Qo=n(1052),Io=n(1003),Po=n(1370),Eo=n(153);function zo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var Lo=function(e){Object(d.a)(n,e);var t=zo(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props.question,t=e.id,n=e.title,c=e.answerCount,r=e.followerCount,o="/question/".concat(t);return Object(i.c)("div",{className:"SimilarQuestions-item",itemProp:"zhihu:similarQuestion",itemType:"http://schema.org/Question",itemScope:!0,children:[Object(i.b)("meta",{itemProp:"name",content:n}),Object(i.b)("meta",{itemProp:"url",content:"https://www.zhihu.com".concat(o)}),Object(i.b)("meta",{itemProp:"answerCount",content:c}),Object(i.b)("meta",{itemProp:"zhihu:followerCount",content:r}),Object(i.b)(at.a,{preset:"plain",to:o,target:"_blank",children:n})," ",Object(xe.formatNumber)(c)," 个回答"]})}}]),n}(p.Component),Mo=Object(x.b)((function(e){var t=e.question;return{module:"QuestionItem",content:{type:"Question",token:String(t.id),author_member_hash_id:(t.author||{}).id},trackCardShow:!0}}))(Lo);function Do(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var Fo=function(e){Object(d.a)(n,e);var t=Do(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.question.id;(0,e.loadSimilarQuestions)(t)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props,n=t.question.id,i=t.loadSimilarQuestions,c=e.question.id;n!==c&&i(c)}},{key:"componentDidUpdate",value:function(e){!e.items&&this.props.items&&this.props.onLoad&&this.props.onLoad()}},{key:"render",value:function(){var e=this.props.items;return e&&e.length?Object(i.c)(lc.d,{css:{borderRadius:"0 0 2px 2px"},role:"complementary","aria-label":"相关问题",children:[Object(i.b)(lc.b,{className:"SimilarQuestions-title",children:"相关问题"}),Object(i.b)(lc.c,{className:"SimilarQuestions-list",children:e.map((function(e){return Object(i.b)(Mo,{question:e},e.id)}))})]}):null}}]),n}(p.Component),Ho=Object(g.compose)(Object(O.connect)((function(e,t){return{items:e.question.similarQuestions[t.question.id]}}),{loadSimilarQuestions:B.bb}),Object(x.b)({module:"RelatedQuestions"}))(Fo),_o=n(5),Uo=n(2771);function Vo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var Go=function(e){Object(d.a)(n,e);var t=Vo(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={hideDescription:!1},e.handleRef=function(t){e.title=t},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.title.offsetWidth<this.title.scrollWidth&&this.setState({hideDescription:!0})}},{key:"render",value:function(){var e=this.props,t=e.link,n=e.title,c=e.description,r=e.meta,o=e.imageUrl,a=this.state.hideDescription;return Object(i.c)(at.a,{preset:"plain",a:!0,to:t,className:"RelatedCommodities-item",target:"_blank",children:[Object(i.b)("img",{className:"RelatedCommodities-image",src:Object(Ae.imgUrl)(o,{quality:90,size:"250x0"}),alt:"live"}),Object(i.c)("div",{className:"RelatedCommodities-content",children:[Object(i.b)("div",{className:re()("RelatedCommodities-subject",{"RelatedCommodities-subject-two":a}),style:{},ref:this.handleRef,"data-tooltip":n,children:n}),a||Object(i.b)("div",{className:"RelatedCommodities-description",children:c}),Object(i.b)("div",{className:"RelatedCommodities-meta",children:r})]})]})}}]),n}(p.Component),Wo=n(1729);function Ko(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var Jo=function(e){Object(d.a)(n,e);var t=Ko(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).handleListen=function(e){var t="".concat(e.target.closest("a").href,"?extra_auto_play=1");e.preventDefault(),e.stopPropagation(),ie.a.trackEvent(e.target,{action:"OpenUrl",element_name:"Play"},{link:{url:t}}),window.open(t,"_blank")},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props.item;switch(e.type){case"live":var t=e.id,n=e.subject,c=e.reviewScore,r=e.seats,o=(e.startsAt,e.speaker.member),a=o.name,s=o.avatarUrl;return Object(i.b)(Go,{link:"/lives/".concat(t),imageUrl:s,title:n,description:a,meta:Object(i.c)("div",{className:"RelatedCommodities-scoreWrapper",children:[Object(i.b)(Wo.a,{score:c}),Boolean(r&&r.taken)&&"".concat(r.taken," 人参与"),!1]})});case"remix_album":case"podcast":case"remix":var l=e.id,u=e.artwork,d=e.title,b=e.author,h=(b=void 0===b?{}:b).user,p=e.trackCount,f="/remix/albums/".concat(l);return Object(i.b)(Go,{link:f,imageUrl:u,title:d,description:h&&h.name,meta:Object(i.c)("div",{className:"RelatedCommodities-remixMeta",children:[Object(i.c)("div",{children:["共 ",Object(xe.formatNumber)(p)," 节课"]}),Object(i.b)(X.c,{className:"RelatedCommodities-remixListen",onClick:this.handleListen,preset:"plain",children:"试听"})]})});case"special":var m=e.id,v=e.subject,O=e.liveCount,j=e.liveMemberCount,g=e.speakers,y=e.artworkMobile,w=g.slice(0,2).map((function(e){return e.member.name})).join("、");return Object(i.b)(Go,{link:"/lives/specials/".concat(m),imageUrl:y,title:v,description:"".concat(w).concat(g.length>=2?" 等":""),meta:"".concat(Object(xe.formatNumber)(O)," 场 Live, ").concat(Object(xe.formatNumber)(j)," 次参与")});case"book":var C=e.id,k=e.title,x=e.cover,A=e.authorName,R=e.readCount;return Object(i.b)(Go,{link:"/pub/book/".concat(C),imageUrl:x,title:k,description:A,meta:Object(i.c)("div",{className:"RelatedCommodities-bookMeta",children:["".concat(Object(xe.formatNumber)(R)," 人读过"),Object(i.c)("span",{className:"RelatedCommodities-bookRead",children:[Object(i.b)(Uo.a,{width:13,height:14,center:!0}),"阅读"]})]})});default:return null}}}]),n}(p.Component),Zo=Object(x.b)((function(e){var t=e.item,n=e.index;if("book"===t.type)return{module:"EBookItem",index:n,content:{type:"EBook",token:String(t.id)},trackCardShow:!0};var i="special"===t.type?"LiveAlbum":Object(_o.pascalize)(t.type);return{module:"".concat(i,"Item"),index:n,content:Object.assign({type:i,id:t.id},"live"===t.type&&{author_member_hash_id:t.speaker.member.id}),trackCardShow:!0}}))(Jo);function Yo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var $o=function(e){Object(d.a)(n,e);var t=Yo(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.question.id,n=e.answer;(0,e.loadRelatedCommodities)(t,n&&n.id)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props,n=t.question.id,i=t.loadRelatedCommodities,c=e.question.id;n!==c&&i(c)}},{key:"componentDidUpdate",value:function(e){!e.items&&this.props.items&&this.props.onLoad&&this.props.onLoad()}},{key:"render",value:function(){var e=this.props.items;return e&&e.length?Object(i.c)(lc.d,{children:[Object(i.b)(lc.b,{className:"RelatedCommodities-title",children:"相关推荐"}),Object(i.b)(lc.c,{className:"RelatedCommodities-list",children:e.slice(0,3).map((function(e){return Object(i.b)(Zo,{item:e},e.id)}))})]}):null}}]),n}(p.Component),Xo=Object(g.compose)(Object(O.connect)((function(e,t){var n=e.question.relatedCommodities[t.question.id];return{attachedInfo:(n||[]).attachedInfo,items:n}}),{loadRelatedCommodities:B.ab}),Object(x.b)((function(e){return{attachedInfoBytes:e.attachedInfo,module:"ContentList",moduleName:"相关推荐"}})))($o),ea=n(1661),ta=n(1113);function na(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var ia=function(e){Object(d.a)(n,e);var t=na(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).goToBrand=function(){var t=e.props.brand.target;t&&(location.href="/org/".concat(t.urlToken))},e}return Object(u.a)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props.brand,n=e.brand,i=e.loadProfile;t&&n&&t.name!==n.name&&n.target&&n.target.urlToken&&i(n.target.urlToken,!1)}},{key:"render",value:function(){var e=this.props,t=e.brand,n=t.logo,c=t.name,r=t.target,o=(t.isPuQuestion,t.aboutDescription),a=e.brandMember,s=e.currentUser;return Object(i.c)(lc.d,{className:re()({MobileBrandQuestionAuthor:!1}),children:[Object(i.b)(lc.b,{className:"BrandQuestionAuthor-header",children:Object(i.b)("span",{className:"BrandQuestionAuthor-headerText",children:o})}),Object(i.c)(lc.c,{className:re()("BrandQuestionAuthor",r&&"is-clickable"),onClick:this.goToBrand,children:[Object(i.b)("img",{src:n,className:"BrandQuestionAuthor-icon",alt:"brand"}),Object(i.c)("div",{className:"BrandQuestionAuthor-content",children:[Object(i.c)("div",{className:"BrandQuestionAuthor-name",children:[c,r&&r.urlToken&&Object(i.b)(he.c,{css:{marginLeft:3},badge:r.badge})]}),r&&r.headline&&Object(i.b)("div",{className:"BrandQuestionAuthor-intro",children:r.headline})]})]}),a&&a.id&&s&&s.id!==a.id&&Object(i.b)(ta.a,{className:"BrandQuestionAuthor-buttons",user:a})]})}}]),n}(p.Component),ca=Object(g.compose)(Ft.a,Object(O.connect)((function(e){var t=e.entities,n=e.question.brand,i={};return n&&n.target&&n.target.urlToken&&(i=t.users[n.target.urlToken]||{}),{brand:n,brandMember:i}}),{loadBrand:B.I,loadProfile:Eo.i}))(ia),ra=Object(g.compose)(c.withRouter,Object(Q.a)(null))((function(e){var t=e.params,n=Object(O.useSelector)((function(e){return Object(B.db)(e,{id:t.id})})),c=Object(O.useDispatch)();return Object(p.useEffect)((function(){n||c(Object(B.X)(t.id))}),[t.id]),null!=n&&n.title?n.vote&&!n.vote.disable?null:Object(i.b)(lc.d,{css:{marginBottom:"10px"},children:Object(i.b)(Fi,{data:n})}):null})),oa=Object(g.compose)(Object(Q.a)(null),ko.b,Object(O.connect)(null,{getReadingMembership:B.w}))((function(e){var t=e.getReadingMembership,n=e.isLogin,c=Object(p.useState)(!1),o=Object(r.a)(c,2),a=o[0],s=o[1],l=Object(p.useState)(!1),u=Object(r.a)(l,2),d=u[0],b=u[1];Object(p.useEffect)((function(){n&&t().then((function(e){var t=e.payload;b(t.isHaveRight)})).catch((function(){}))}),[t,n]);var h=function(){s(!a)};return d&&Object(i.c)(i.a,{children:[Object(i.c)(lc.d,{className:"ReadingMembership",onClick:h,children:[Object(i.c)("div",{className:"ReadingMembership-banner",children:[Object(i.b)("div",{children:"领取读书会会员体验卡"}),Object(i.c)("div",{children:["海量电子书免费读 ",Object(i.b)(pi.a,{size:22})]})]}),Object(i.b)("img",{src:"https://pic3.zhimg.com/80/v2-ba02e89d92407e3e2491a27af5ace660_hd.jpeg",alt:""})]}),Object(i.b)(Vt.b,{className:"ReadingMembership-modal",onClose:h,children:a&&Object(i.c)("div",{className:"ReadingMembership-content",children:[Object(i.b)("img",{src:"https://pic2.zhimg.com/80/v2-8f8b9ff43e407c160bfc2d6352c662b6_hd.jpeg",alt:""}),Object(i.c)("div",{className:"ReadingMembership-title",children:[Object(i.b)("div",{children:"登录知乎 App 领取"}),Object(i.b)("div",{children:"读书会会员 7 天体验卡"})]}),Object(i.c)("div",{className:"ReadingMembership-qrcode",children:[Object(i.b)("div",{children:"知乎读书会会员，海量电子书免费读"}),Object(i.b)("img",{src:"https://pic2.zhimg.com/80/v2-e3a03af184c11dc3526218de74977fd5_hd.png",alt:"知乎二维码"}),Object(i.b)("div",{children:"扫码下载知乎 App"})]})]})})]})}));function aa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var sa=function(e){Object(d.a)(n,e);var t=aa(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).sidebarRef=Object(p.createRef)(),e.onHeightChange=function(){e.dynamicSticky&&e.dynamicSticky.check()},e}return Object(u.a)(n,[{key:"UNSAFE_componentWillMount",value:function(){var e=this.props,t=e.question,n=t.id,i=t.questionType,c=e.loadBrand;"commercial"===i&&c(n)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props.brand,n=e.brand,i=e.loadProfile;t&&n&&t.name!==n.name&&n.target&&i(n.target.urlToken,!1)}},{key:"render",value:function(){var e=this,t=this.props,n=t.question,c=t.question,r=c.id,o=c.questionType,a=t.brand;return Object(i.b)(Io.a,{className:"Question-sideColumn Question-sideColumn--sticky",onRef:this.sidebarRef,offset:pt.i+10,ref:function(t){e.dynamicSticky=t},children:Object(i.c)(Po.a,{sidebarRoot:this.sidebarRef,selector:".Card",children:["commercial"===o&&Object(i.b)(ea.a,{questionId:r,pageType:"question",onLoad:this.onHeightChange}),"commercial"===o&&a&&Object(i.b)(ca,{brand:a}),"commercial"!==o&&Object(i.b)(Bo.a,{type:"question"}),"normal"===o&&Object(i.b)("div",{className:"Card",children:Object(i.b)(qo.a,{isMobile:!1,id:"question/".concat(r),location:"new_question_up",query:{question_token:r},onHeightChange:this.onHeightChange})}),Object(i.b)(ra,{}),Object(i.b)(oa,{}),Object(i.b)(Yi,{id:r,question:n,position:"right"}),"normal"===o&&Object(i.b)(Ho,{question:n,onLoad:this.onHeightChange}),"normal"===o&&Object(i.b)(Xo,{question:n,onLoad:this.onHeightChange}),"normal"===o&&Object(i.b)("div",{className:"Card",children:Object(i.b)(qo.a,{isMobile:!1,id:"question/".concat(r),location:"new_question_down_sticky",query:{question_token:r},delay:500,onHeightChange:this.onHeightChange})}),"commercial"===o&&Object(i.b)(Bo.a,{type:"question"}),Object(i.b)(Qo.a,{})]})})}}]),n}(p.Component),la=Object(g.compose)(Object(Q.a)(null),Object(x.b)({module:"RightSideBar"}),Object(O.connect)((function(e){return{brand:e.question.brand}}),{loadBrand:B.I,loadProfile:Eo.i}))(sa);function ua(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var da=function(e){Object(d.a)(n,e);var t=ua(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"renderAnswers",value:function(){var e=this.props,t=e.resource,n=e.question,c=n.questionType,r=n.collapsedAnswerCount,o=n.answerCount,a=n.isNormal,s=n.status,l=(s=void 0===s?{}:s).isLocked,u=e.question,d=e.location,b=e.answering,h=e.invitationShowCount,p=e.isDrained,f=e.isMuteSpecial,m=e.isMuteFreeze,v="updatedAnswers"===t||p,O="commercial"!==c&&!o;return Object(i.c)("div",{children:[Object(i.b)(Co,{question:u,answering:b}),Object(i.b)(Zc,{question:u}),Boolean(h)&&!f&&!m&&Object(i.b)(Dt.a,{expandCount:h,question:u}),Object(i.b)(uo,{resource:t,question:u,location:d}),a&&!l&&"updatedAnswers"!==t&&p&&!O&&Object(i.b)(x.a,{module:"BottomBar",children:Object(i.b)(lc.d,{children:Object(i.b)(bt,{className:"QuestionAnswers-answerButton",size:"spread"})})}),v&&r>0&&!f&&Object(i.b)(To,{question:u})]})}},{key:"render",value:function(){var e=this.props,t=e.question,n=e.isNormalNotification,c=e.notificationId,r=e.location;return Object(i.c)("div",{className:"Question-main",children:[Object(i.b)("div",{className:"Question-mainColumn",children:n?Object(i.b)(Tr,{location:r,question:t,id:c}):this.renderAnswers()}),Object(i.b)(se.a,{children:Object(i.b)(la,{question:t})})]})}}]),n}(p.PureComponent);da.fetchData=function(e){var t=e.params.id,n=e.route.resource,i=e.location.query,c=i.group_id,r=i.page,o=i.qc,a=e.dispatch,s=e.getState;if(!o&&c)return a(Object(B.S)(c));var l=s(),u=l.env.userAgent,d=Object(st.d)(l),b=5;return u.isBot?b=20:d&&(b=4),a(Object(B.R)(t,n,{offset:Object(gr.c)(Number(r)||1),limit:b}))};var ba=Object(O.connect)((function(e,t){var n=t.params.id,i=t.route.resource,c=t.location.query,r=c.group_id,o=c.qc,a=e.currentUser,s=!o&&r,l=Cr(e,{id:n,resource:i}).isDrained,u=Object(B.eb)(e,{id:n}),d=u.answerCount,b=u.relationship.isAnonymous;return{isNormalNotification:s,notificationId:r,resource:i,question:u,isDrained:l,invitationShowCount:a&&!b&&d<4?d?5:3:0,isBot:e.env.userAgent.isBot,isHuman:Object(st.c)(e),currentUser:Object(L.b)(e),canOia:Object(st.d)(e),shouldOia:Object(st.h)(e),shouldSpecialOia:Object(st.i)(e),referer:Object(st.g)(e),isMuteSpecial:Object(B.E)(u),isMuteFreeze:Object(B.D)(u),ua:Object(st.l)(e),draft:Object(B.n)(e,{id:n})}}))(da),ha=n(1114),pa=n(258),fa=n(171);function ma(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var va=function(e){Object(d.a)(n,e);var t=ma(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={contentRef:null,innerEditingState:!1,isWantToWrite:!1},e.contentRef=Object(p.createRef)(),e.handleCloseComment=function(){var t=e.props,n=t.location,i=n.pathname,c=n.search,r=t.byComment,o=t.router;r&&o.replace({pathname:i,search:c})},e.handleCloseEditing=function(){var t=e.props,n=t.location,i=n.pathname,c=n.query,r=n.hash,o=t.router;window.scrollTo(0,0),"#draft"!==r&&"#write"!==r||o.replace({pathname:i,query:c})},e.handleEditingStateChange=function(t){e.setState({innerEditingState:t})},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.answer.id,n=e.loadContentRightsNotification,i=e.location;e.currentUser&&Object(oe.c)("answer",t,oe.a),this.setState({contentRef:this.contentRef.current,isWantToWrite:Object(mt.f)(i)}),ye.a.get("answer::justPublished")&&(ye.a.delete("answer::justPublished"),n("answer",t))}},{key:"render",value:function(){var e,t=this.props,n=t.question,c=n.id,r=n.relationship,o=r.canCollapseAnswers,a=r.canStickAnswers,s=n.hasPublishingDraft,l=t.answer,u=t.location.hash,d=t.isSearchSpecialSource,b=t.hasLoadedDraft,h=t.isAnswerPage;return(null==l||null===(e=l.question)||void 0===e?void 0:e.id)!==c||l.isDelete?Object(i.b)(ha.a,{to:"/question/".concat(c)}):Object(i.b)(lc.d,{className:"AnswerCard",css:h&&this.state.innerEditingState&&{display:"none"},children:Object(i.b)("div",{className:"QuestionAnswer-content",ref:this.contentRef,tabIndex:0,children:Object(i.b)(pa.d.Provider,{value:this.state.contentRef,children:Object(i.b)(jr.a,{relatedTo:"answer",answer:l,byComment:Object(mn.a)(u),onCloseComment:this.handleCloseComment,onCloseEditing:this.handleCloseEditing,canCollapse:o,canStick:a,editing:b&&this.state.isWantToWrite,editable:!0,canAbstract:!0,expanded:d||!0,hasPublishingDraft:s,itemProp:"mainEntityOfPage",showReviewingLabel:!0,isSearchSpecialSource:d,isAnswerPage:h,onEditingStateChange:this.handleEditingStateChange})})})})}}]),n}(p.Component),Oa=Object(g.compose)(c.withRouter,Ft.a,Object(O.connect)((function(e,t){var n,i,c=e.question,r=(c=void 0===c?{}:c).draftStatus,o=t.answer;return{hasLoadedDraft:!1===(null==r||null===(n=r[null==o||null===(i=o.question)||void 0===i?void 0:i.id])||void 0===n?void 0:n.loading)}}),{loadAnswer:D.n,loadContentRightsNotification:fa.Lb}))(va);function ja(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var ga=function(e){Object(d.a)(n,e);var t=ja(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.isDrained,n=e.items;t||n.length||this.loadItems()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props.question.id,n=e.question.id,i=e.isDrained,c=e.items;n!==t&&!i&&c.length<2&&this.loadItems()}},{key:"loadItems",value:function(){var e=this.props,t=e.question.id,n=e.loadItems;return n(t,"answers",{limit:3})}},{key:"render",value:function(){var e=this.props,t=e.question.relationship.canCollapseAnswers,n=e.items,c=e.isWechat;return Boolean(n.length)&&Object(i.b)(lc.d,{className:"MoreAnswers",children:Object(i.b)(Yc.b,{title:"更多回答","data-zop-feedlist":!0,children:n.map((function(e){return Object(i.b)(Or.a,{children:Object(i.b)(jr.a,{relatedTo:"question",answer:e,canCollapse:t,lastreadTouchable:!0,blockReading:!c})},e.id)}))})})}}]),n}(p.Component),ya=Object(O.connect)((function(e,t){var n=t.question.id,i=t.answerId,c=e.entities.answers,r=e.question.answers[n]||{ids:[],isDrained:!1},o=r.ids;return{isDrained:r.isDrained,items:o.filter((function(e){return e!==Number(i)})).slice(0,2).map((function(e){return c[e]})),isWechat:e.env.userAgent.Wechat}}),{loadAnswer:D.n,loadItems:B.R})(ga),wa=n(950),Ca=n(1016),ka=n(1247),xa=n(121);function Aa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var Ra=function(e){Object(d.a)(n,e);var t=Aa(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props,t=e.items,n=e.author;return t&&t.length?Object(i.c)("div",{className:"AnswerAuthor-item",children:[Object(i.b)("span",{className:"AnswerAuthor-item-icon",children:Object(i.b)(ka.a,{text:!0,center:!0})}),Object(i.b)("div",{className:"AnswerAuthor-item-value",children:Object(i.c)(Ca.CJKSpace,{children:[t.slice(0,3).map((function(e,t){return Object(i.c)("span",{children:[0!==t&&"、",Object(i.b)(Mt.a,{user:e,noBadge:!0,noHoverCard:!0,children:e.name})]},e.urlToken)})),"也关注了",pt.P[n.gender]]})})]}):null}}]),n}(p.Component);Ra.propTypes={author:v.a.object.isRequired};var Sa=Object(g.compose)(Object(O.connect)((function(e,t){var n=t.author;return Object.assign({currentUser:Object(L.b)(e)},n&&function(e,t){var n=t.urlToken||t.id,i=e.people.mutualsByUser[n]||{isDrained:!1,isFetching:!1,ids:[]};return{isDrained:i.isDrained,isFetching:i.isFetching,items:i.ids.map((function(t){var n=Object(xa.d)(e,{id:t});return n.code?null:n})).filter(Boolean)}}(e,{urlToken:n.urlToken}))}),{loadItems:Eo.g}),Object(Xt.a)({shouldLoad:function(e){return e.currentUser&&e.author&&e.author.urlToken&&e.currentUser.urlToken!==e.author.urlToken&&!e.isDrained},load:function(e){return e.loadItems(e.author.urlToken,"mutuals")}}))(Ra),Na=n(955),Ta=n(945);function qa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var Ba=function(e){return e&&void 0!==e.answerCount&&"undefined"!=typeof articlesCount&&"undefined"!=typeof followerCount&&void 0!==e.badge};var Qa=function(e){Object(d.a)(n,e);var t=qa(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.nextItem()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.answer.author.urlToken!==e.answer.author.urlToken&&this.nextItem(e)}},{key:"componentDidUpdate",value:function(e){!e.user&&this.props.user&&this.props.onLoad&&this.props.onLoad()}},{key:"nextItem",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=e.answer.author.urlToken,n=e.loadProfile,i=e.isDrained;t&&(i||n(t))}},{key:"render",value:function(){var e,t=this.props,n=t.user,c=t.isSelf;if(!n)return null;var r=n.urlToken,o=n.isOrg,a=n.headline,s=n.badge,l=n.badgeV2,u=n.answerCount,d=n.articlesCount,b=n.followerCount,h=he.e(l||s),p=h.identity,f=h.bestAnswerer,m=h.baike,v=o?"org":"people";return Object(i.c)(lc.d,{className:"AnswerAuthor",role:"complementary","aria-label":"关于作者",children:[Object(i.b)(lc.b,{className:"AnswerAuthor-title",children:"关于作者"}),Object(i.b)(lc.c,{children:Object(i.c)("div",{className:"AnswerAuthor-user",children:[Object(i.b)("div",{className:"AnswerAuthor-user-avatar",children:Object(i.b)(Na.a,{user:n,avatarProps:{size:60},noHoverCard:!0})}),Object(i.c)("div",{className:"AnswerAuthor-user-content",children:[Object(i.b)("div",{className:"AnswerAuthor-user-name",children:Object(i.b)(Ta.a,{user:n,noBadge:!0,noHoverCard:!0})}),a&&Object(i.b)("div",{className:"AnswerAuthor-user-headline",children:Object(i.b)(Lt.a,{html:a})})]})]})}),Object(i.c)(lc.c,{children:[p&&Object(i.c)("div",{className:"AnswerAuthor-item",children:[Object(i.b)("a",{className:"AnswerAuthor-item-icon",href:"/account/verification/intro",target:"_blank",children:Object(i.b)(he.a,{center:!0,size:19})}),Object(i.b)("div",{className:"AnswerAuthor-item-value",children:p.slice(0,2).map((function(e){return e.description})).join("，")})]}),Boolean(null==f||null===(e=f.topics)||void 0===e?void 0:e.length)&&Object(i.c)("div",{className:"AnswerAuthor-item",children:[Object(i.b)("span",{className:"AnswerAuthor-item-icon",children:Object(i.b)(he.b,{center:!0,size:19})}),Object(i.c)("div",{children:[Object(i.b)(wa.a,{topics:f.topics,user:n,noHoverCard:!0}),"的优秀答主"]})]}),Boolean(m)&&Object(i.c)("div",{className:"AnswerAuthor-item",children:[Object(i.b)("span",{className:"AnswerAuthor-item-icon",children:Object(i.b)(he.d,{center:!0,size:19})}),Object(i.b)("div",{children:m.description})]}),n&&!c&&Object(i.b)(Sa,{author:n})]}),r&&Object(i.c)(lc.c,{children:[Object(i.b)("div",{className:"AnswerAuthor-counts",children:Object(i.c)(Gt.a,{children:[Object(i.b)(Gt.a.Item,{tag:at.a,preset:"plain",to:"/".concat(v,"/").concat(r,"/answers"),name:"回答",value:u,"data-za-detail-view-element_name":"Answer"}),Object(i.b)(Gt.a.Item,{tag:at.a,preset:"plain",to:"/".concat(v,"/").concat(r,"/posts"),name:"文章",value:d,"data-za-detail-view-element_name":"Post"}),Object(i.b)(Gt.a.Item,{tag:at.a,preset:"plain",to:"/".concat(v,"/").concat(r,"/followers"),name:"关注者",value:b,"data-za-detail-view-element_name":"Follower"})]})}),!c&&Object(i.b)(ta.a,{className:"AnswerAuthor-buttons",user:n})]})]})}}]),n}(p.Component),Ia=Object(O.connect)((function(e,t){var n=t.answer,i=n.author,c=n.author.urlToken,r=e.entities.users,o=c?r[c]:i;return{currentUser:Object(L.b)(e),isDrained:Ba(o),user:o,isSelf:Object(L.i)(e,o)}}),{loadProfile:Eo.i})(Qa),Pa=n(920),Ea=n(1289);function za(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var La=function(e){Object(d.a)(n,e);var t=za(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).load=function(){var t=e.props,n=t.answer.id;(0,t.loadAnswerFavlists)(n)},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props,t=e.items,n=e.count,c=e.isFetching,r=e.isDrained;return Object(i.c)("div",{className:"AnswerFavlists",children:[Object(i.b)("div",{className:"AnswerFavlists-header",children:Object(i.c)("div",{className:"AnswerFavlists-title",children:["被收藏 ",Object(xe.formatNumber)(n)," 次"]})}),!(r&&!t.length)&&Object(i.b)(uc.b,{className:"AnswerFavlists-list",isLocal:!0,isLoading:c,isDrained:r,onLoad:this.load,getContainer:function(e){return e},placeholder:Object(i.b)(uc.a,{className:"AnswerFavlists-item",small:!0}),children:t.map((function(e){var t=e.id,n=e.type,c=e.creator,r=e.isFollowing,o=e.answerCount,a=e.followerCount;return Object(i.b)(Yc.a,{children:Object(i.b)(Ea.a,{favlist:e,action:Object(i.b)(ht.a,{preset:"primary",id:t,type:n,isFollowing:r}),status:Object(i.c)(Pa.d,{children:[Object(i.c)("span",{children:["由"," ",Object(i.b)(Mt.a,{user:c,noBadge:!0,noHoverCard:!0,target:"_blank"})," ","创建"]}),Object(i.c)("span",{children:[Object(xe.formatNumber)(o)," 条内容"]}),Object(i.c)("span",{children:[Object(xe.formatNumber)(a)," 人关注"]})]})})},t)}))})]})}}]),n}(p.Component),Ma=Object(g.compose)(Object(O.connect)((function(e,t){var n=t.answer.id,i=e.entities.favlists,c=e.answers.favlists[n]||{isFetching:!1,isDrained:!1,totals:0,ids:[]};return{items:c.ids.map((function(e){return i[e]})),count:c.totals,isFetching:c.isFetching,isDrained:c.isDrained}}),{loadAnswerFavlists:D.s}),Object(x.b)({module:"CollectionList"}))(La),Da=n(991);function Fa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var Ha=function(e){Object(d.a)(n,e);var t=Fa(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).load=function(){var t=e.props,n=t.answer.id;(0,t.loadAnswerCopyrightApplicants)(n)},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props,t=e.items,n=e.count,c=e.isFetching,r=e.isDrained;return Object(i.c)("div",{className:"AnswerCopyrightApplicants",children:[Object(i.b)("div",{className:"AnswerCopyrightApplicants-header",children:Object(i.c)("div",{className:"AnswerCopyrightApplicants-title",children:["授权转载 ",Object(xe.formatNumber)(n)," 次"]})}),!(r&&!t.length)&&Object(i.b)(uc.b,{className:"AnswerCopyrightApplicants-list",isLocal:!0,isLoading:c,isDrained:r,onLoad:this.load,getContainer:function(e){return e},placeholder:Object(i.b)(uc.a,{className:"AnswerCopyrightApplicants-item",small:!0}),children:t.map((function(e){var t=e.applier,n=e.accountType,c=e.accountUsername,r=e.createdAt;return Object(i.b)("div",{className:"AnswerCopyrightApplicants-item",children:Object(i.b)(Da.a,{user:t,meta:"".concat(n," ").concat(c),status:null,action:Object(i.c)("div",{className:"AnswerCopyrightApplicants-time",children:["申请于 ",Object(A.toDateString)(r)]})})},"".concat(t.name,".").concat(r))}))})]})}}]),n}(p.Component),_a=Object(O.connect)((function(e,t){var n=t.answer.id,i=e.entities.copyrightApplicants,c=e.answers.copyrightApplicants[n]||{isFetching:!1,isDrained:!1,totals:0,ids:[]};return{items:c.ids.map((function(e){return i[e]})),count:c.totals,isFetching:c.isFetching,isDrained:c.isDrained}}),{loadAnswerCopyrightApplicants:D.q})(Ha);function Ua(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var Va=function(e){Object(d.a)(n,e);var t=Ua(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props.copyrightApplicant,t=e.applier,n=e.accountType,c=e.accountUsername,r=e.createdAt;return Object(i.c)("div",{className:"AnswerInfo-copyright-applicant",children:[Object(i.b)(Mt.a,{user:t,noBadge:!0,noHoverCard:!0,target:"_blank"}),"，",n," ",c]},"".concat(t.name,".").concat(r))}}]),n}(p.Component);function Ga(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var Wa=function(e){Object(d.a)(n,e);var t=Ga(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props.copyrightApplicants;return Object(i.b)(lc.c,{className:"AnswerInfo-copyright-applicants",children:e.map((function(e,t){return Object(i.b)(Va,{copyrightApplicant:e},t)}))},"content")}}]),n}(p.Component);function Ka(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var Ja=function(e){Object(d.a)(n,e);var t=Ka(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props.favlist,t=e.id,n=e.title,c=e.followerCount,r=e.creator;return Object(i.c)("div",{className:"AnswerInfo-favlist",children:[Object(i.b)("div",{className:"AnswerInfo-favlist-title",children:Object(i.b)(at.a,{preset:"plain",a:!0,to:"/collection/".concat(t),target:"_blank","data-za-detail-view-element_name":"Collection",title:n,children:n})}),Object(i.c)("div",{className:"AnswerInfo-favlist-author",children:[Object(i.b)(Mt.a,{user:r,noBadge:!0,noHoverCard:!0,target:"_blank","data-za-detail-view-element_name":"Author"})," ","创建"]}),Object(i.c)("div",{className:"AnswerInfo-favlist-followers",children:[Object(xe.formatNumber)(c)," 人关注"]})]},t)}}]),n}(p.Component),Za=Object(x.b)((function(e){var t=e.favlist;return{module:"CollectionItem",content:{type:"Collection",token:String(t.id),follower_num:t.followerCount,author_member_hash_id:t.creator.id},trackCardShow:!0}}))(Ja);function Ya(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var $a=function(e){Object(d.a)(n,e);var t=Ya(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props.favlists;return Object(i.b)(lc.c,{className:"AnswerInfo-favlists",children:e.map((function(e){return Object(i.b)(Za,{favlist:e},e.id)}))},"content")}}]),n}(p.Component),Xa=Object(x.b)({module:"CollectionList"})($a);function es(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var ts=function(e){Object(d.a)(n,e);var t=es(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={copyrightApplicantsModalShown:!1,favlistsModalShown:!1},e.handleCopyrightApplicantsModalShow=function(){ie.a.trackEvent(Object(nt.a)(e),{action:"Click",element:"Button",name:"转载授权"}),e.setState({copyrightApplicantsModalShown:!0})},e.handleCopyrightApplicantsModalHide=function(){e.setState({copyrightApplicantsModalShown:!1})},e.handleFavlistsModalShow=function(){ie.a.trackEvent(Object(nt.a)(e),{action:"Click",element:"Button",name:"被收藏"}),e.setState({favlistsModalShown:!0})},e.handleFavlistsModalClose=function(){e.setState({favlistsModalShown:!1})},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.answer.id,n=e.copyrightApplicants,i=e.favlists,c=e.loadAnswerCopyrightApplicants,r=e.loadAnswerFavlists;n.length||i.length||(c(t),r(t))}},{key:"componentDidUpdate",value:function(e){this.props.onLoad&&(!e.copyrightApplicants.length&&this.props.copyrightApplicants.length||!e.favlists.length&&this.props.favlists.length)&&this.props.onLoad()}},{key:"render",value:function(){var e=this.props,t=e.answer,n=e.copyrightApplicants,c=e.copyrightApplicantCount,r=e.favlists,o=e.favlistCount,a=this.state,s=a.favlistsModalShown,l=a.copyrightApplicantsModalShown;return n.length||r.length?Object(i.c)(lc.d,{role:"complementary","aria-label":"更多回答信息",children:[Boolean(n.length)&&[Object(i.c)(lc.b,{className:"AnswerInfo-title",children:["授权转载"," ",Object(i.b)(X.c,{preset:"plain",onClick:this.handleCopyrightApplicantsModalShow,children:Object(xe.formatNumber)(c)})," ","次"]},"header"),Object(i.b)(Wa,{copyrightApplicants:n.slice(0,5)},"content")],Boolean(r.length)&&[Object(i.c)(lc.b,{className:"AnswerInfo-title",children:["被收藏"," ",Object(i.b)(X.c,{preset:"plain",onClick:this.handleFavlistsModalShow,children:Object(xe.formatNumber)(o)})," ","次"]},"header"),Object(i.b)(Xa,{favlists:r.slice(0,5)},"content")],Object(i.b)(Vt.b,{size:"fullPage",onClose:this.handleFavlistsModalClose,children:s&&Object(i.b)(Ma,{answer:t})}),Object(i.b)(Vt.b,{size:"fullPage",onClose:this.handleCopyrightApplicantsModalHide,children:l&&Object(i.b)(_a,{answer:t})})]}):null}}]),n}(p.Component),ns=Object(O.connect)((function(e,t){var n=t.answer.id,i=e.entities,c=i.copyrightApplicants,r=i.favlists,o=e.answers.copyrightApplicants[n]||{totals:0,ids:[]},a=e.answers.favlists[n]||{totals:0,ids:[]};return{copyrightApplicants:o.ids.map((function(e){return c[e]})),copyrightApplicantCount:o.totals,favlists:a.ids.map((function(e){return r[e]})),favlistCount:a.totals}}),{loadAnswerCopyrightApplicants:D.q,loadAnswerFavlists:D.s})(ts);function is(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var cs=function(e){Object(d.a)(n,e);var t=is(n);function n(){var e;Object(l.a)(this,n);for(var i=arguments.length,c=new Array(i),r=0;r<i;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).sidebarRef=Object(p.createRef)(),e.onHeightChange=function(){e.dynamicSticky&&e.dynamicSticky.check()},e}return Object(u.a)(n,[{key:"shouldComponentUpdate",value:function(e){return e.answer.id!==this.props.answer.id}},{key:"render",value:function(){var e=this,t=this.props,n=t.question,c=t.question,r=c.id,o=c.questionType,a=t.answer,s=Object(D.m)(a)||Object(D.k)(a);return Object(i.b)(Io.a,{className:"Question-sideColumn Question-sideColumn--sticky",onRef:this.sidebarRef,offset:pt.i+10,ref:function(t){e.dynamicSticky=t},children:Object(i.c)(Po.a,{sidebarRoot:this.sidebarRef,selector:".Card",children:[Object(i.b)(Bo.a,{type:"question"}),s||"normal"===o&&437329650!==r&&Object(i.b)("div",{className:"Question-sideColumnAdContainer",children:Object(i.b)(qo.a,{isMobile:!1,id:"question/".concat(r,"/answer/").concat(a.id),location:"new_answer_up",query:{question_token:r,answer_token:a.id},onHeightChange:this.onHeightChange})}),"commercial"===o&&Object(i.b)(ea.a,{questionId:r}),a.author&&Object(i.b)(Ia,{answer:a,onLoad:this.onHeightChange}),Object(i.b)(ra,{}),Object(i.b)(ns,{answer:a,onLoad:this.onHeightChange}),Object(i.b)(oa,{}),Object(i.b)(Yi,{id:r,question:n,position:"right"}),s||"normal"===o&&Object(i.b)(Ho,{question:n,onLoad:this.onHeightChange}),s||"normal"===o&&Object(i.b)(Xo,{answer:a,question:n,onLoad:this.onHeightChange}),s||"normal"===o&&437329650!==r&&Object(i.b)("div",{children:Object(i.b)(qo.a,{isMobile:!1,id:"question/".concat(r,"/answer/").concat(a.id),location:"new_answer_down_sticky",query:{question_token:r,answer_token:a.id},delay:1e3,onHeightChange:this.onHeightChange})}),Object(i.b)(Qo.a,{})]})})}}]),n}(p.Component),rs=Object(g.compose)(Object(Q.a)(null),Object(x.b)((function(e){var t=e.answer;return{module:"RightSideBar",content:Object.assign({},t.author&&{member_hash_id:t.author.id})}})))(cs);function os(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var as=function(e,t){return t.showAllDescription.replace("{count}"," ".concat(e," "))},ss=function(e){Object(d.a)(n,e);var t=os(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props,t=e.to,n=e.itemNum,c=e.questionType,r=(e.bottom,e.brand);return Object(i.b)(lc.d,{className:re()("ViewAll",{"ViewAll--bottom":!1}),children:Object(i.b)($c.a,{className:"ViewAll-QuestionMainAction",to:t,"data-za-detail-view-element_name":"ViewAll",style:{},children:"commercial"===c&&null!=r&&r.showAllDescription?as(Object(xe.formatNumber)(n),r):"查看全部 ".concat(Object(xe.formatNumber)(n)," 个回答")})})}}]),n}(p.Component),ls=Object(x.b)((function(e){return{module:"MessageItem",content:{item_num:e.itemNum}}}))(ss),us=n(1193),ds=Object.assign;var bs=function(e){return f.a.createElement(Ne.a,ds({width:"43",height:"50",fill:"none",viewBox:"0 0 43 50"},e),f.a.createElement("path",{fill:"#121212",d:"M23.376 45.237c-1.567 0-3.133.012-4.698 0a1.701 1.701 0 00-1.133.386 507.16 507.16 0 01-4.493 3.517 3.959 3.959 0 01-.694.449 1.305 1.305 0 01-1.792-1.537c.239-.737.477-1.47.744-2.192.158-.42.153-.597-.384-.68-1.963-.3-3.672-1.093-4.879-2.756a7.614 7.614 0 01-1.272-2.983c-.098-.477-.238-.455-.651-.317-.625.212-.783.568-.601 1.16.041.155.057.316.047.477a.988.988 0 01-.806 1.03.954.954 0 01-1.162-.589c-.115-.257-.189-.417-.527-.408a1.009 1.009 0 01-1.003-.701c-.188-.463.015-.828.337-1.112.238-.22.238-.356.067-.625a1.023 1.023 0 01.238-1.432.98.98 0 011.377.203c.293.348.542.344.966.227 1.315-.365 1.974-1.088 1.99-2.534.015-1.239.346-2.467.494-3.706.158-1.314-.1-2.61-.258-3.905-.205-1.67-.477-3.34-.742-4.992-.136-.89.44-1.462 1.325-1.312 1.119.186 1.104.183 1.255-.955.224-1.689.45-3.376.715-5.058a1.102 1.102 0 00-.522-1.243C5.336 12.284 4.34 10.273 3.93 7.954c-.462-2.57.65-4.554 2.53-6.175C8.34.156 10.609-.166 12.993.068a11.67 11.67 0 013.884 1.028 5.311 5.311 0 012.147 1.728c.303.436.645.541 1.138.539 4.362-.017 8.721 0 13.08 0 1.776 0 3.415.413 4.813 1.563 2.04 1.67 2.784 3.87 2.558 6.442-.009.08-.023.16-.04.239-.178.954-.21 1.655.715 2.479a4.5 4.5 0 01.386 6.15 13.421 13.421 0 01-2.2 2.246 1.322 1.322 0 00-.548.928c-.604 4.355-1.267 8.7-1.814 13.06-.539 4.327-3.407 7.65-7.566 8.59-.876.169-1.768.235-2.66.198H23.38l-.003-.021z"}),f.a.createElement("path",{fill:"#FEFEFE",d:"M12.394 47.606c.441-1.293.809-2.417 1.21-3.526.136-.377 0-.442-.335-.444-.715 0-1.431-.019-2.147-.07-1.346-.095-2.458-.698-3.412-1.624a1.357 1.357 0 01-.425-1.105c.046-.93.062-1.863.062-2.794a.614.614 0 01.492-.692c.513-.148 1.014-.338 1.517-.517.442-.156.642-.478.509-.929-.144-.477-.537-.532-.955-.41-.322.09-.64.21-.954.31-.403.13-.601 0-.592-.446.02-.89 0-1.782.024-2.675.05-2.944-.33-5.85-.775-8.751-.02-.117-.043-.239-.055-.351-.046-.535.086-.659.606-.53 1.095.267 2.2.504 3.278.833 1.67.51 3.329.365 4.975-.1 1.97-.559 3.798-1.473 5.64-2.343a1.038 1.038 0 00.604-.955c.072-1.047.16-2.095.238-3.14.048-.61.184-.715.747-.477 1.625.628 3.252 1.25 4.865 1.909a3.12 3.12 0 002.195.074c1.73-.558 3.348-1.413 5.018-2.114.745-.306.768-.306 1.074.458.532 1.322 1.038 2.653 1.603 3.963.191.444.079.695-.265.954a37.672 37.672 0 01-4.576 2.976c-.833.463-.883.568-.716 1.517.838 4.57 1.217 9.189 1.556 13.813a1.209 1.209 0 01-.44 1.085c-1.631 1.494-3.552 2.148-5.752 2.148-3.101-.029-6.184 0-9.276 0a1.432 1.432 0 00-1 .374c-1.436 1.179-2.93 2.317-4.538 3.58z"}),f.a.createElement("path",{fill:"#06F",d:"M32.376 15.823a3.172 3.172 0 00-.04-.366c-.284-1.171.035-2.087 1.026-2.834.584-.441.61-.926.293-1.403s-.78-.573-1.45-.239c-.24.122-.299.072-.356-.157a1.583 1.583 0 00-.212-.477.936.936 0 00-1.14-.408.995.995 0 00-.693 1.062c.023.211.06.42.112.627-.365-.05-.69-.239-1.05-.086a.99.99 0 00-.675.759.869.869 0 00.415.973c.392.239.802.427 1.215.62a.548.548 0 01.394.52c.023.655.076 1.308.133 1.957a.46.46 0 01-.327.542 2.832 2.832 0 01-2.343.05c-1.894-.8-3.817-1.517-5.743-2.26-.97-.376-1.536-.028-1.63 1.005-.114 1.262-.238 2.524-.312 3.791a.809.809 0 01-.51.78c-1.797.83-3.594 1.67-5.56 2.031a6.441 6.441 0 01-2.708-.06c-.752-.176-1.494-.398-2.248-.555-.36-.075-.439-.24-.39-.568.28-1.922.552-3.843.813-5.765.043-.322.183-.418.477-.336.424.112.871.104 1.29-.024.492-.132.82.045 1.163.365a8.126 8.126 0 003.209 1.849c.828.239 1.243-.11 1.08-.954-.142-.738-.262-1.482-.443-2.212a1 1 0 01.334-1.093 17.656 17.656 0 002.758-3.34c.821-1.272 1.265-2.642.954-4.171-.083-.418.063-.506.451-.506 4.18.012 8.363 0 12.544.012 1.708 0 3.242.477 4.435 1.782 1.29 1.42 1.484 3.102 1.336 4.94-.095 1.176-.522 1.791-1.732 2.147-1.489.434-2.878 1.21-4.309 1.837-.17.1-.363.157-.56.165z"}),f.a.createElement("path",{fill:"#FEFEFE",d:"M14.94 15.307c-.871-.3-1.477-.87-2.088-1.431-.318-.291-.685-.477-1.129-.392-1.88.404-3.219-.587-4.4-1.806-1.479-1.53-2.2-3.426-1.892-5.538.33-2.25 2.699-4.328 4.99-4.56 1.838-.206 3.7.034 5.425.702 2.83 1.107 3.775 3.844 2.207 6.442a15.454 15.454 0 01-3.102 3.656.992.992 0 00-.367 1.143c.153.56.231 1.147.356 1.784z"}),f.a.createElement("path",{fill:"#06F",d:"M35.01 38.244a128.668 128.668 0 00-.763-7.824 60.35 60.35 0 00-.527-3.464.584.584 0 01.324-.716c.842-.52 1.67-1.062 2.51-1.59.146-.09.296-.295.463-.197.167.098.088.36.064.544-.226 1.652-.455 3.299-.687 4.939-.362 2.507-.73 5.014-1.105 7.523a1.38 1.38 0 01-.279.785z"}),f.a.createElement("path",{fill:"#B7B7B6",d:"M37.792 17.19c-.238-.239-.353-.392-.303-.6 0-.03.13-.073.139-.061a.98.98 0 01.164.66z"}),f.a.createElement("path",{fill:"#121212",d:"M20.92 27.309c.025.954-.488 1.479-1.43 1.5-.943.022-1.633-.615-1.64-1.56-.007-.945.697-1.53 1.804-1.546.9-.012 1.231.42 1.267 1.606z"}),f.a.createElement("path",{fill:"#444",d:"M11.938 5.575c.172-.137.35-.265.537-.382a.804.804 0 011.178.294c.378.652.654 1.358.816 2.094.1.38-.176.432-.43.492-.252.06-.522.112-.6-.265-.094-.444-.172-.895-.308-1.329-.079-.255-.131-.656-.563-.518-.396.124-.477.416-.31.802.183.44.312.897.491 1.336.217.535-.2.623-.518.728-.317.105-.749.339-.93-.239a33.209 33.209 0 01-.897-3.567c-.098-.477.26-.553.584-.651.325-.098.575-.045.673.348.072.289.074.6.277.857zM9.266 9.09l.954-.356c.191-.067.356-.048.442.165a.32.32 0 01-.047.376.322.322 0 01-.11.077 9.983 9.983 0 01-2.172.775c-.446.093-.675-.238-.525-.715.22-.697.477-1.38.733-2.09-.332-.077-.616.095-.912.166-.186.046-.358.074-.453-.143a.354.354 0 01.179-.5c.67-.302 1.4-.445 2.133-.42.415.018.551.338.422.737-.196.591-.398 1.188-.644 1.927zm6.461-1.544c-.289.043-.458-.096-.55-.39-.15-.477-.238-.954-.355-1.43-.152-.597.208-.74.626-.862.46-.136.57.212.684.537.115.324.253.715.377 1.059.25.704-.002 1.064-.782 1.086z"}),f.a.createElement("path",{fill:"#4A4B4A",d:"M15.037 3.055a.77.77 0 01.75.77.728.728 0 01-.779.745.716.716 0 01-.741-.751c.028-.485.324-.707.77-.764z"}))},hs=Object.assign;var ps=function(e){return f.a.createElement(Ne.a,hs({width:"14",height:"14",fill:"none",viewBox:"0 0 14 14"},e),f.a.createElement("mask",{id:"id-628033106-a",width:"14",height:"14",x:"0",y:"0",maskUnits:"userSpaceOnUse"},f.a.createElement("path",{fill:"#fff",d:"M.001.014h13.985V14H.001V.014z",fillRule:"evenodd",clipRule:"evenodd"})),f.a.createElement("g",{mask:"url(#id-628033106-a)"},f.a.createElement("path",{fill:"#121212",d:"M2.543 8.278a.636.636 0 010 1.272h-.636A1.907 1.907 0 010 7.643V1.92C0 .868.854.014 1.907.014H7.63c1.053 0 1.907.854 1.907 1.907v.636a.636.636 0 01-1.271 0V1.92a.636.636 0 00-.636-.636H1.907a.636.636 0 00-.636.636v5.722c0 .35.285.635.636.635h.636zm3.814-3.814h5.722c1.053 0 1.907.854 1.907 1.907v5.722A1.907 1.907 0 0112.08 14H6.357a1.907 1.907 0 01-1.907-1.907V6.37c0-1.053.854-1.907 1.907-1.907zm0 1.271a.636.636 0 00-.635.636v5.722c0 .35.284.636.635.636h5.722a.636.636 0 00.636-.636V6.37a.636.636 0 00-.636-.636H6.357z",fillRule:"evenodd",clipRule:"evenodd"})))},fs=Object.assign;var ms=function(e){return f.a.createElement(Ne.a,fs({width:"15",height:"14",fill:"none",viewBox:"0 0 15 14"},e),f.a.createElement("path",{fill:"#121212",d:"M3.55 14c-.106 0-.159 0-.265-.053a.583.583 0 01-.318-.53v-2.225H.954A.95.95 0 010 10.238V.965A.95.95 0 01.954.01h12.982a.95.95 0 01.954.954v9.273a.95.95 0 01-.954.954H7.418l-3.497 2.702c-.106.053-.212.106-.37.106zm-2.49-3.921h2.437c.318 0 .53.212.53.53v1.854l2.914-2.225c.106-.053.212-.106.318-.106h6.518V1.124H1.06v8.955z",fillRule:"evenodd",clipRule:"evenodd"}),f.a.createElement("path",{fill:"#121212",d:"M3.709 4.515h7.948v-1.06H3.71v1.06zm0 3.18h4.239v-1.06H3.709v1.06z",fillRule:"evenodd",clipRule:"evenodd"}))},vs=Object.assign;var Os=function(e){return f.a.createElement(Ne.a,vs({width:"16",height:"16",fill:"none",viewBox:"0 0 16 16"},e),f.a.createElement("mask",{id:"id-95574191-a",width:"16",height:"16",x:"0",y:"0",maskUnits:"userSpaceOnUse"},f.a.createElement("path",{fill:"#fff",d:"M.001.016h15.983V16H.001V.016z",fillRule:"evenodd",clipRule:"evenodd"})),f.a.createElement("g",{mask:"url(#id-95574191-a)"},f.a.createElement("path",{fill:"#121212",d:"M7.992.016C3.585.016 0 3.6 0 8.008a7.96 7.96 0 001.344 4.435.521.521 0 00.867-.58 6.915 6.915 0 01-1.169-3.855 6.958 6.958 0 016.95-6.95 6.958 6.958 0 016.95 6.95 6.958 6.958 0 01-6.95 6.95 6.917 6.917 0 01-3.865-1.175.522.522 0 00-.58.866A7.956 7.956 0 007.992 16c4.407 0 7.992-3.585 7.992-7.992S12.4.016 7.992.016zM5.046 8.368c-.221 0-.332-.096-.332-.29V7.29c0-.216.111-.323.332-.323h2.167a4.28 4.28 0 01-.394 1.401H5.046zm3.14-1.401h2.746a.47.47 0 01.28.071c.058.041.086.125.086.252v.845c0 .155-.12.233-.366.233H7.873a8.4 8.4 0 00.314-1.401zm-2.964 3.316c-.386.266-.945.508-1.677.727v.822c.301-.032.542-.069.722-.11a4.708 4.708 0 001.63-.774c.558-.409 1.07-.976 1.54-1.701h.712v1.615c0 .33.098.572.294.727.178.143.404.214.68.214h3.206V10.9H9.426c-.126 0-.218-.023-.275-.07-.054-.045-.079-.142-.076-.29l.005-1.293h2.166a.98.98 0 00.703-.261c.155-.149.233-.376.233-.68V7.03c0-.311-.085-.545-.256-.704-.105-.098-.268-.172-.49-.223l.252-.58c.073-.168.11-.308.11-.422a.823.823 0 00-.276-.608c-.187-.187-.444-.28-.77-.28h-5.14l.137-.47h-.893c-.161.449-.327.778-.498.987-.206.257-.447.412-.723.466v.907a2.96 2.96 0 00.908-.404 3 3 0 00.622-.608h5.221c.188 0 .304.013.352.038.073.038.109.092.109.162s-.03.175-.095.318l-.21.46H5.09c-.478 0-.805.083-.983.248-.187.177-.28.43-.28.76V8.26c0 .491.202.804.607.94.096.032.288.048.576.048h1.287c-.37.46-.728.805-1.074 1.036z",fillRule:"evenodd",clipRule:"evenodd"})))};function js(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=Object(h.a)(e);if(t){var c=Object(h.a)(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return Object(b.a)(this,n)}}var gs=function(e){Object(d.a)(n,e);var t=js(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.answer,n=e.params.answerId,i=e.loadAnswer,c=e.currentUser,r=e.checkIfCanConvertToVessay;t||i(n),Object(us.a)(c,null==t?void 0:t.author)&&r(n)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props.params.answerId,n=e.params.answerId,i=e.loadAnswer;n!==t&&i(n)}},{key:"render",value:function(){if(!this.props.answer)return null;var e=this.props,t=e.answer,n=e.answer.id,c=e.question,r=e.question,o=r.id,a=r.answerCount,s=r.questionType,l=r.brand,u=e.location,d=e.isMuteSpecial,b=(e.currentUser||{}).userType;return!t.relationship.isAuthor&&t.visibleOnlyToAuthor?Object(i.b)(q,{}):Object(i.c)("div",{className:"Question-main",children:[Object(i.b)(y.a,{meta:Object(E.a)(t,c.topics)}),Object(i.b)(pa.b,{selector:[".ViewAll-QuestionMainAction",".QuestionAnswer-content",".List-item"].join(","),children:Object(i.c)("div",{className:"Question-mainColumn","data-zop-questionanswerlist":!0,children:[("guest"===b||!b)&&Object(i.c)("div",{className:"Question-mainColumnLogin",children:[Object(i.b)("div",{className:"Question-mainColumnLoginImg",children:Object(i.b)(bs,{})}),Object(i.c)("div",{className:"Question-mainColumnLoginContent",children:[Object(i.b)("div",{className:"Question-mainColumnLoginTitle",children:"登录后你可以"}),Object(i.c)("div",{className:"Question-mainColumnLoginDes",children:[Object(i.c)("span",{className:"Question-mainColumnLoginDesIcon",children:[Object(i.b)(ps,{}),"不限量看优质回答"]}),Object(i.c)("span",{className:"Question-mainColumnLoginDesIcon",children:[Object(i.b)(ms,{}),"私信答主深度交流"]}),Object(i.c)("span",{className:"Question-mainColumnLoginDesIcon",children:[Object(i.b)(Os,{}),"精彩内容一键收藏"]})]})]}),Object(i.b)("div",{className:"Question-mainColumnLoginRightButton",children:Object(i.b)(H.b,{loginButton:Object(i.b)(X.c,{className:"Question-mainColumnLoginButton",children:"登录"})})})]}),Object(D.m)(t)||Object(D.k)(t)||a>0&&!d&&Object(i.b)(ls,{itemNum:a,to:"/question/".concat(o),questionType:s,brand:l}),Object(i.b)(Oa,{question:c,location:u,answer:t,isAnswerPage:!0}),Object(D.m)(t)||Object(D.k)(t)||Object(i.b)(ya,{question:c,answerId:n}),a>0&&!d&&Object(i.b)(ls,{itemNum:a,to:"/question/".concat(o),questionType:s,brand:l})]})}),Object(i.b)(se.a,{children:Object(i.b)(rs,{question:c,answer:t})})]})}}]),n}(p.Component);gs.fetchData=function(e){var t=e.dispatch,n=e.params.answerId;return t(Object(D.n)(n))};var ys=Object(O.connect)((function(e,t){var n=t.params,i=n.id,c=n.answerId,r=Object(B.eb)(e,{id:i}),o=Object(D.c)(e,{id:c}),a=Object(L.b)(e),s=(r||{}).relationship||{myAnswer:{isDelete:!1}};return{question:r,isOffice:Object(st.e)(e),answer:o&&Object.assign(Object.assign({},o),{},{isDelete:(o.relationship||{}).isAuthor&&(s.myAnswer||{}).isDeleted}),isMuteSpecial:Object(B.E)(r),currentUser:a}}),{loadAnswer:D.n,checkIfCanConvertToVessay:D.e})(gs),ws=n(236),Cs=n(471),ks=function(e){var t=e.handleTabChange,n=e.activeTabKey,c=e.isReediting,r=e.videoAnswerPublished,o=Object(O.useSelector)(ws.a);return Object(i.b)(j.b,{block:"AnswerEditorPageHeader",children:Object(i.c)(w.Box,{bg:"GBK99A",css:{position:"relative",width:"100%",height:"52px",backgroundClip:"content-box",boxShadow:"0px 16px 32px rgba(0, 0, 0, 0.04)",zIndex:1},children:[Object(i.c)(w.Flex,{css:{position:"relative",width:"1000px",height:"52px",padding:"0 16px",margin:"0 auto",alignItems:"center"},children:[Object(i.b)(Cs.a,{}),Object(i.b)(w.Box,{height:"28px",width:"1px",pl:"20px",sx:{borderRight:"1px solid",borderColor:"GBK09A"}}),c?Object(i.b)(w.Box,{fontSize:15,fontWeight:"bold",lineHeight:"21px",color:"GBK03A",pl:"20px",children:r?"本回答为视频回答":"本回答为图文回答"}):Object(i.b)(fo.b,{activeTabKey:n,onChange:t})]}),Object(i.b)(w.Box,{css:{position:"absolute",top:"50%",left:"50%",transform:"translate(522px, -50%)"},children:Object(i.b)(ve.a,{currentUser:o})})]})})},xs=n(293),As=n(70),Rs=n.n(As),Ss=n(439),Ns=function(e,t){window.onbeforeunload=null,window.name="",requestAnimationFrame((function(){var n=window.location.host,i=t?"//".concat(n,"/question/").concat(e,"/answer/").concat(t):"//".concat(n,"/question/").concat(e);window.location.href=i}))},Ts=function(e){var t,n=e.params,c=e.location,o=n.id,a=n.answerId,s=c.query,l=Object(O.useDispatch)(),u=Object(p.useRef)(null),d=Object(O.useSelector)((function(e){return Object(B.eb)(e,{id:o})})),b=s.attach_to_article,h=Object(O.useSelector)((function(e){var t;return null===(t=e.entities.drafts)||void 0===t?void 0:t["question_".concat(o)]})),f=Object(O.useSelector)((function(e){return Object(D.c)(e,{id:a})})),m=["zvideo","video"].includes(null==f||null===(t=f.attachment)||void 0===t?void 0:t.type),v=Object(p.useState)("video_answer"===(null==h?void 0:h.draftType)?fo.a.videoAnswer:fo.a.textAnswer),g=Object(r.a)(v,2),y=g[0],C=g[1],k=Object(p.useState)((function(){return Object(tc.c)("QuestionAnswerEditable")})),A=Object(r.a)(k,1)[0],R=Boolean(a),S=Object(xs.a)(["autoSendingCreations"]),N=Object(ai.d)((function(e){if(e!==y){var t=d.relationship.isAnonymous;if(e===fo.a.videoAnswer){if(t)return void l(Object(F.h)("视频回答不支持匿名","red"));u.current.hasEditorContent()&&(ye.a.get("answerContentSync")||(l(Object(F.h)("图文回答内容已同步至视频描述")),ye.a.set("answerContentSync",!0)))}C(e)}})),T=Object(ai.d)((function(e){if(e.publishAt){var t=l(Object(D.B)(o,e));return t.then((function(){Ns(o)})),t}var n=function(){return l(Object(D.a)(o,e)).then((function(e){var t=e.payload;Ns(o,t.id)}))};return S.autoSendingCreations?l(Object(D.M)(o)).then(n,(function(e){if(e&&e.payload&&e.payload.message&&400===e.status)return it.a.confirm(e.payload.message,{title:"提醒",text:{ok:"确定发布",cancel:"我再想想"}}).then(n,(function(){}))})):n()})),q=Object(ai.d)((function(e){return l(Object(D.D)(a,e)).then((function(){Ns(o,a)}))}));return Object(ai.i)((function(){Object(tc.d)(),a||b&&Object(B.F)(o,b)})),Object(ai.i)((function(){return window.name=Object(lt.a)(o),function(){window.name=""}})),Object(i.b)(j.b,{content:{type:"Question",token:String(o)},children:Object(i.b)(x.a,{module:"QuestionItem",card:{content:{type:"Question",token:String(o)}},children:Object(i.c)(w.Box,{children:[Object(i.b)(ks,{isReediting:R,handleTabChange:N,activeTabKey:y,videoAnswerPublished:m}),Object(i.b)(tc.b.Provider,{value:A,children:Object(i.b)(se.a,{children:Object(i.b)(j.b,{block:y===fo.a.textAnswer?"TextAnswer":"VideoAnswer",children:Object(i.b)(vo.a,{question:d,answer:f,defaultValue:null==f?void 0:f.editableContent,isReediting:R,activeTabKey:y,imperativeRef:u,onSubmit:R?q:T})})})})]})})})};Ts.fetchData=function(e){var t=e.dispatch,n=e.params,i=n.id,c=n.answerId,r=e.location.query,o=r.attach_to_article;return Promise.all([c&&t(Object(D.n)(c)),t(Object(B.Q)(i)).then((function(){if(!c&&o)return t(Object(B.F)(i,o))})),t(Object(B.T)(i)).then((function(e){var t=e.payload,n=Rs()(r,["write"]),o=t.relationship,a=o.isAuthor,s=o.myAnswer,l=t.isNormal,u=t.status,d=(u=void 0===u?{}:u).isClose,b=u.isLocked,h=u.isSuggest,p=t.hasPublishingDraft,f=t.visibleOnlyToAuthor,m=function(e){var t=new Error;throw t.status=302,t.redirect=Object(Ss.a)(e,n),t};return null!=s&&s.isDeleted?m("/question/".concat(i,"?answer_deleted_redirect=true")):c?s?String(s.answerId)!==c?m("/question/".concat(i,"/answer/").concat(s.answerId,"/edit")):void 0:m("/question/".concat(i,"/write")):s?m("/question/".concat(i,"/answer/").concat(s.answerId,"/edit")):h||b||d||p||!l||!a&&f?m("/question/".concat(i)):void 0}))].filter(Boolean))};var qs=Ts;t.default=Object(i.c)(c.Route,{children:[Object(i.b)(c.Route,{path:"waiting",component:mc,name:"QuestionWaiting",authRequired:!0,zaPageShowId:5541}),Object(i.b)(c.Route,{path:"later",component:xc,name:"QuestionLater",authRequired:!0,zaPageShowId:5371}),Object(i.b)(c.Route,{path:"invited",component:Bc,name:"QuestionInvited",authRequired:!0,zaPageShowId:5543}),Object(i.c)(c.Route,{path:":id",component:sc,name:"Question",children:[Object(i.c)(c.Route,{children:[Object(i.b)(c.IndexRoute,{component:ba,entity:"answers",resource:"answers",name:"QuestionPage",zaPageShowId:3378}),Object(i.b)(c.Route,{path:"answers/hidden",component:ba,entity:"answers",resource:"hiddenAnswers",name:"QuestionHiddenAnswers"}),Object(i.b)(c.Route,{path:"answers/updated",component:ba,resource:"updatedAnswers",name:"QuestionUpdatedAnswers"}),Object(i.b)(c.Redirect,{from:"answers/created",to:"answers/updated"})]}),Object(i.b)(c.Route,{path:"answer/:answerId",component:ys,name:"AnswerPage",zaPageShowId:2012}),Object(i.b)(c.Redirect,{from:"noti-answers",to:"."})]}),Object(i.b)(c.Route,{path:":id/write",showAppHeader:!1,component:qs,name:"QuestionAnswerEditableAdd",authRequired:!0}),Object(i.b)(c.Route,{path:":id/answer/:answerId/edit",showAppHeader:!1,component:qs,name:"QuestionAnswerEditableEdit",authRequired:!0})]})},922:function(e,t,n){"use strict";var i=n(32),c=n(1),r=n(0),o=n(58),a=["ratio","children"],s=function(e,t){var n=e.ratio,r=void 0===n?1:n,s=e.children,l=Object(i.default)(e,a);return Object(c.b)(o.Box,Object.assign(Object.assign({css:{position:"relative",paddingBottom:"".concat(1/r*100,"%"),height:"0",borderRadius:"inherit"}},l),{},{ref:t,children:Object(c.b)("div",{css:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",borderRadius:"inherit"},children:s})}))};t.a=Object(r.forwardRef)(s)}}]);
//# sourceMappingURL=main.question-routes.8f370481dbda498d3a41.js.map